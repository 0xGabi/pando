
Š€€€urn i===Array.isArray(e)?i?((r||{arrayMerge:o}).arrayMerge||o)(e,t,r):function(e,t,r){var i={};return n(e)&&Object.keys(e).forEach(function(t){i[t]=s(e[t],r)}),Object.keys(t).forEach(function(o){n(t[o])&&e[o]?i[o]=a(e[o],t[o],r):i[o]=s(t[o],r)}),i}(e,t,r):s(t,r)}a.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error(\"first argument should be an array with at least two elements\");return e.reduce(function(e,r){return a(e,r,t)})};var u=a;t.default=u},function(e,t,r){\"use strict\";function n(e){return e>=55296&&e<=56319}function i(e){return e>=56320&&e<=57343}e.exports=function(e,t,r){if(\"string\"!=typeof t)throw new Error(\"Input must be string\");for(var s,o,a=t.length,u=0,c=0;c<a;c+=1){if(s=t.charCodeAt(c),o=t[c],n(s)&&i(t.charCodeAt(c+1))&&(o+=t[c+=1]),(u+=e(o))===r)return t.slice(0,c+1);if(u>r)return t.slice(0,c-o.length+1)}return t}},function(e,t,r){\"use strict\";var n=r(679),i=Buffer.byteLength.bind(Buffer);e.exports=n.bind(null,i)},function(e,t,r){\"use strict\";var n=r(680),i=/[\\/\\?<>\\\\:\\*\\|\":]/g,s=/[\\x00-\\x1f\\x80-\\x9f]/g,o=/^\\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\\..*)?$/i,u=/[\\. ]+$/;function c(e,t){var r=e.replace(i,t).replace(s,t).replace(o,t).replace(a,t).replace(u,t);return n(r,255)}e.exports=function(e,t){var r=t&&t.replacement||\"\",n=c(e,r);return\"\"===r?n:c(n,\"\")}},function(e,t,r){\"use strict\";const n=r(681),i=r(678),s=r(49),o=r(9),a=r(1),u=r(677),c=\"/pkcs8/\",f=\"/info/\",l={minKeyLength:14,minSaltLength:16,minIterationCount:1e3},h={dek:{keyLength:64,iterationCount:1e4,salt:\"you should override this value with a crypto secure random number\",hash:\"sha2-512\"}};function p(e){return!!e&&e===n(e.trim())}function d(e,t){const r=800*Math.random()+200;\"string\"==typeof t&&(t=new Error(t)),setTimeout(e,r,t,null)}function y(e){return new o.Key(c+e)}function m(e){return new o.Key(f+e)}e.exports=class{constructor(e,t){if(!e)throw new Error(\"store is required\");this.store=e;const r=i(h,t);if(!r.passPhrase||r.passPhrase.length<20)throw new Error(\"passPhrase must be least 20 characters\");if(r.dek.keyLength<l.minKeyLength)throw new Error(`dek.keyLength must be least ${l.minKeyLength} bytes`);if(r.dek.salt.length<l.minSaltLength)throw new Error(`dek.saltLength must be least ${l.minSaltLength} bytes`);if(r.dek.iterationCount<l.minIterationCount)throw new Error(`dek.iterationCount must be least ${l.minIterationCount}`);const n=s.pbkdf2(r.passPhrase,r.dek.salt,r.dek.iterationCount,r.dek.keyLength,r.dek.hash);Object.defineProperty(this,\"_\",{value:()=>n})}get cms(){return new u(this)}static generateOptions(){const e=Object.assign({},h),t=3*Math.ceil(l.minSaltLength/3);return e.dek.salt=s.randomBytes(t).toString(\"base64\"),e}static get options(){return h}createKey(e,t,r,n){const i=this;if(!p(e)||\"self\"===e)return d(n,`Invalid key name '${e}'`);const o=y(e);i.store.has(o,(a,u)=>{if(a)return d(n,a);if(u)return d(n,`Key '${e}' already exists`);switch(t.toLowerCase()){case\"rsa\":if(r<2048)return d(n,`Invalid RSA key size ${r}`)}s.keys.generateKeyPair(t,r,(t,r)=>{if(t)return d(n,t);r.id((t,s)=>{if(t)return d(n,t);r.export(this._(),(t,r)=>{if(t)return d(n,t);const a={name:e,id:s},u=i.store.batch();u.put(o,r),u.put(m(e),JSON.stringify(a)),u.commit(e=>{if(e)return d(n,e);n(null,a)})})})})})}listKeys(e){const t={prefix:f};a(this.store.query(t),a.collect((t,r)=>{if(t)return d(e,t);const n=r.map(e=>JSON.parse(e.value));e(null,n)}))}findKeyById(e,t){this.listKeys((r,n)=>{if(r)return d(t,r);const i=n.find(t=>t.id===e);t(null,i)})}findKeyByName(e,t){if(!p(e))return d(t,`Invalid key name '${e}'`);const r=m(e);this.store.get(r,(r,n)=>{if(r)return d(t,`Key '${e}' does not exist. ${r.message}`);t(null,JSON.parse(n.toString()))})}removeKey(e,t){const r=this;if(!p(e)||\"self\"===e)return d(t,`Invalid key name '${e}'`);const n=y(e);r.findKeyByName(e,(i,s)=>{if(i)return d(t,i);const o=r.store.batch();o.delete(n),o.delete(m(e)),o.commit(e=>{if(e)return d(t,e);t(null,s)})})}renameKey(e,t,r){const n=this;if(!p(e)||\"self\"===e)return d(r,`Invalid old key name '${e}'`);if(!p(t)||\"self\"===t)return d(r,`Invalid new key name '${t}'`);const i=y(e),s=y(t),o=m(e),a=m(t);this.store.get(i,(u,c)=>{if(u)return d(r,`Key '${e}' does not exist. ${u.message}`);const f=c.toString();n.store.has(s,(e,u)=>e?d(r,e):u?d(r,`Key '${t}' already exists`):void n.store.get(o,(e,u)=>{if(e)return d(r,e);const c=JSON.parse(u.toString());c.name=t;const l=n.store.batch();l.put(s,f),l.put(a,JSON.stringify(c)),l.delete(i),l.delete(o),l.commit(e=>{if(e)return d(r,e);r(null,c)})}))})}exportKey(e,t,r){if(!p(e))return d(r,`Invalid key name '${e}'`);if(!t)return d(r,\"Password is required\");const n=y(e);this.store.get(n,(n,i)=>{if(n)return d(r,`Key '${e}' does not exist. ${n.message}`);const o=i.toString();s.keys.import(o,this._(),(e,n)=>{if(e)return d(r,e);n.export(t,r)})})}importKey(e,t,r,n){const i=this;if(!p(e)||\"self\"===e)return d(n,`Invalid key name '${e}'`);if(!t)return d(n,\"PEM encoded key is required\");const o=y(e);i.store.has(o,(a,u)=>a?d(n,a):u?d(n,`Key '${e}' already exists`):void s.keys.import(t,r,(t,r)=>{if(t)return d(n,\"Cannot read the key, most likely the password is wrong\");r.id((t,s)=>{if(t)return d(n,t);r.export(this._(),(t,r)=>{if(t)return d(n,t);const a={name:e,id:s},u=i.store.batch();u.put(o,r),u.put(m(e),JSON.stringify(a)),u.commit(e=>{if(e)return d(n,e);n(null,a)})})})}))}importPeer(e,t,r){const n=this;if(!p(e))return d(r,`Invalid key name '${e}'`);if(!t||!t.privKey)return d(r,\"Peer.privKey is required\");const i=t.privKey,s=y(e);n.store.has(s,(t,o)=>t?d(r,t):o?d(r,`Key '${e}' already exists`):void i.id((t,o)=>{if(t)return d(r,t);i.export(this._(),(t,i)=>{if(t)return d(r,t);const a={name:e,id:o},u=n.store.batch();u.put(s,i),u.put(m(e),JSON.stringify(a)),u.commit(e=>{if(e)return d(r,e);r(null,a)})})}))}_getPrivateKey(e,t){if(!p(e))return d(t,`Invalid key name '${e}'`);this.store.get(y(e),(r,n)=>{if(r)return d(t,`Key '${e}' does not exist. ${r.message}`);t(null,n.toString())})}}},function(e,t,r){\"use strict\";const n=r(14),i=r(27),s=r(16),o=r(3),a=r(298),u=r(674);e.exports=function(e){return t=>{e.log(\"pre-start\");const r=e._options.pass;o([t=>e._repo.config.get(t),(t,r)=>{if(t.Keychain)return r(null,t);t.Keychain=a.generateOptions(),e.config.set(\"Keychain\",t.Keychain,n=>{e.log(\"using default keychain options\"),r(n,t)})},(t,n)=>{if(e._keychain);else if(r){const n=Object.assign({passPhrase:r},t.Keychain);e._keychain=new a(e._repo.keys,n),e.log(\"keychain constructed\")}else e._keychain=new u,e.log(\"no keychain, use --pass\");n(null,t)},(e,t)=>{const r=e.Identity.PrivKey;n.createFromPrivKey(r,(r,n)=>{t(r,e,n)})},(t,n,i)=>{if(!r)return i(null,t,n);e._keychain.findKeyByName(\"self\",r=>{if(r)return e.log('Creating \"self\" key'),e._keychain.importPeer(\"self\",n,e=>i(e,t,n));i(null,t,n)})},(t,r,n)=>{e.log(\"peer created\"),e._peerInfo=new i(r),t.Addresses&&t.Addresses.Swarm&&t.Addresses.Swarm.forEach(t=>{let r=s(t);r.getPeerId()&&(r=r.encapsulate(\"/ipfs/\"+e._peerInfo.id.toB58String())),e._peerInfo.multiaddrs.add(r)}),n()}],t)}}},function(e,t,r){\"use strict\";t.preStart=r(683),t.start=r(673),t.stop=r(650),t.isOnline=r(649),t.version=r(648),t.id=r(647),t.repo=r(293),t.init=r(646),t.bootstrap=r(609),t.config=r(608),t.block=r(607),t.object=r(606),t.dag=r(605),t.libp2p=r(604),t.swarm=r(448),t.ping=r(447),t.files=r(446),t.bitswap=r(231),t.pubsub=r(443),t.dht=r(442),t.dns=r(440),t.key=r(437),t.stats=r(436)},function(e,t,r){\"use strict\";const n=r(3),i=r(30),s=r(176);e.exports=(e=>{e.log(\"booting\");const t=e._options,r=t.init,o=t.start,a=t.config,u=a&&\"object\"==typeof a,c=!e._repo.closed,f=\"object\"==typeof t.init?t.init:{},l=Object.assign({bits:2048,pass:e._options.pass},f),h=t=>{if(t)return e.emit(\"error\",t);e.log(\"boot:done\"),e.emit(\"ready\")},p=[];(t=>{if(c)return t(null,!0);i([t=>e._repo.open(t),t=>e.preStart(t),t=>{e.log(\"initialized\"),e.state.initialized(),t(null,!0)}],(e,r)=>{if(e)return e.message.match(/not found/)||e.message.match(/ENOENT/)||e.message.match(/No value/)?t(null,!1):t(e);t(null,r)})})((a,c)=>{if(a)return h(a);if(r&&!c&&(p.push(t=>e.init(l,t)),c=!0),u&&(c?p.push(r=>{n([t=>e.config.get(t),(r,n)=>{s(r,t.config),e.config.replace(r,n)}],r)}):console.log('WARNING, trying to set config on uninitialized repo, maybe forgot to set \"init: true\"')),o){if(!c)return console.log('WARNING, trying to start ipfs node on uninitialized repo, maybe forgot to set \"init: true\"'),h(new Error(\"Uninitalized repo\"));p.push(t=>e.start(t))}i(p,h)})})},function(e,t,r){const n=r(16),i=r(60);e.exports={name:\"multiaddr\",language:{invalid:\"{{message}}\",fmt:\"must be in {{fmt}} format\"},pre(e,t,r){if(null==e)return this.createError(\"multiaddr.invalid\",{v:e,message:\"addr must be a string, Buffer, or another Multiaddr\"},t,r);let i;try{i=n(e)}catch(n){return this.createError(\"multiaddr.invalid\",{v:e,message:n.message},t,r)}return r.convert?i:e},rules:Object.keys(i).map(e=>({name:e,validate(t,r,n,s){return i[e].matches(r)?r:this.createError(\"multiaddr.fmt\",{v:r,fmt:e},n,s)}}))}},function(e){e.exports={_from:\"joi@^13.1.2\",_id:\"joi@13.4.0\",_inBundle:!1,_integrity:\"sha512-JuK4GjEu6j7zr9FuVe2MAseZ6si/8/HaY0qMAejfDFHp7jcH4OKE937mIHM5VT4xDS0q7lpQbszbxKV9rm0yUg==\",_location:\"/joi\",_phantomChildren:{hoek:\"5.0.3\"},_requested:{type:\"range\",registry:!0,raw:\"joi@^13.1.2\",name:\"joi\",escapedName:\"joi\",rawSpec:\"^13.1.2\",saveSpec:null,fetchSpec:\"^13.1.2\"},_requiredBy:[\"/ipfs\"],_resolved:\"https://registry.npmjs.org/joi/-/joi-13.4.0.tgz\",_shasum:\"afc359ee3d8bc5f9b9ba6cdc31b46d44af14cecc\",_spec:\"joi@^13.1.2\",_where:\"/Users/osarrouy/Documents/devs/dapps/@wespr/pando.js/node_modules/ipfs\",bugs:{url:\"https://github.com/hapijs/joi/issues\"},bundleDependencies:!1,dependencies:{hoek:\"5.x.x\",isemail:\"3.x.x\",topo:\"3.x.x\"},deprecated:!1,description:\"Object schema validation\",devDependencies:{code:\"5.x.x\",hapitoc:\"1.x.x\",lab:\"15.x.x\"},engines:{node:\">=8.9.0\"},homepage:\"https://github.com/hapijs/joi\",keywords:[\"hapi\",\"schema\",\"validation\"],license:\"BSD-3-Clause\",main:\"lib/index.js\",name:\"joi\",repository:{type:\"git\",url:\"git://github.com/hapijs/joi.git\"},scripts:{test:\"lab -t 100 -a code -L\",\"test-cov-html\":\"lab -r html -o coverage.html -a code\",\"test-debug\":\"lab -a code\",toc:\"hapitoc\",version:\"npm run toc && git add API.md README.md\"},version:\"13.4.0\",warnings:[{code:\"ENOTSUP\",required:{node:\">=8.9.0\"},pkgid:\"joi@13.4.0\"}]}},function(e,t,r){\"use strict\";const n=r(402),i={hasOwn:Object.prototype.hasOwnProperty,indexOf:Array.prototype.indexOf,defaultThreshold:16,maxIPv6Groups:8,categories:{valid:1,dnsWarn:7,rfc5321:15,cfws:31,deprecated:63,rfc5322:127,error:255},diagnoses:{valid:0,rfc5321TLD:9,rfc5321TLDNumeric:10,rfc5321QuotedString:11,rfc5321AddressLiteral:12,cfwsComment:17,cfwsFWS:18,undesiredNonAscii:25,deprecatedLocalPart:33,deprecatedFWS:34,deprecatedQTEXT:35,deprecatedQP:36,deprecatedComment:37,deprecatedCTEXT:38,deprecatedIPv6:39,deprecatedCFWSNearAt:49,rfc5322Domain:65,rfc5322TooLong:66,rfc5322LocalTooLong:67,rfc5322DomainTooLong:68,rfc5322LabelTooLong:69,rfc5322DomainLiteral:70,rfc5322DomainLiteralOBSDText:71,rfc5322IPv6GroupCount:72,rfc5322IPv62x2xColon:73,rfc5322IPv6BadCharacter:74,rfc5322IPv6MaxGroups:75,rfc5322IPv6ColonStart:76,rfc5322IPv6ColonEnd:77,errExpectingDTEXT:129,errNoLocalPart:130,errNoDomain:131,errConsecutiveDots:132,errATEXTAfterCFWS:133,errATEXTAfterQS:134,errATEXTAfterDomainLiteral:135,errExpectingQPair:136,errExpectingATEXT:137,errExpectingQTEXT:138,errExpectingCTEXT:139,errBackslashEnd:140,errDotStart:141,errDotEnd:142,errDomainHyphenStart:143,errDomainHyphenEnd:144,errUnclosedQuotedString:145,errUnclosedComment:146,errUnclosedDomainLiteral:147,errFWSCRLFx2:148,errFWSCRLFEnd:149,errCRNoLF:150,errUnknownTLD:160,errDomainTooShort:161},components:{localpart:0,domain:1,literal:2,contextComment:3,contextFWS:4,contextQuotedString:5,contextQuotedPair:6}};i.specials=function(){const e=new Array(256);e.fill(!1);for(let t=0;t<'()<>[]:;@\\\\,.\"'.length;++t)e['()<>[]:;@\\\\,.\"'.codePointAt(t)]=!0;return function(t){return e[t]}}(),i.c0Controls=function(){const e=new Array(256);e.fill(!1);for(let t=0;t<33;++t)e[t]=!0;return function(t){return e[t]}}(),i.c1Controls=function(){const e=new Array(256);e.fill(!1);for(let t=127;t<160;++t)e[t]=!0;return function(t){return e[t]}}(),i.regex={ipV4:/\\b(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/,ipV6:/^[a-fA-F\\d]{0,4}$/},i.normalizeSupportsNul=\"\\0\"===\"\\0\".normalize(\"NFC\"),i.nulNormalize=function(e){return e.split(\"\\0\").map(e=>e.normalize(\"NFC\")).join(\"\\0\")},i.normalize=function(e){return!i.normalizeSupportsNul&&e.indexOf(\"\\0\")>=0?i.nulNormalize(e):e.normalize(\"NFC\")},i.checkIpV6=function(e){return e.every(e=>i.regex.ipV6.test(e))},i.validDomain=function(e,t){return t.tldBlacklist?Array.isArray(t.tldBlacklist)?-1===i.indexOf.call(t.tldBlacklist,e):!i.hasOwn.call(t.tldBlacklist,e):Array.isArray(t.tldWhitelist)?-1!==i.indexOf.call(t.tldWhitelist,e):i.hasOwn.call(t.tldWhitelist,e)},t.validate=i.validate=function(e,t,r){let s,o;if(t=t||{},e=i.normalize(e),\"function\"==typeof t&&(r=t,t={}),\"function\"!=typeof r&&(r=null),\"number\"==typeof t.errorLevel?(s=!0,o=t.errorLevel):(s=!!t.errorLevel,o=i.diagnoses.valid),t.tldWhitelist)if(\"string\"==typeof t.tldWhitelist)t.tldWhitelist=[t.tldWhitelist];else if(\"object\"!=typeof t.tldWhitelist)throw new TypeError(\"expected array or object tldWhitelist\");if(t.tldBlacklist)if(\"string\"==typeof t.tldBlacklist)t.tldBlacklist=[t.tldBlacklist];else if(\"object\"!=typeof t.tldBlacklist)throw new TypeError(\"expected array or object tldBlacklist\");if(t.minDomainAtoms&&(t.minDomainAtoms!==(0|+t.minDomainAtoms)||t.minDomainAtoms<0))throw new TypeError(\"expected positive integer minDomainAtoms\");let a=i.diagnoses.valid;const u=e=>{e>a&&(a=e)};!(void 0===t.allowUnicode||!!t.allowUnicode)&&/[^\\x00-\\x7f]/.test(e)&&u(i.diagnoses.undesiredNonAscii);const c={now:i.components.localpart,prev:i.components.localpart,stack:[i.components.localpart]};let f=\"\";const l={local:\"\",domain:\"\"},h={locals:[\"\"],domains:[\"\"]};let p,d=0,y=0,m=0,g=!1,v=!1;const b=e.length;let w;for(let t=0;t<b;t+=w.length){switch(w=String.fromCodePoint(e.codePointAt(t)),c.now){case i.components.localpart:switch(w){case\"(\":0===y?u(0===d?i.diagnoses.cfwsComment:i.diagnoses.deprecatedComment):(u(i.diagnoses.cfwsComment),v=!0),c.stack.push(c.now),c.now=i.components.contextComment;break;case\".\":0===y?u(0===d?i.diagnoses.errDotStart:i.diagnoses.errConsecutiveDots):(v&&u(i.diagnoses.deprecatedLocalPart),v=!1,y=0,++d,l.local+=w,h.locals[d]=\"\");break;case'\"':0===y?(u(0===d?i.diagnoses.rfc5321QuotedString:i.diagnoses.deprecatedLocalPart),l.local+=w,h.locals[d]+=w,y+=Buffer.byteLength(w,\"utf8\"),v=!0,c.stack.push(c.now),c.now=i.components.contextQuotedString):u(i.diagnoses.errExpectingATEXT);break;case\"\\r\":if(b===++t||\"\\n\"!==e[t]){u(i.diagnoses.errCRNoLF);break}case\" \":case\"\\t\":0===y?u(0===d?i.diagnoses.cfwsFWS:i.diagnoses.deprecatedFWS):v=!0,c.stack.push(c.now),c.now=i.components.contextFWS,f=w;break;case\"@\":if(1!==c.stack.length)throw new Error(\"unexpected item on context stack\");0===l.local.length?u(i.diagnoses.errNoLocalPart):0===y?u(i.diagnoses.errDotEnd):Buffer.byteLength(l.local,\"utf8\")>64?u(i.diagnoses.rfc5322LocalTooLong):c.prev!==i.components.contextComment&&c.prev!==i.components.contextFWS||u(i.diagnoses.deprecatedCFWSNearAt),c.now=i.components.domain,c.stack[0]=i.components.domain,d=0,y=0,v=!1;break;default:if(v)switch(c.prev){case i.components.contextComment:case i.components.contextFWS:u(i.diagnoses.errATEXTAfterCFWS);break;case i.components.contextQuotedString:u(i.diagnoses.errATEXTAfterQS);break;default:throw new Error(\"more atext found where none is allowed, but unrecognized prev context: \"+c.prev)}else c.prev=c.now,p=w.codePointAt(0),(i.specials(p)||i.c0Controls(p)||i.c1Controls(p))&&u(i.diagnoses.errExpectingATEXT),l.local+=w,h.locals[d]+=w,y+=Buffer.byteLength(w,\"utf8\")}break;case i.components.domain:switch(w){case\"(\":0===y?u(0===d?i.diagnoses.deprecatedCFWSNearAt:i.diagnoses.deprecatedComment):(v=!0,u(i.diagnoses.cfwsComment)),c.stack.push(c.now),c.now=i.components.contextComment;break;case\".\":const r=n.encode(h.domains[d]).length;0===y?u(0===d?i.diagnoses.errDotStart:i.diagnoses.errConsecutiveDots):g?u(i.diagnoses.errDomainHyphenEnd):r>63&&u(i.diagnoses.rfc5322LabelTooLong),v=!1,y=0,++d,h.domains[d]=\"\",l.domain+=w;break;case\"[\":0===l.domain.length?(v=!0,y+=Buffer.byteLength(w,\"utf8\"),c.stack.push(c.now),c.now=i.components.literal,l.domain+=w,h.domains[d]+=w,l.literal=\"\"):u(i.diagnoses.errExpectingATEXT);break;case\"\\r\":if(b===++t||\"\\n\"!==e[t]){u(i.diagnoses.errCRNoLF);break}case\" \":case\"\\t\":0===y?u(0===d?i.diagnoses.deprecatedCFWSNearAt:i.diagnoses.deprecatedFWS):(u(i.diagnoses.cfwsFWS),v=!0),c.stack.push(c.now),c.now=i.components.contextFWS,f=w;break;default:if(v)switch(c.prev){case i.components.contextComment:case i.components.contextFWS:u(i.diagnoses.errATEXTAfterCFWS);break;case i.components.literal:u(i.diagnoses.errATEXTAfterDomainLiteral);break;default:throw new Error(\"more atext found where none is allowed, but unrecognized prev context: \"+c.prev)}p=w.codePointAt(0),g=!1,i.specials(p)||i.c0Controls(p)||i.c1Controls(p)?u(i.diagnoses.errExpectingATEXT):\"-\"===w?(0===y&&u(i.diagnoses.errDomainHyphenStart),g=!0):(p<48||p>122&&p<192||p>57&&p<65||p>90&&p<97)&&u(i.diagnoses.rfc5322Domain),l.domain+=w,h.domains[d]+=w,y+=Buffer.byteLength(w,\"utf8\")}break;case i.components.literal:switch(w){case\"]\":if(a<i.categories.deprecated){let e=-1,t=l.literal;const r=i.regex.ipV4.exec(t);if(r&&0!==(e=r.index)&&(t=t.slice(0,e)+\"0:0\"),0===e)u(i.diagnoses.rfc5321AddressLiteral);else if(\"ipv6:\"!==t.slice(0,5).toLowerCase())u(i.diagnoses.rfc5322DomainLiteral);else{const r=t.slice(5);let n=i.maxIPv6Groups;const s=r.split(\":\");~(e=r.indexOf(\"::\"))?e!==r.lastIndexOf(\"::\")?u(i.diagnoses.rfc5322IPv62x2xColon):(0!==e&&e!==r.length-2||++n,s.length>n?u(i.diagnoses.rfc5322IPv6MaxGroups):s.length===n&&u(i.diagnoses.deprecatedIPv6)):s.length!==n&&u(i.diagnoses.rfc5322IPv6GroupCount),\":\"===r[0]&&\":\"!==r[1]?u(i.diagnoses.rfc5322IPv6ColonStart):\":\"===r[r.length-1]&&\":\"!==r[r.length-2]?u(i.diagnoses.rfc5322IPv6ColonEnd):i.checkIpV6(s)?u(i.diagnoses.rfc5321AddressLiteral):u(i.diagnoses.rfc5322IPv6BadCharacter)}}else u(i.diagnoses.rfc5322DomainLiteral);l.domain+=w,h.domains[d]+=w,y+=Buffer.byteLength(w,\"utf8\"),c.prev=c.now,c.now=c.stack.pop();break;case\"\\\\\":u(i.diagnoses.rfc5322DomainLiteralOBSDText),c.stack.push(c.now),c.now=i.components.contextQuotedPair;break;case\"\\r\":if(b===++t||\"\\n\"!==e[t]){u(i.diagnoses.errCRNoLF);break}case\" \":case\"\\t\":u(i.diagnoses.cfwsFWS),c.stack.push(c.now),c.now=i.components.contextFWS,f=w;break;default:if(127!==(p=w.codePointAt(0))&&i.c1Controls(p)||0===p||\"[\"===w){u(i.diagnoses.errExpectingDTEXT);break}(i.c0Controls(p)||127===p)&&u(i.diagnoses.rfc5322DomainLiteralOBSDText),l.literal+=w,l.domain+=w,h.domains[d]+=w,y+=Buffer.byteLength(w,\"utf8\")}break;case i.components.contextQuotedString:switch(w){case\"\\\\\":c.stack.push(c.now),c.now=i.components.contextQuotedPair;break;case\"\\r\":if(b===++t||\"\\n\"!==e[t]){u(i.diagnoses.errCRNoLF);break}case\"\\t\":l.local+=\" \",h.locals[d]+=\" \",y+=Buffer.byteLength(w,\"utf8\"),u(i.diagnoses.cfwsFWS),c.stack.push(c.now),c.now=i.components.contextFWS,f=w;break;case'\"':l.local+=w,h.locals[d]+=w,y+=Buffer.byteLength(w,\"utf8\"),c.prev=c.now,c.now=c.stack.pop();break;default:127!==(p=w.codePointAt(0))&&i.c1Controls(p)||0===p||10===p?u(i.diagnoses.errExpectingQTEXT):(i.c0Controls(p)||127===p)&&u(i.diagnoses.deprecatedQTEXT),l.local+=w,h.locals[d]+=w,y+=Buffer.byteLength(w,\"utf8\")}break;case i.components.contextQuotedPair:127!==(p=w.codePointAt(0))&&i.c1Controls(p)?u(i.diagnoses.errExpectingQPair):(p<31&&9!==p||127===p)&&u(i.diagnoses.deprecatedQP),c.prev=c.now,c.now=c.stack.pop();const r=\"\\\\\"+w;switch(c.now){case i.components.contextComment:break;case i.components.contextQuotedString:l.local+=r,h.locals[d]+=r,y+=2;break;case i.components.literal:l.domain+=r,h.domains[d]+=r,y+=2;break;default:throw new Error(\"quoted pair logic invoked in an invalid context: \"+c.now)}break;case i.components.contextComment:switch(w){case\"(\":c.stack.push(c.now),c.now=i.components.contextComment;break;case\")\":c.prev=c.now,c.now=c.stack.pop();break;case\"\\\\\":c.stack.push(c.now),c.now=i.components.contextQuotedPair;break;case\"\\r\":if(b===++t||\"\\n\"!==e[t]){u(i.diagnoses.errCRNoLF);break}case\" \":case\"\\t\":u(i.diagnoses.cfwsFWS),c.stack.push(c.now),c.now=i.components.contextFWS,f=w;break;default:if(0===(p=w.codePointAt(0))||10===p||127!==p&&i.c1Controls(p)){u(i.diagnoses.errExpectingCTEXT);break}(i.c0Controls(p)||127===p)&&u(i.diagnoses.deprecatedCTEXT)}break;case i.components.contextFWS:if(\"\\r\"===f){if(\"\\r\"===w){u(i.diagnoses.errFWSCRLFx2);break}++m>1?u(i.diagnoses.deprecatedFWS):m=1}switch(w){case\"\\r\":b!==++t&&\"\\n\"===e[t]||u(i.diagnoses.errCRNoLF);break;case\" \":case\"\\t\":break;default:\"\\r\"===f&&u(i.diagnoses.errFWSCRLFEnd),m=0,c.prev=c.now,c.now=c.stack.pop(),--t}f=w;break;default:throw new Error(\"unknown context: \"+c.now)}if(a>i.categories.rfc5322)break}if(a<i.categories.rfc5322){const e=n.encode(l.domain).length;if(c.now===i.components.contextQuotedString)u(i.diagnoses.errUnclosedQuotedString);else if(c.now===i.components.contextQuotedPair)u(i.diagnoses.errBackslashEnd);else if(c.now===i.components.contextComment)u(i.diagnoses.errUnclosedComment);else if(c.now===i.components.literal)u(i.diagnoses.errUnclosedDomainLiteral);else if(\"\\r\"===w)u(i.diagnoses.errFWSCRLFEnd);else if(0===l.domain.length)u(i.diagnoses.errNoDomain);else if(0===y)u(i.diagnoses.errDotEnd);else if(g)u(i.diagnoses.errDomainHyphenEnd);else if(e>255)u(i.diagnoses.rfc5322DomainTooLong);else if(Buffer.byteLength(l.local,\"utf8\")+e+1>254)u(i.diagnoses.rfc5322TooLong);else if(y>63)u(i.diagnoses.rfc5322LabelTooLong);else if(t.minDomainAtoms&&h.domains.length<t.minDomainAtoms)u(i.diagnoses.errDomainTooShort);else if(t.tldWhitelist||t.tldBlacklist){const e=h.domains[d];i.validDomain(e,t)||u(i.diagnoses.errUnknownTLD)}}if(a<i.categories.dnsWarn){h.domains[d].codePointAt(0)<=57&&u(i.diagnoses.rfc5321TLDNumeric)}a<o&&(a=i.diagnoses.valid);const _=s?a:a<i.defaultThreshold;return r&&r(_),_},t.diagnoses=i.validate.diagnoses=function(){const e={},t=Object.keys(i.diagnoses);for(let r=0;r<t.length;++r){const n=t[r];e[n]=i.diagnoses[n]}return e}(),t.normalize=i.normalize},function(e,t,r){\"use strict\";const n=r(299),i={Ip:{cidrs:{ipv4:{required:\"\\\\/(?:\"+n.ipv4Cidr+\")\",optional:\"(?:\\\\/(?:\"+n.ipv4Cidr+\"))?\",forbidden:\"\"},ipv6:{required:\"\\\\/\"+n.ipv6Cidr,optional:\"(?:\\\\/\"+n.ipv6Cidr+\")?\",forbidden:\"\"},ipvfuture:{required:\"\\\\/\"+n.ipv6Cidr,optional:\"(?:\\\\/\"+n.ipv6Cidr+\")?\",forbidden:\"\"}},versions:{ipv4:n.IPv4address,ipv6:n.IPv6address,ipvfuture:n.IPvFuture}}};i.Ip.createIpRegex=function(e,t){let r;for(let n=0;n<e.length;++n){const s=e[n];r?r+=\"|\"+i.Ip.versions[s]+i.Ip.cidrs[s][t]:r=\"^(?:\"+i.Ip.versions[s]+i.Ip.cidrs[s][t]}return new RegExp(r+\")$\")},e.exports=i.Ip},function(e,t,r){\"use strict\";const n=r(299),i={Uri:{createUriRegex:function(e,t,r){let i,s=n.scheme;if(r)i=\"(?:\"+n.relativeRef+\")\";else{e&&(s=\"(?:\"+e+\")\");const r=\"(?:\"+s+\":\"+n.hierPart+\")\";i=t?\"(?:\"+r+\"|\"+n.relativeRef+\")\":r}return new RegExp(\"^\"+i+\"(?:\\\\?\"+n.query+\")?(?:#\"+n.fragment+\")?$\")}}};e.exports=i.Uri},function(e,t,r){\"use strict\";const n=r(174),i=r(26);let s;const o=r(48),a=r(47),u=r(301),c=r(690),f=r(689),l={uriRegex:c.createUriRegex(),ipRegex:f.createIpRegex([\"ipv4\",\"ipv6\",\"ipvfuture\"],\"optional\"),guidBrackets:{\"{\":\"}\",\"[\":\"]\",\"(\":\")\",\"\":\"\"},guidVersions:{uuidv1:\"1\",uuidv2:\"2\",uuidv3:\"3\",uuidv4:\"4\",uuidv5:\"5\"},cidrPresences:[\"required\",\"optional\",\"forbidden\"],normalizationForms:[\"NFC\",\"NFD\",\"NFKC\",\"NFKD\"],String:class extends o{constructor(){super(),this._type=\"string\",this._invalids.add(\"\")}_base(e,t,r){if(\"string\"==typeof e&&r.convert){if(this._flags.normalize&&(e=e.normalize(this._flags.normalize)),this._flags.case&&(e=\"upper\"===this._flags.case?e.toLocaleUpperCase():e.toLocaleLowerCase()),this._flags.trim&&(e=e.trim()),this._inner.replacements)for(let t=0;t<this._inner.replacements.length;++t){const r=this._inner.replacements[t];e=e.replace(r.pattern,r.replacement)}if(this._flags.truncate)for(let t=0;t<this._tests.length;++t){const r=this._tests[t];if(\"max\"===r.name){e=e.slice(0,r.arg);break}}this._flags.byteAligned&&e.length%2!=0&&(e=`0${e}`)}return{value:e,errors:\"string\"==typeof e?null:this.createError(\"string.base\",{value:e},t,r)}}insensitive(){if(this._flags.insensitive)return this;const e=this.clone();return e._flags.insensitive=!0,e}creditCard(){return this._test(\"creditCard\",void 0,function(e,t,r){let n=e.length,i=0,s=1;for(;n--;){const t=e.charAt(n)*s;i+=t-9*(t>9),s^=3}return i%10==0&&i>0?e:this.createError(\"string.creditCard\",{value:e},t,r)})}regex(e,t){i.assert(e instanceof RegExp,\"pattern must be a RegExp\");const r={pattern:new RegExp(e.source,e.ignoreCase?\"i\":void 0)};\"string\"==typeof t?r.name=t:\"object\"==typeof t&&(r.invert=!!t.invert,t.name&&(r.name=t.name));const n=[\"string.regex\",r.invert?\".invert\":\"\",r.name?\".name\":\".base\"].join(\"\");return this._test(\"regex\",r,function(e,t,i){return r.pattern.test(e)^r.invert?e:this.createError(n,{name:r.name,pattern:r.pattern,value:e},t,i)})}alphanum(){return this._test(\"alphanum\",void 0,function(e,t,r){return/^[a-zA-Z0-9]+$/.test(e)?e:this.createError(\"string.alphanum\",{value:e},t,r)})}token(){return this._test(\"token\",void 0,function(e,t,r){return/^\\w+$/.test(e)?e:this.createError(\"string.token\",{value:e},t,r)})}email(e){return e&&(i.assert(\"object\"==typeof e,\"email options must be an object\"),i.assert(void 0===e.checkDNS,\"checkDNS option is not supported\"),i.assert(void 0===e.tldWhitelist||\"object\"==typeof e.tldWhitelist,\"tldWhitelist must be an array or object\"),i.assert(void 0===e.minDomainAtoms||Number.isSafeInteger(e.minDomainAtoms)&&e.minDomainAtoms>0,\"minDomainAtoms must be a positive integer\"),i.assert(void 0===e.errorLevel||\"boolean\"==typeof e.errorLevel||Number.isSafeInteger(e.errorLevel)&&e.errorLevel>=0,\"errorLevel must be a non-negative integer or boolean\")),this._test(\"email\",e,function(t,n,i){s=s||r(688);try{const r=s.validate(t,e);if(!0===r||0===r)return t}catch(e){}return this.createError(\"string.email\",{value:t},n,i)})}ip(e={}){let t,r=l.ipRegex;if(i.assert(\"object\"==typeof e,\"options must be an object\"),e.cidr?(i.assert(\"string\"==typeof e.cidr,\"cidr must be a string\"),e.cidr=e.cidr.toLowerCase(),i.assert(i.contain(l.cidrPresences,e.cidr),\"cidr must be one of \"+l.cidrPresences.join(\", \")),e.version||\"optional\"===e.cidr||(r=f.createIpRegex([\"ipv4\",\"ipv6\",\"ipvfuture\"],e.cidr))):e.cidr=\"optional\",e.version){Array.isArray(e.version)||(e.version=[e.version]),i.assert(e.version.length>=1,\"version must have at least 1 version specified\"),t=[];for(let r=0;r<e.version.length;++r){let n=e.version[r];i.assert(\"string\"==typeof n,\"version at position \"+r+\" must be a string\"),n=n.toLowerCase(),i.assert(f.versions[n],\"version at position \"+r+\" must be one of \"+Object.keys(f.versions).join(\", \")),t.push(n)}t=i.unique(t),r=f.createIpRegex(t,e.cidr)}return this._test(\"ip\",e,function(n,i,s){return r.test(n)?n:t?this.createError(\"string.ipVersion\",{value:n,cidr:e.cidr,version:t},i,s):this.createError(\"string.ip\",{value:n,cidr:e.cidr},i,s)})}uri(e){let t=\"\",r=!1,n=!1,s=l.uriRegex;if(e){if(i.assert(\"object\"==typeof e,\"options must be an object\"),e.scheme){i.assert(e.scheme instanceof RegExp||\"string\"==typeof e.scheme||Array.isArray(e.scheme),\"scheme must be a RegExp, String, or Array\"),Array.isArray(e.scheme)||(e.scheme=[e.scheme]),i.assert(e.scheme.length>=1,\"scheme must have at least 1 scheme specified\");for(let r=0;r<e.scheme.length;++r){const n=e.scheme[r];i.assert(n instanceof RegExp||\"string\"==typeof n,\"scheme at position \"+r+\" must be a RegExp or String\"),t+=t?\"|\":\"\",n instanceof RegExp?t+=n.source:(i.assert(/[a-zA-Z][a-zA-Z0-9+-\\.]*/.test(n),\"scheme at position \"+r+\" must be a valid scheme\"),t+=i.escapeRegex(n))}}e.allowRelative&&(r=!0),e.relativeOnly&&(n=!0)}return(t||r||n)&&(s=c.createUriRegex(t,r,n)),this._test(\"uri\",e,function(e,r,i){return s.test(e)?e:n?this.createError(\"string.uriRelativeOnly\",{value:e},r,i):t?this.createError(\"string.uriCustomScheme\",{scheme:t,value:e},r,i):this.createError(\"string.uri\",{value:e},r,i)})}isoDate(){return this._test(\"isoDate\",void 0,function(e,t,r){if(u._isIsoDate(e)){if(!r.convert)return e;const t=new Date(e);if(!isNaN(t.getTime()))return t.toISOString()}return this.createError(\"string.isoDate\",{value:e},t,r)})}guid(e){let t=\"\";if(e&&e.version){Array.isArray(e.version)||(e.version=[e.version]),i.assert(e.version.length>=1,\"version must have at least 1 valid version specified\");const r=new Set;for(let n=0;n<e.version.length;++n){let s=e.version[n];i.assert(\"string\"==typeof s,\"version at position \"+n+\" must be a string\"),s=s.toLowerCase();const o=l.guidVersions[s];i.assert(o,\"version at position \"+n+\" must be one of \"+Object.keys(l.guidVersions).join(\", \")),i.assert(!r.has(o),\"version at position \"+n+\" must not be a duplicate.\"),t+=o,r.add(o)}}const r=new RegExp(`^([\\\\[{\\\\(]?)[0-9A-F]{8}([:-]?)[0-9A-F]{4}\\\\2?[${t||\"0-9A-F\"}][0-9A-F]{3}\\\\2?[${t?\"89AB\":\"0-9A-F\"}][0-9A-F]{3}\\\\2?[0-9A-F]{12}([\\\\]}\\\\)]?)$`,\"i\");return this._test(\"guid\",e,function(e,t,n){const i=r.exec(e);return i?l.guidBrackets[i[1]]!==i[i.length-1]?this.createError(\"string.guid\",{value:e},t,n):e:this.createError(\"string.guid\",{value:e},t,n)})}hex(e={}){i.assert(\"object\"==typeof e,\"hex options must be an object\"),i.assert(void 0===e.byteAligned||\"boolean\"==typeof e.byteAligned,\"byteAligned must be boolean\");const t=!0===e.byteAligned,r=/^[a-f0-9]+$/i,n=this._test(\"hex\",r,function(e,n,i){return r.test(e)?t&&e.length%2!=0?this.createError(\"string.hexAlign\",{value:e},n,i):e:this.createError(\"string.hex\",{value:e},n,i)});return t&&(n._flags.byteAligned=!0),n}base64(e={}){i.assert(\"object\"==typeof e,\"base64 options must be an object\"),i.assert(void 0===e.paddingRequired||\"boolean\"==typeof e.paddingRequired,\"paddingRequired must be boolean\");const t=(!1===e.paddingRequired?e.paddingRequired:e.paddingRequired||!0)?/^(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?$/:/^(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?$/;return this._test(\"base64\",t,function(e,r,n){return t.test(e)?e:this.createError(\"string.base64\",{value:e},r,n)})}hostname(){const e=/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$/;return this._test(\"hostname\",void 0,function(t,r,i){return t.length<=255&&e.test(t)||n.isIPv6(t)?t:this.createError(\"string.hostname\",{value:t},r,i)})}normalize(e=\"NFC\"){i.assert(i.contain(l.normalizationForms,e),\"normalization form must be one of \"+l.normalizationForms.join(\", \"));const t=this._test(\"normalize\",e,function(t,r,n){return n.convert||t===t.normalize(e)?t:this.createError(\"string.normalize\",{value:t,form:e},r,n)});return t._flags.normalize=e,t}lowercase(){const e=this._test(\"lowercase\",void 0,function(e,t,r){return r.convert||e===e.toLocaleLowerCase()?e:this.createError(\"string.lowercase\",{value:e},t,r)});return e._flags.case=\"lower\",e}uppercase(){const e=this._test(\"uppercase\",void 0,function(e,t,r){return r.convert||e===e.toLocaleUpperCase()?e:this.createError(\"string.uppercase\",{value:e},t,r)});return e._flags.case=\"upper\",e}trim(){const e=this._test(\"trim\",void 0,function(e,t,r){return r.convert||e===e.trim()?e:this.createError(\"string.trim\",{value:e},t,r)});return e._flags.trim=!0,e}replace(e,t){\"string\"==typeof e&&(e=new RegExp(i.escapeRegex(e),\"g\")),i.assert(e instanceof RegExp,\"pattern must be a RegExp\"),i.assert(\"string\"==typeof t,\"replacement must be a String\");const r=this.clone();return r._inner.replacements||(r._inner.replacements=[]),r._inner.replacements.push({pattern:e,replacement:t}),r}truncate(e){const t=void 0===e||!!e;if(this._flags.truncate===t)return this;const r=this.clone();return r._flags.truncate=t,r}},compare:function(e,t){return function(r,n){const s=a.isRef(r);return i.assert(Number.isSafeInteger(r)&&r>=0||s,\"limit must be a positive integer or reference\"),i.assert(!n||Buffer.isEncoding(n),\"Invalid encoding:\",n),this._test(e,r,function(i,o,a){let u;if(s){if(u=r(o.reference||o.parent,a),!Number.isSafeInteger(u))return this.createError(\"string.ref\",{ref:r.key},o,a)}else u=r;return t(i,u,n)?i:this.createError(\"string.\"+e,{limit:u,value:i,encoding:n},o,a)})}}};l.String.prototype.min=l.compare(\"min\",(e,t,r)=>{return(r?Buffer.byteLength(e,r):e.length)>=t}),l.String.prototype.max=l.compare(\"max\",(e,t,r)=>{return(r?Buffer.byteLength(e,r):e.length)<=t}),l.String.prototype.length=l.compare(\"length\",(e,t,r)=>{return(r?Buffer.byteLength(e,r):e.length)===t}),l.String.prototype.uuid=l.String.prototype.guid,e.exports=new l.String},function(e,t,r){\"use strict\";const n=r(48),i=r(47),s=r(26),o={precisionRx:/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/,Number:class extends n{constructor(){super(),this._type=\"number\",this._invalids.add(1/0),this._invalids.add(-1/0)}_base(e,t,r){const n={errors:null,value:e};if(\"string\"==typeof e&&r.convert){const t=parseFloat(e);n.value=isNaN(t)||!isFinite(e)?NaN:t}const i=\"number\"==typeof n.value&&!isNaN(n.value);if(r.convert&&\"precision\"in this._flags&&i){const e=Math.pow(10,this._flags.precision);n.value=Math.round(n.value*e)/e}return n.errors=i?null:this.createError(\"number.base\",null,t,r),n}multiple(e){const t=i.isRef(e);return t||(s.assert(\"number\"==typeof e&&isFinite(e),\"multiple must be a number\"),s.assert(e>0,\"multiple must be greater than 0\")),this._test(\"multiple\",e,function(r,n,i){const s=t?e(n.reference||n.parent,i):e;return!t||\"number\"==typeof s&&isFinite(s)?r%s==0?r:this.createError(\"number.multiple\",{multiple:e,value:r},n,i):this.createError(\"number.ref\",{ref:e.key},n,i)})}integer(){return this._test(\"integer\",void 0,function(e,t,r){return Number.isSafeInteger(e)?e:this.createError(\"number.integer\",{value:e},t,r)})}negative(){return this._test(\"negative\",void 0,function(e,t,r){return e<0?e:this.createError(\"number.negative\",{value:e},t,r)})}positive(){return this._test(\"positive\",void 0,function(e,t,r){return e>0?e:this.createError(\"number.positive\",{value:e},t,r)})}precision(e){s.assert(Number.isSafeInteger(e),\"limit must be an integer\"),s.assert(!(\"precision\"in this._flags),\"precision already set\");const t=this._test(\"precision\",e,function(t,r,n){const i=t.toString().match(o.precisionRx);return Math.max((i[1]?i[1].length:0)-(i[2]?parseInt(i[2],10):0),0)<=e?t:this.createError(\"number.precision\",{limit:e,value:t},r,n)});return t._flags.precision=e,t}port(){return this._test(\"port\",void 0,function(e,t,r){return!Number.isSafeInteger(e)||e<0||e>65535?this.createError(\"number.port\",{value:e},t,r):e})}},compare:function(e,t){return function(r){const n=i.isRef(r),o=\"number\"==typeof r&&!isNaN(r);return s.assert(o||n,\"limit must be a number or reference\"),this._test(e,r,function(i,s,o){let a;if(n){if(\"number\"!=typeof(a=r(s.reference||s.parent,o))||isNaN(a))return this.createError(\"number.ref\",{ref:r.key},s,o)}else a=r;return t(i,a)?i:this.createError(\"number.\"+e,{limit:a,value:i},s,o)})}}};o.Number.prototype.min=o.compare(\"min\",(e,t)=>e>=t),o.Number.prototype.max=o.compare(\"max\",(e,t)=>e<=t),o.Number.prototype.greater=o.compare(\"greater\",(e,t)=>e>t),o.Number.prototype.less=o.compare(\"less\",(e,t)=>e<t),e.exports=new o.Number},function(e,t,r){\"use strict\";const n=r(26),i={};e.exports=i.Topo=function(){this._items=[],this.nodes=[]},i.Topo.prototype.add=function(e,t){const r=[].concat((t=t||{}).before||[]),i=[].concat(t.after||[]),s=t.group||\"?\",o=t.sort||0;n.assert(-1===r.indexOf(s),\"Item cannot come before itself:\",s),n.assert(-1===r.indexOf(\"?\"),\"Item cannot come before unassociated items\"),n.assert(-1===i.indexOf(s),\"Item cannot come after itself:\",s),n.assert(-1===i.indexOf(\"?\"),\"Item cannot come after unassociated items\"),[].concat(e).forEach((e,t)=>{const n={seq:this._items.length,sort:o,before:r,after:i,group:s,node:e};this._items.push(n)});const a=this._sort();return n.assert(!a,\"item\",\"?\"!==s?\"added into group \"+s:\"\",\"created a dependencies error\"),this.nodes},i.Topo.prototype.merge=function(e){e=[].concat(e);for(let t=0;t<e.length;++t){const r=e[t];if(r)for(let e=0;e<r._items.length;++e){const t=n.shallow(r._items[e]);this._items.push(t)}}this._items.sort(i.mergeSort);for(let e=0;e<this._items.length;++e)this._items[e].seq=e;const t=this._sort();return n.assert(!t,\"merge created a dependencies error\"),this.nodes},i.mergeSort=function(e,t){return e.sort===t.sort?0:e.sort<t.sort?-1:1},i.Topo.prototype._sort=function(){const e={},t=Object.create(null),r=Object.create(null);for(let n=0;n<this._items.length;++n){const i=this._items[n],s=i.seq,o=i.group;r[o]=r[o]||[],r[o].push(s),e[s]=i.before;const a=i.after;for(let e=0;e<a.length;++e)t[a[e]]=(t[a[e]]||[]).concat(s)}let n=Object.keys(e);for(let t=0;t<n.length;++t){const i=n[t],s=[],o=Object.keys(e[i]);for(let t=0;t<o.length;++t){const n=e[i][o[t]];r[n]=r[n]||[];for(let e=0;e<r[n].length;++e)s.push(r[n][e])}e[i]=s}const i=Object.keys(t);for(let n=0;n<i.length;++n){const s=i[n];if(r[s])for(let n=0;n<r[s].length;++n){const i=r[s][n];e[i]=e[i].concat(t[s])}}let s;const o={};n=Object.keys(e);for(let t=0;t<n.length;++t){const r=n[t];s=e[r];for(let e=0;e<s.length;++e)o[s[e]]=(o[s[e]]||[]).concat(r)}const a={},u=[];for(let e=0;e<this._items.length;++e){let t=e;if(o[e]){t=null;for(let e=0;e<this._items.length;++e){if(!0===a[e])continue;o[e]||(o[e]=[]);const r=o[e].length;let n=0;for(let t=0;t<r;++t)a[o[e][t]]&&++n;if(n===r){t=e;break}}}null!==t&&(a[t]=!0,u.push(t))}if(u.length!==this._items.length)return new Error(\"Invalid dependencies\");const c={};for(let e=0;e<this._items.length;++e){const t=this._items[e];c[t.seq]=t}const f=[];this._items=u.map(e=>{const t=c[e];return f.push(t.node),t}),this.nodes=f}},function(e,t,r){\"use strict\";const n=r(26),i=r(300),s=r(47),o={Func:class extends i.constructor{constructor(){super(),this._flags.func=!0}arity(e){return n.assert(Number.isSafeInteger(e)&&e>=0,\"n must be a positive integer\"),this._test(\"arity\",e,function(t,r,n){return t.length===e?t:this.createError(\"function.arity\",{n:e},r,n)})}minArity(e){return n.assert(Number.isSafeInteger(e)&&e>0,\"n must be a strict positive integer\"),this._test(\"minArity\",e,function(t,r,n){return t.length>=e?t:this.createError(\"function.minArity\",{n:e},r,n)})}maxArity(e){return n.assert(Number.isSafeInteger(e)&&e>=0,\"n must be a positive integer\"),this._test(\"maxArity\",e,function(t,r,n){return t.length<=e?t:this.createError(\"function.maxArity\",{n:e},r,n)})}ref(){return this._test(\"ref\",null,function(e,t,r){return s.isRef(e)?e:this.createError(\"function.ref\",null,t,r)})}class(){return this._test(\"class\",null,function(e,t,r){return/^\\s*class\\s/.test(e.toString())?e:this.createError(\"function.class\",null,t,r)})}}};e.exports=new o.Func},function(e,t,r){\"use strict\";const n=r(48),i=r(26),s={Binary:class extends n{constructor(){super(),this._type=\"binary\"}_base(e,t,r){const n={value:e};if(\"string\"==typeof e&&r.convert)try{n.value=Buffer.from(e,this._flags.encoding)}catch(e){}return n.errors=Buffer.isBuffer(n.value)?null:this.createError(\"binary.base\",null,t,r),n}encoding(e){if(i.assert(Buffer.isEncoding(e),\"Invalid encoding:\",e),this._flags.encoding===e)return this;const t=this.clone();return t._flags.encoding=e,t}min(e){return i.assert(Number.isSafeInteger(e)&&e>=0,\"limit must be a positive integer\"),this._test(\"min\",e,function(t,r,n){return t.length>=e?t:this.createError(\"binary.min\",{limit:e,value:t},r,n)})}max(e){return i.assert(Number.isSafeInteger(e)&&e>=0,\"limit must be a positive integer\"),this._test(\"max\",e,function(t,r,n){return t.length<=e?t:this.createError(\"binary.max\",{limit:e,value:t},r,n)})}length(e){return i.assert(Number.isSafeInteger(e)&&e>=0,\"limit must be a positive integer\"),this._test(\"length\",e,function(t,r,n){return t.length===e?t:this.createError(\"binary.length\",{limit:e,value:t},r,n)})}}};e.exports=new s.Binary},function(e,t,r){\"use strict\";const n=r(48),i=r(26),s={Set:r(303),Boolean:class extends n{constructor(){super(),this._type=\"boolean\",this._flags.insensitive=!0,this._inner.truthySet=new s.Set,this._inner.falsySet=new s.Set}_base(e,t,r){const n={value:e};if(\"string\"==typeof e&&r.convert){const t=this._flags.insensitive?e.toLowerCase():e;n.value=\"true\"===t||\"false\"!==t&&e}return\"boolean\"!=typeof n.value&&(n.value=!!this._inner.truthySet.has(e,null,null,this._flags.insensitive)||!this._inner.falsySet.has(e,null,null,this._flags.insensitive)&&e),n.errors=\"boolean\"==typeof n.value?null:this.createError(\"boolean.base\",null,t,r),n}truthy(...e){const t=this.clone();e=i.flatten(e);for(let r=0;r<e.length;++r){const n=e[r];i.assert(void 0!==n,\"Cannot call truthy with undefined\"),t._inner.truthySet.add(n)}return t}falsy(...e){const t=this.clone();e=i.flatten(e);for(let r=0;r<e.length;++r){const n=e[r];i.assert(void 0!==n,\"Cannot call falsy with undefined\"),t._inner.falsySet.add(n)}return t}insensitive(e){const t=void 0===e||!!e;if(this._flags.insensitive===t)return this;const r=this.clone();return r._flags.insensitive=t,r}describe(){const e=n.prototype.describe.call(this);return e.truthy=[!0].concat(this._inner.truthySet.values()),e.falsy=[!1].concat(this._inner.falsySet.values()),e}}};e.exports=new s.Boolean},function(e,t,r){\"use strict\";const n=r(48),i=r(94),s=r(47),o=r(26),a={fastSplice:function(e,t){let r=t;for(;r<e.length;)e[r++]=e[r];--e.length},Array:class extends n{constructor(){super(),this._type=\"array\",this._inner.items=[],this._inner.ordereds=[],this._inner.inclusions=[],this._inner.exclusions=[],this._inner.requireds=[],this._flags.sparse=!1}_base(e,t,r){const n={value:e};\"string\"==typeof e&&r.convert&&a.safeParse(e,n);let i=Array.isArray(n.value);const s=i;if(r.convert&&this._flags.single&&!i&&(n.value=[n.value],i=!0),!i)return n.errors=this.createError(\"array.base\",null,t,r),n;if((this._inner.inclusions.length||this._inner.exclusions.length||this._inner.requireds.length||this._inner.ordereds.length||!this._flags.sparse)&&(s&&(n.value=n.value.slice(0)),n.errors=this._checkItems.call(this,n.value,s,t,r),n.errors&&s&&r.convert&&this._flags.single)){const e=n.errors;n.value=[n.value],n.errors=this._checkItems.call(this,n.value,s,t,r),n.errors&&(n.errors=e,n.value=n.value[0])}return n}_checkItems(e,t,r,n){const i=[];let s;const o=this._inner.requireds.slice(),u=this._inner.ordereds.slice(),c=this._inner.inclusions.concat(o);let f=e.length;for(let l=0;l<f;++l){s=!1;const h=e[l];let p=!1;const d={key:t?l:r.key,path:t?r.path.concat(l):r.path,parent:r.parent,reference:r.reference};let y;if(!this._flags.sparse&&void 0===h){if(i.push(this.createError(\"array.sparse\",null,{key:r.key,path:d.path,pos:l},n)),n.abortEarly)return i;u.shift();continue}for(let e=0;e<this._inner.exclusions.length;++e)if(!(y=this._inner.exclusions[e]._validate(h,d,{})).errors){if(i.push(this.createError(t?\"array.excludes\":\"array.excludesSingle\",{pos:l,value:h},{key:r.key,path:d.path},n)),s=!0,n.abortEarly)return i;u.shift();break}if(s)continue;if(this._inner.ordereds.length){if(u.length>0){const t=u.shift();if((y=t._validate(h,d,n)).errors){if(i.push(this.createError(\"array.ordered\",{pos:l,reason:y.errors,value:h},{key:r.key,path:d.path},n)),n.abortEarly)return i}else if(t._flags.strip)a.fastSplice(e,l),--l,--f;else{if(!this._flags.sparse&&void 0===y.value){if(i.push(this.createError(\"array.sparse\",null,{key:r.key,path:d.path,pos:l},n)),n.abortEarly)return i;continue}e[l]=y.value}continue}if(!this._inner.items.length){if(i.push(this.createError(\"array.orderedLength\",{pos:l,limit:this._inner.ordereds.length},{key:r.key,path:d.path},n)),n.abortEarly)return i;continue}}const m=[];let g=o.length;for(let t=0;t<g;++t)if(!(y=m[t]=o[t]._validate(h,d,n)).errors){if(e[l]=y.value,p=!0,a.fastSplice(o,t),--t,--g,!this._flags.sparse&&void 0===y.value&&(i.push(this.createError(\"array.sparse\",null,{key:r.key,path:d.path,pos:l},n)),n.abortEarly))return i;break}if(p)continue;const v=!!n.stripUnknown&&(!0===n.stripUnknown||!!n.stripUnknown.arrays);g=c.length;for(let u=0;u<g;++u){const b=c[u],w=o.indexOf(b);if(-1!==w)y=m[w];else if(!(y=b._validate(h,d,n)).errors){b._flags.strip?(a.fastSplice(e,l),--l,--f):this._flags.sparse||void 0!==y.value?e[l]=y.value:(i.push(this.createError(\"array.sparse\",null,{key:r.key,path:d.path,pos:l},n)),s=!0),p=!0;break}if(1===g){if(v){a.fastSplice(e,l),--l,--f,p=!0;break}if(i.push(this.createError(t?\"array.includesOne\":\"array.includesOneSingle\",{pos:l,reason:y.errors,value:h},{key:r.key,path:d.path},n)),s=!0,n.abortEarly)return i;break}}if(!s&&(this._inner.inclusions.length&&!p)){if(v){a.fastSplice(e,l),--l,--f;continue}if(i.push(this.createError(t?\"array.includes\":\"array.includesSingle\",{pos:l,value:h},{key:r.key,path:d.path},n)),n.abortEarly)return i}}return o.length&&this._fillMissedErrors.call(this,i,o,r,n),u.length&&this._fillOrderedErrors.call(this,i,u,r,n),i.length?i:null}describe(){const e=n.prototype.describe.call(this);if(this._inner.ordereds.length){e.orderedItems=[];for(let t=0;t<this._inner.ordereds.length;++t)e.orderedItems.push(this._inner.ordereds[t].describe())}if(this._inner.items.length){e.items=[];for(let t=0;t<this._inner.items.length;++t)e.items.push(this._inner.items[t].describe())}return e}items(...e){const t=this.clone();return o.flatten(e).forEach((e,r)=>{try{e=i.schema(this._currentJoi,e)}catch(e){throw e.hasOwnProperty(\"path\")?e.path=r+\".\"+e.path:e.path=r,e.message=e.message+\"(\"+e.path+\")\",e}t._inner.items.push(e),\"required\"===e._flags.presence?t._inner.requireds.push(e):\"forbidden\"===e._flags.presence?t._inner.exclusions.push(e.optional()):t._inner.inclusions.push(e)}),t}ordered(...e){const t=this.clone();return o.flatten(e).forEach((e,r)=>{try{e=i.schema(this._currentJoi,e)}catch(e){throw e.hasOwnProperty(\"path\")?e.path=r+\".\"+e.path:e.path=r,e.message=e.message+\"(\"+e.path+\")\",e}t._inner.ordereds.push(e)}),t}min(e){const t=s.isRef(e);return o.assert(Number.isSafeInteger(e)&&e>=0||t,\"limit must be a positive integer or reference\"),this._test(\"min\",e,function(r,n,i){let s;if(t){if(s=e(n.reference||n.parent,i),!(Number.isSafeInteger(s)&&s>=0))return this.createError(\"array.ref\",{ref:e.key},n,i)}else s=e;return r.length>=s?r:this.createError(\"array.min\",{limit:e,value:r},n,i)})}max(e){const t=s.isRef(e);return o.assert(Number.isSafeInteger(e)&&e>=0||t,\"limit must be a positive integer or reference\"),this._test(\"max\",e,function(r,n,i){let s;if(t){if(s=e(n.reference||n.parent,i),!(Number.isSafeInteger(s)&&s>=0))return this.createError(\"array.ref\",{ref:e.key},n,i)}else s=e;return r.length<=s?r:this.createError(\"array.max\",{limit:e,value:r},n,i)})}length(e){const t=s.isRef(e);return o.assert(Number.isSafeInteger(e)&&e>=0||t,\"limit must be a positive integer or reference\"),this._test(\"length\",e,function(r,n,i){let s;if(t){if(s=e(n.reference||n.parent,i),!(Number.isSafeInteger(s)&&s>=0))return this.createError(\"array.ref\",{ref:e.key},n,i)}else s=e;return r.length===s?r:this.createError(\"array.length\",{limit:e,value:r},n,i)})}unique(e){o.assert(void 0===e||\"function\"==typeof e||\"string\"==typeof e,\"comparator must be a function or a string\");const t={};return\"string\"==typeof e?t.path=e:\"function\"==typeof e&&(t.comparator=e),this._test(\"unique\",t,function(e,r,n){const i={string:Object.create(null),number:Object.create(null),undefined:Object.create(null),boolean:Object.create(null),object:new Map,function:new Map,custom:new Map},s=t.comparator||o.deepEqual;for(let a=0;a<e.length;++a){const u=t.path?o.reach(e[a],t.path):e[a],c=t.comparator?i.custom:i[typeof u];if(c)if(c instanceof Map){const i=c.entries();let o;for(;!(o=i.next()).done;)if(s(o.value[0],u)){const i={key:r.key,path:r.path.concat(a),parent:r.parent,reference:r.reference},s={pos:a,value:e[a],dupePos:o.value[1],dupeValue:e[o.value[1]]};return t.path&&(s.path=t.path),this.createError(\"array.unique\",s,i,n)}c.set(u,a)}else{if(void 0!==c[u]){const i={key:r.key,path:r.path.concat(a),parent:r.parent,reference:r.reference},s={pos:a,value:e[a],dupePos:c[u],dupeValue:e[c[u]]};return t.path&&(s.path=t.path),this.createError(\"array.unique\",s,i,n)}c[u]=a}}return e})}sparse(e){const t=void 0===e||!!e;if(this._flags.sparse===t)return this;const r=this.clone();return r._flags.sparse=t,r}single(e){const t=void 0===e||!!e;if(this._flags.single===t)return this;const r=this.clone();return r._flags.single=t,r}_fillMissedErrors(e,t,r,n){const i=[];let s=0;for(let e=0;e<t.length;++e){const r=t[e]._getLabel();r?i.push(r):++s}i.length?s?e.push(this.createError(\"array.includesRequiredBoth\",{knownMisses:i,unknownMisses:s},{key:r.key,path:r.path},n)):e.push(this.createError(\"array.includesRequiredKnowns\",{knownMisses:i},{key:r.key,path:r.path},n)):e.push(this.createError(\"array.includesRequiredUnknowns\",{unknownMisses:s},{key:r.key,path:r.path},n))}_fillOrderedErrors(e,t,r,n){const i=[];for(let e=0;e<t.length;++e){\"required\"===o.reach(t[e],\"_flags.presence\")&&i.push(t[e])}i.length&&this._fillMissedErrors.call(this,e,i,r,n)}},safeParse:function(e,t){try{const r=JSON.parse(e);Array.isArray(r)&&(t.value=r)}catch(e){}}};e.exports=new a.Array},function(e,t,r){\"use strict\";const n=r(48),i=r(26),s={Lazy:class extends n{constructor(){super(),this._type=\"lazy\"}_base(e,t,r){const i={value:e},s=this._flags.lazy;if(!s)return i.errors=this.createError(\"lazy.base\",null,t,r),i;const o=s();return o instanceof n?o._validate(e,t,r):(i.errors=this.createError(\"lazy.schema\",null,t,r),i)}set(e){i.assert(\"function\"==typeof e,\"You must provide a function as first argument\");const t=this.clone();return t._flags.lazy=e,t}}};e.exports=new s.Lazy},function(e,t,r){\"use strict\";const n=r(305);t.options=n.object({abortEarly:n.boolean(),convert:n.boolean(),allowUnknown:n.boolean(),skipFunctions:n.boolean(),stripUnknown:[n.boolean(),n.object({arrays:n.boolean(),objects:n.boolean()}).or(\"arrays\",\"objects\")],language:n.object(),presence:n.string().only(\"required\",\"optional\",\"forbidden\",\"ignore\"),raw:n.boolean(),context:n.object(),strip:n.boolean(),noDefaults:n.boolean(),escapeHtml:n.boolean()}).strict()},function(e,t,r){\"use strict\";t.errors={root:\"value\",key:'\"{{!label}}\" ',messages:{wrapArrays:!0},any:{unknown:\"is not allowed\",invalid:\"contains an invalid value\",empty:\"is not allowed to be empty\",required:\"is required\",allowOnly:\"must be one of {{valids}}\",default:\"threw an error when running default method\"},alternatives:{base:\"not matching any of the allowed alternatives\",child:null},array:{base:\"must be an array\",includes:\"at position {{pos}} does not match any of the allowed types\",includesSingle:'single value of \"{{!label}}\" does not match any of the allowed types',includesOne:\"at position {{pos}} fails because {{reason}}\",includesOneSingle:'single value of \"{{!label}}\" fails because {{reason}}',includesRequiredUnknowns:\"does not contain {{unknownMisses}} required value(s)\",includesRequiredKnowns:\"does not contain {{knownMisses}}\",includesRequiredBoth:\"does not contain {{knownMisses}} and {{unknownMisses}} other required value(s)\",excludes:\"at position {{pos}} contains an excluded value\",excludesSingle:'single value of \"{{!label}}\" contains an excluded value',min:\"must contain at least {{limit}} items\",max:\"must contain less than or equal to {{limit}} items\",length:\"must contain {{limit}} items\",ordered:\"at position {{pos}} fails because {{reason}}\",orderedLength:\"at position {{pos}} fails because array must contain at most {{limit}} items\",ref:'references \"{{ref}}\" which is not a positive integer',sparse:\"must not be a sparse array\",unique:\"position {{pos}} contains a duplicate value\"},boolean:{base:\"must be a boolean\"},binary:{base:\"must be a buffer or a string\",min:\"must be at least {{limit}} bytes\",max:\"must be less than or equal to {{limit}} bytes\",length:\"must be {{limit}} bytes\"},date:{base:\"must be a number of milliseconds or valid date string\",format:\"must be a string with one of the following formats {{format}}\",strict:\"must be a valid date\",min:'must be larger than or equal to \"{{limit}}\"',max:'must be less than or equal to \"{{limit}}\"',less:'must be less than \"{{limit}}\"',greater:'must be greater than \"{{limit}}\"',isoDate:\"must be a valid ISO 8601 date\",timestamp:{javascript:\"must be a valid timestamp or number of milliseconds\",unix:\"must be a valid timestamp or number of seconds\"},ref:'references \"{{ref}}\" which is not a date'},function:{base:\"must be a Function\",arity:\"must have an arity of {{n}}\",minArity:\"must have an arity greater or equal to {{n}}\",maxArity:\"must have an arity lesser or equal to {{n}}\",ref:\"must be a Joi reference\",class:\"must be a class\"},lazy:{base:\"!!schema error: lazy schema must be set\",schema:\"!!schema error: lazy schema function must return a schema\"},object:{base:\"must be an object\",child:'!!child \"{{!child}}\" fails because {{reason}}',min:\"must have at least {{limit}} children\",max:\"must have less than or equal to {{limit}} children\",length:\"must have {{limit}} children\",allowUnknown:'!!\"{{!child}}\" is not allowed',with:'!!\"{{mainWithLabel}}\" missing required peer \"{{peerWithLabel}}\"',without:'!!\"{{mainWithLabel}}\" conflict with forbidden peer \"{{peerWithLabel}}\"',missing:\"must contain at least one of {{peersWithLabels}}\",xor:\"contains a conflict between exclusive peers {{peersWithLabels}}\",or:\"must contain at least one of {{peersWithLabels}}\",and:\"contains {{presentWithLabels}} without its required peers {{missingWithLabels}}\",nand:'!!\"{{mainWithLabel}}\" must not exist simultaneously with {{peersWithLabels}}',assert:'!!\"{{ref}}\" validation failed because \"{{ref}}\" failed to {{message}}',rename:{multiple:'cannot rename child \"{{from}}\" because multiple renames are disabled and another key was already renamed to \"{{to}}\"',override:'cannot rename child \"{{from}}\" because override is disabled and target \"{{to}}\" exists',regex:{multiple:'cannot rename children {{from}} because multiple renames are disabled and another key was already renamed to \"{{to}}\"',override:'cannot rename children {{from}} because override is disabled and target \"{{to}}\" exists'}},type:'must be an instance of \"{{type}}\"',schema:\"must be a Joi instance\"},number:{base:\"must be a number\",min:\"must be larger than or equal to {{limit}}\",max:\"must be less than or equal to {{limit}}\",less:\"must be less than {{limit}}\",greater:\"must be greater than {{limit}}\",float:\"must be a float or double\",integer:\"must be an integer\",negative:\"must be a negative number\",positive:\"must be a positive number\",precision:\"must have no more than {{limit}} decimal places\",ref:'references \"{{ref}}\" which is not a number',multiple:\"must be a multiple of {{multiple}}\",port:\"must be a valid port\"},string:{base:\"must be a string\",min:\"length must be at least {{limit}} characters long\",max:\"length must be less than or equal to {{limit}} characters long\",length:\"length must be {{limit}} characters long\",alphanum:\"must only contain alpha-numeric characters\",token:\"must only contain alpha-numeric and underscore characters\",regex:{base:'with value \"{{!value}}\" fails to match the required pattern: {{pattern}}',name:'with value \"{{!value}}\" fails to match the {{name}} pattern',invert:{base:'with value \"{{!value}}\" matches the inverted pattern: {{pattern}}',name:'with value \"{{!value}}\" matches the inverted {{name}} pattern'}},email:\"must be a valid email\",uri:\"must be a valid uri\",uriRelativeOnly:\"must be a valid relative uri\",uriCustomScheme:\"must be a valid uri with a scheme matching the {{scheme}} pattern\",isoDate:\"must be a valid ISO 8601 date\",guid:\"must be a valid GUID\",hex:\"must only contain hexadecimal characters\",hexAlign:\"hex decoded representation must be byte aligned\",base64:\"must be a valid base64 string\",hostname:\"must be a valid hostname\",normalize:\"must be unicode normalized in the {{form}} form\",lowercase:\"must only contain lowercase characters\",uppercase:\"must only contain uppercase characters\",trim:\"must not have leading or trailing whitespace\",creditCard:\"must be a credit card\",ref:'references \"{{ref}}\" which is not a number',ip:\"must be a valid ip address with a {{cidr}} CIDR\",ipVersion:\"must be a valid ip address of one of the following versions {{version}} with a {{cidr}} CIDR\"}}},function(e,t,r){\"use strict\";const n={};t.escapeJavaScript=function(e){if(!e)return\"\";let t=\"\";for(let r=0;r<e.length;++r){const i=e.charCodeAt(r);n.isSafe(i)?t+=e[r]:t+=n.escapeJavaScriptChar(i)}return t},t.escapeHtml=function(e){if(!e)return\"\";let t=\"\";for(let r=0;r<e.length;++r){const i=e.charCodeAt(r);n.isSafe(i)?t+=e[r]:t+=n.escapeHtmlChar(i)}return t},t.escapeJson=function(e){if(!e)return\"\";let t;return e.replace(/[<>&\\u2028\\u2029]/g,e=>60===(t=e.charCodeAt(0))?\"\\\\u003c\":62===t?\"\\\\u003e\":38===t?\"\\\\u0026\":8232===t?\"\\\\u2028\":\"\\\\u2029\")},n.escapeJavaScriptChar=function(e){if(e>=256)return\"\\\\u\"+n.padLeft(\"\"+e,4);const t=Buffer.from(String.fromCharCode(e),\"ascii\").toString(\"hex\");return\"\\\\x\"+n.padLeft(t,2)},n.escapeHtmlChar=function(e){const t=n.namedHtml[e];if(void 0!==t)return t;if(e>=256)return\"&#\"+e+\";\";const r=Buffer.from(String.fromCharCode(e),\"ascii\").toString(\"hex\");return\"&#x\"+n.padLeft(r,2)+\";\"},n.padLeft=function(e,t){for(;e.length<t;)e=\"0\"+e;return e},n.isSafe=function(e){return void 0!==n.safeCharCodes[e]},n.namedHtml={38:\"&amp;\",60:\"&lt;\",62:\"&gt;\",34:\"&quot;\",160:\"&nbsp;\",162:\"&cent;\",163:\"&pound;\",164:\"&curren;\",169:\"&copy;\",174:\"&reg;\"},n.safeCharCodes=function(){const e={};for(let t=32;t<123;++t)(t>=97||t>=65&&t<=90||t>=48&&t<=57||32===t||46===t||44===t||45===t||58===t||95===t)&&(e[t]=null);return e}()},function(e,t,r){\"use strict\";const n=r(305).extend(r(686)),i=n.object().keys({repo:n.alternatives().try(n.object(),n.string()).allow(null),init:n.alternatives().try(n.boolean(),n.object().keys({bits:n.number().integer()})).allow(null),start:n.boolean(),pass:n.string().allow(\"\"),EXPERIMENTAL:n.object().keys({pubsub:n.boolean(),sharding:n.boolean(),dht:n.boolean()}).allow(null),config:n.object().keys({Addresses:n.object().keys({Swarm:n.array().items(n.multiaddr().options({convert:!1})),API:n.multiaddr().options({convert:!1}),Gateway:n.multiaddr().options({convert:!1})}).allow(null),Discovery:n.object().keys({MDNS:n.object().keys({Enabled:n.boolean(),Interval:n.number().integer()}).allow(null),webRTCStar:n.object().keys({Enabled:n.boolean()}).allow(null)}).allow(null),Bootstrap:n.array().items(n.multiaddr().IPFS().options({convert:!1}))}).allow(null),libp2p:n.object().keys({modules:n.object().allow(null)}).allow(null)}).options({allowUnknown:!0});e.exports.validate=(e=>n.attempt(e,i))},function(e,t,r){(function(e){var r=200,n=\"Expected a function\",i=\"__lodash_hash_undefined__\",s=1,o=2,a=1/0,u=9007199254740991,c=\"[object Arguments]\",f=\"[object Array]\",l=\"[object Boolean]\",h=\"[object Date]\",p=\"[object Error]\",d=\"[object Function]\",y=\"[object GeneratorFunction]\",m=\"[object Map]\",g=\"[object Number]\",v=\"[object Object]\",b=\"[object RegExp]\",w=\"[object Set]\",_=\"[object String]\",k=\"[object Symbol]\",S=\"[object ArrayBuffer]\",E=\"[object DataView]\",x=/\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,A=/^\\w*$/,B=/^\\./,C=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g,I=/\\\\(\\\\)?/g,T=/^\\[object .+?Constructor\\]$/,D=/^(?:0|[1-9]\\d*)$/,P={};P[\"[object Float32Array]\"]=P[\"[object Float64Array]\"]=P[\"[object Int8Array]\"]=P[\"[object Int16Array]\"]=P[\"[object Int32Array]\"]=P[\"[object Uint8Array]\"]=P[\"[object Uint8ClampedArray]\"]=P[\"[object Uint16Array]\"]=P[\"[object Uint32Array]\"]=!0,P[c]=P[f]=P[S]=P[l]=P[E]=P[h]=P[p]=P[d]=P[m]=P[g]=P[v]=P[b]=P[w]=P[_]=P[\"[object WeakMap]\"]=!1;var O=\"object\"==typeof global&&global&&global.Object===Object&&global,N=\"object\"==typeof self&&self&&self.Object===Object&&self,U=O||N||Function(\"return this\")(),R=\"object\"==typeof t&&t&&!t.nodeType&&t,L=R&&\"object\"==typeof e&&e&&!e.nodeType&&e,F=L&&L.exports===R&&O.process,j=function(){try{return F&&F.binding(\"util\")}catch(e){}}(),M=j&&j.isTypedArray;function K(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!=t)return function(e,t,r,n){var i=e.length,s=r+(n?1:-1);for(;n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}(e,V,r);var n=r-1,i=e.length;for(;++n<i;)if(e[n]===t)return n;return-1}(e,t,0)>-1}function H(e,t,r){for(var n=-1,i=e?e.length:0;++n<i;)if(r(t,e[n]))return!0;return!1}function z(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}function V(e){return e!=e}function q(e,t){return e.has(t)}function G(e){var t=!1;if(null!=e&&\"function\"!=typeof e.toString)try{t=!!(e+\"\")}catch(e){}return t}function W(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function $(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var X,J,Y,Q=Array.prototype,Z=Function.prototype,ee=Object.prototype,te=U[\"__core-js_shared__\"],re=(X=/[^.]+$/.exec(te&&te.keys&&te.keys.IE_PROTO||\"\"))?\"Symbol(src)_1.\"+X:\"\",ne=Z.toString,ie=ee.hasOwnProperty,se=ee.toString,oe=RegExp(\"^\"+ne.call(ie).replace(/[\\\\^$.*+?()[\\]{}|]/g,\"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,\"$1.*?\")+\"$\"),ae=U.Symbol,ue=U.Uint8Array,ce=ee.propertyIsEnumerable,fe=Q.splice,le=(J=Object.keys,Y=Object,function(e){return J(Y(e))}),he=ze(U,\"DataView\"),pe=ze(U,\"Map\"),de=ze(U,\"Promise\"),ye=ze(U,\"Set\"),me=ze(U,\"WeakMap\"),ge=ze(Object,\"create\"),ve=Ye(he),be=Ye(pe),we=Ye(de),_e=Ye(ye),ke=Ye(me),Se=ae?ae.prototype:void 0,Ee=Se?Se.valueOf:void 0,xe=Se?Se.toString:void 0;function Ae(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Be(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ce(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ie(e){var t=-1,r=e?e.length:0;for(this.__data__=new Ce;++t<r;)this.add(e[t])}function Te(e){this.__data__=new Be(e)}function De(e,t){var r=tt(e)||et(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var s in e)!t&&!ie.call(e,s)||i&&(\"length\"==s||qe(s,n))||r.push(s);return r}function Pe(e,t){for(var r=e.length;r--;)if(Ze(e[r][0],t))return r;return-1}function Oe(e,t){for(var r=0,n=(t=Ge(t,e)?[t]:je(t)).length;null!=e&&r<n;)e=e[Je(t[r++])];return r&&r==n?e:void 0}function Ne(e,t){return null!=e&&t in Object(e)}function Ue(e,t,r,n,i){return e===t||(null==e||null==t||!st(e)&&!ot(t)?e!=e&&t!=t:function(e,t,r,n,i,a){var u=tt(e),d=tt(t),y=f,x=f;u||(y=(y=Ve(e))==c?v:y);d||(x=(x=Ve(t))==c?v:x);var A=y==v&&!G(e),B=x==v&&!G(t),C=y==x;if(C&&!A)return a||(a=new Te),u||ut(e)?Ke(e,t,r,n,i,a):function(e,t,r,n,i,a,u){switch(r){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case S:return!(e.byteLength!=t.byteLength||!n(new ue(e),new ue(t)));case l:case h:case g:return Ze(+e,+t);case p:return e.name==t.name&&e.message==t.message;case b:case _:return e==t+\"\";case m:var c=W;case w:var f=a&o;if(c||(c=$),e.size!=t.size&&!f)return!1;var d=u.get(e);if(d)return d==t;a|=s,u.set(e,t);var y=Ke(c(e),c(t),n,i,a,u);return u.delete(e),y;case k:if(Ee)return Ee.call(e)==Ee.call(t)}return!1}(e,t,y,r,n,i,a);if(!(i&o)){var I=A&&ie.call(e,\"__wrapped__\"),T=B&&ie.call(t,\"__wrapped__\");if(I||T){var D=I?e.value():e,P=T?t.value():t;return a||(a=new Te),r(D,P,n,i,a)}}if(!C)return!1;return a||(a=new Te),function(e,t,r,n,i,s){var a=i&o,u=ct(e),c=u.length,f=ct(t).length;if(c!=f&&!a)return!1;for(var l=c;l--;){var h=u[l];if(!(a?h in t:ie.call(t,h)))return!1}var p=s.get(e);if(p&&s.get(t))return p==t;var d=!0;s.set(e,t),s.set(t,e);for(var y=a;++l<c;){h=u[l];var m=e[h],g=t[h];if(n)var v=a?n(g,m,h,t,e,s):n(m,g,h,e,t,s);if(!(void 0===v?m===g||r(m,g,n,i,s):v)){d=!1;break}y||(y=\"constructor\"==h)}if(d&&!y){var b=e.constructor,w=t.constructor;b!=w&&\"constructor\"in e&&\"constructor\"in t&&!(\"function\"==typeof b&&b instanceof b&&\"function\"==typeof w&&w instanceof w)&&(d=!1)}return s.delete(e),s.delete(t),d}(e,t,r,n,i,a)}(e,t,Ue,r,n,i))}function Re(e){return!(!st(e)||re&&re in e)&&(nt(e)||G(e)?oe:T).test(Ye(e))}function Le(e){return\"function\"==typeof e?e:null==e?ft:\"object\"==typeof e?tt(e)?function(e,t){if(Ge(e)&&We(t))return $e(Je(e),t);return function(r){var n=function(e,t,r){var n=null==e?void 0:Oe(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?function(e,t){return null!=e&&function(e,t,r){var n,i=-1,s=(t=Ge(t,e)?[t]:je(t)).length;for(;++i<s;){var o=Je(t[i]);if(!(n=null!=e&&r(e,o)))break;e=e[o]}if(n)return n;return!!(s=e?e.length:0)&&it(s)&&qe(o,s)&&(tt(e)||et(e))}(e,t,Ne)}(r,e):Ue(t,n,void 0,s|o)}}(e[0],e[1]):function(e){var t=function(e){var t=ct(e),r=t.length;for(;r--;){var n=t[r],i=e[n];t[r]=[n,i,We(i)]}return t}(e);if(1==t.length&&t[0][2])return $e(t[0][0],t[0][1]);return function(r){return r===e||function(e,t,r,n){var i=r.length,a=i,u=!n;if(null==e)return!a;for(e=Object(e);i--;){var c=r[i];if(u&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<a;){var f=(c=r[i])[0],l=e[f],h=c[1];if(u&&c[2]){if(void 0===l&&!(f in e))return!1}else{var p=new Te;if(n)var d=n(l,h,f,e,t,p);if(!(void 0===d?Ue(h,l,n,s|o,p):d))return!1}}return!0}(r,e,t)}}(e):Ge(t=e)?(r=Je(t),function(e){return null==e?void 0:e[r]}):function(e){return function(t){return Oe(t,e)}}(t);var t,r}function Fe(e){if(r=(t=e)&&t.constructor,n=\"function\"==typeof r&&r.prototype||ee,t!==n)return le(e);var t,r,n,i=[];for(var s in Object(e))ie.call(e,s)&&\"constructor\"!=s&&i.push(s);return i}function je(e){return tt(e)?e:Xe(e)}Ae.prototype.clear=function(){this.__data__=ge?ge(null):{}},Ae.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ae.prototype.get=function(e){var t=this.__data__;if(ge){var r=t[e];return r===i?void 0:r}return ie.call(t,e)?t[e]:void 0},Ae.prototype.has=function(e){var t=this.__data__;return ge?void 0!==t[e]:ie.call(t,e)},Ae.prototype.set=function(e,t){return this.__data__[e]=ge&&void 0===t?i:t,this},Be.prototype.clear=function(){this.__data__=[]},Be.prototype.delete=function(e){var t=this.__data__,r=Pe(t,e);return!(r<0||(r==t.length-1?t.pop():fe.call(t,r,1),0))},Be.prototype.get=function(e){var t=this.__data__,r=Pe(t,e);return r<0?void 0:t[r][1]},Be.prototype.has=function(e){return Pe(this.__data__,e)>-1},Be.prototype.set=function(e,t){var r=this.__data__,n=Pe(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},Ce.prototype.clear=function(){this.__data__={hash:new Ae,map:new(pe||Be),string:new Ae}},Ce.prototype.delete=function(e){return He(this,e).delete(e)},Ce.prototype.get=function(e){return He(this,e).get(e)},Ce.prototype.has=function(e){return He(this,e).has(e)},Ce.prototype.set=function(e,t){return He(this,e).set(e,t),this},Ie.prototype.add=Ie.prototype.push=function(e){return this.__data__.set(e,i),this},Ie.prototype.has=function(e){return this.__data__.has(e)},Te.prototype.clear=function(){this.__data__=new Be},Te.prototype.delete=function(e){return this.__data__.delete(e)},Te.prototype.get=function(e){return this.__data__.get(e)},Te.prototype.has=function(e){return this.__data__.has(e)},Te.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Be){var i=n.__data__;if(!pe||i.length<r-1)return i.push([e,t]),this;n=this.__data__=new Ce(i)}return n.set(e,t),this};var Me=ye&&1/$(new ye([,-0]))[1]==a?function(e){return new ye(e)}:function(){};function Ke(e,t,r,n,i,a){var u=i&o,c=e.length,f=t.length;if(c!=f&&!(u&&f>c))return!1;var l=a.get(e);if(l&&a.get(t))return l==t;var h=-1,p=!0,d=i&s?new Ie:void 0;for(a.set(e,t),a.set(t,e);++h<c;){var y=e[h],m=t[h];if(n)var g=u?n(m,y,h,t,e,a):n(y,m,h,e,t,a);if(void 0!==g){if(g)continue;p=!1;break}if(d){if(!z(t,function(e,t){if(!d.has(t)&&(y===e||r(y,e,n,i,a)))return d.add(t)})){p=!1;break}}else if(y!==m&&!r(y,m,n,i,a)){p=!1;break}}return a.delete(e),a.delete(t),p}function He(e,t){var r,n,i=e.__data__;return(\"string\"==(n=typeof(r=t))||\"number\"==n||\"symbol\"==n||\"boolean\"==n?\"__proto__\"!==r:null===r)?i[\"string\"==typeof t?\"string\":\"hash\"]:i.map}function ze(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Re(r)?r:void 0}var Ve=function(e){return se.call(e)};function qe(e,t){return!!(t=null==t?u:t)&&(\"number\"==typeof e||D.test(e))&&e>-1&&e%1==0&&e<t}function Ge(e,t){if(tt(e))return!1;var r=typeof e;return!(\"number\"!=r&&\"symbol\"!=r&&\"boolean\"!=r&&null!=e&&!at(e))||(A.test(e)||!x.test(e)||null!=t&&e in Object(t))}function We(e){return e==e&&!st(e)}function $e(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}(he&&Ve(new he(new ArrayBuffer(1)))!=E||pe&&Ve(new pe)!=m||de&&\"[object Promise]\"!=Ve(de.resolve())||ye&&Ve(new ye)!=w||me&&\"[object WeakMap]\"!=Ve(new me))&&(Ve=function(e){var t=se.call(e),r=t==v?e.constructor:void 0,n=r?Ye(r):void 0;if(n)switch(n){case ve:return E;case be:return m;case we:return\"[object Promise]\";case _e:return w;case ke:return\"[object WeakMap]\"}return t});var Xe=Qe(function(e){var t;e=null==(t=e)?\"\":function(e){if(\"string\"==typeof e)return e;if(at(e))return xe?xe.call(e):\"\";var t=e+\"\";return\"0\"==t&&1/e==-a?\"-0\":t}(t);var r=[];return B.test(e)&&r.push(\"\"),e.replace(C,function(e,t,n,i){r.push(n?i.replace(I,\"$1\"):t||e)}),r});function Je(e){if(\"string\"==typeof e||at(e))return e;var t=e+\"\";return\"0\"==t&&1/e==-a?\"-0\":t}function Ye(e){if(null!=e){try{return ne.call(e)}catch(e){}try{return e+\"\"}catch(e){}}return\"\"}function Qe(e,t){if(\"function\"!=typeof e||t&&\"function\"!=typeof t)throw new TypeError(n);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=e.apply(this,n);return r.cache=s.set(i,o),o};return r.cache=new(Qe.Cache||Ce),r}function Ze(e,t){return e===t||e!=e&&t!=t}function et(e){return function(e){return ot(e)&&rt(e)}(e)&&ie.call(e,\"callee\")&&(!ce.call(e,\"callee\")||se.call(e)==c)}Qe.Cache=Ce;var tt=Array.isArray;function rt(e){return null!=e&&it(e.length)&&!nt(e)}function nt(e){var t=st(e)?se.call(e):\"\";return t==d||t==y}function it(e){return\"number\"==typeof e&&e>-1&&e%1==0&&e<=u}function st(e){var t=typeof e;return!!e&&(\"object\"==t||\"function\"==t)}function ot(e){return!!e&&\"object\"==typeof e}function at(e){return\"symbol\"==typeof e||ot(e)&&se.call(e)==k}var ut=M?function(e){return function(t){return e(t)}}(M):function(e){return ot(e)&&it(e.length)&&!!P[se.call(e)]};function ct(e){return rt(e)?De(e):Fe(e)}function ft(e){return e}e.exports=function(e,t){return e&&e.length?function(e,t,n){var i=-1,s=K,o=e.length,a=!0,u=[],c=u;if(n)a=!1,s=H;else if(o>=r){var f=t?null:Me(e);if(f)return $(f);a=!1,s=q,c=new Ie}else c=t?[]:u;e:for(;++i<o;){var l=e[i],h=t?t(l):l;if(l=n||0!==l?l:0,a&&h==h){for(var p=c.length;p--;)if(c[p]===h)continue e;t&&c.push(h),u.push(l)}else s(c,h,n)||(c!==u&&c.push(h),u.push(l))}return u}(e,Le(t)):[]}}).call(this,r(55)(e))},function(e,t,r){\"use strict\";const n=r(308).ensureMultiaddr,i=r(703);e.exports=class{constructor(e){this._multiaddrs=e||[],this._observedMultiaddrs=[]}add(e){e=n(e),this.has(e)||this._multiaddrs.push(e)}addSafe(e){e=n(e),this._observedMultiaddrs.some((t,r)=>{if(t.equals(e))return this.add(e),this._observedMultiaddrs.splice(r,1),!0})||this._observedMultiaddrs.push(e)}toArray(){return this._multiaddrs.slice()}get size(){return this._multiaddrs.length}forEach(e){return this._multiaddrs.forEach(e)}has(e){return e=n(e),this._multiaddrs.some(t=>t.equals(e))}delete(e){e=n(e),this._multiaddrs.some((t,r)=>{if(t.equals(e))return this._multiaddrs.splice(r,1),!0})}replace(e,t){Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]),e.forEach(e=>this.delete(e)),t.forEach(e=>this.add(e))}clear(){this._multiaddrs=[]}distinct(){return i(this._multiaddrs,e=>[e.toOptions().port,e.toOptions().transport].join())}}},function(e,t,r){\"use strict\";const n=r(307),i=r(177),s=r(56),o=r(22);function a(e,t){return t instanceof Buffer?a.toString(e,t):a.toBuffer(e,t)}e.exports=a,a.toString=function(e,t){switch((e=i(e)).code){case 4:case 41:return n.toString(t);case 6:case 17:case 33:case 132:return function(e){return e.readUInt16BE(0)}(t);case 54:case 55:case 56:return function(e){const t=o.decode(e);if((e=e.slice(o.decode.bytes)).length!==t)throw new Error(\"inconsistent lengths\");return e.toString()}(t);case 421:return function(e){const t=o.decode(e),r=e.slice(o.decode.bytes);if(r.length!==t)throw new Error(\"inconsistent lengths\");return s.encode(r)}(t);default:return t.toString(\"hex\")}},a.toBuffer=function(e,t){switch((e=i(e)).code){case 4:case 41:return n.toBuffer(t);case 6:case 17:case 33:case 132:return function(e){const t=Buffer.alloc(2);return t.writeUInt16BE(e,0),t}(parseInt(t,10));case 54:case 55:case 56:return function(e){const t=Buffer.from(e),r=Buffer.from(o.encode(t.length));return Buffer.concat([r,t])}(t);case 421:return function(e){const t=Buffer.from(s.decode(e)),r=Buffer.from(o.encode(t.length));return Buffer.concat([r,t])}(t);default:return Buffer.from(t,\"hex\")}}},function(e,t,r){(function(e){var r=200,n=\"Expected a function\",i=\"__lodash_hash_undefined__\",s=1,o=2,a=1/0,u=9007199254740991,c=\"[object Arguments]\",f=\"[object Array]\",l=\"[object Boolean]\",h=\"[object Date]\",p=\"[object Error]\",d=\"[object Function]\",y=\"[object GeneratorFunction]\",m=\"[object Map]\",g=\"[object Number]\",v=\"[object Object]\",b=\"[object RegExp]\",w=\"[object Set]\",_=\"[object String]\",k=\"[object Symbol]\",S=\"[object ArrayBuffer]\",E=\"[object DataView]\",x=/\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,A=/^\\w*$/,B=/^\\./,C=/[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g,I=/\\\\(\\\\)?/g,T=/^\\[object .+?Constructor\\]$/,D=/^(?:0|[1-9]\\d*)$/,P={};P[\"[object Float32Array]\"]=P[\"[object Float64Array]\"]=P[\"[object Int8Array]\"]=P[\"[object Int16Array]\"]=P[\"[object Int32Array]\"]=P[\"[object Uint8Array]\"]=P[\"[object Uint8ClampedArray]\"]=P[\"[object Uint16Array]\"]=P[\"[object Uint32Array]\"]=!0,P[c]=P[f]=P[S]=P[l]=P[E]=P[h]=P[p]=P[d]=P[m]=P[g]=P[v]=P[b]=P[w]=P[_]=P[\"[object WeakMap]\"]=!1;var O=\"object\"==typeof global&&global&&global.Object===Object&&global,N=\"object\"==typeof self&&self&&self.Object===Object&&self,U=O||N||Function(\"return this\")(),R=\"object\"==typeof t&&t&&!t.nodeType&&t,L=R&&\"object\"==typeof e&&e&&!e.nodeType&&e,F=L&&L.exports===R&&O.process,j=function(){try{return F&&F.binding(\"util\")}catch(e){}}(),M=j&&j.isTypedArray;function K(e,t){for(var r=-1,n=e?e.length:0,i=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[i++]=o)}return s}function H(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}function z(e){var t=!1;if(null!=e&&\"function\"!=typeof e.toString)try{t=!!(e+\"\")}catch(e){}return t}function V(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}function q(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var G,W,$,X=Array.prototype,J=Function.prototype,Y=Object.prototype,Q=U[\"__core-js_shared__\"],Z=(G=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||\"\"))?\"Symbol(src)_1.\"+G:\"\",ee=J.toString,te=Y.hasOwnProperty,re=Y.toString,ne=RegExp(\"^\"+ee.call(te).replace(/[\\\\^$.*+?()[\\]{}|]/g,\"\\\\$&\").replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g,\"$1.*?\")+\"$\"),ie=U.Symbol,se=U.Uint8Array,oe=Y.propertyIsEnumerable,ae=X.splice,ue=(W=Object.keys,$=Object,function(e){return W($(e))}),ce=Ve(U,\"DataView\"),fe=Ve(U,\"Map\"),le=Ve(U,\"Promise\"),he=Ve(U,\"Set\"),pe=Ve(U,\"WeakMap\"),de=Ve(Object,\"create\"),ye=Qe(ce),me=Qe(fe),ge=Qe(le),ve=Qe(he),be=Qe(pe),we=ie?ie.prototype:void 0,_e=we?we.valueOf:void 0,ke=we?we.toString:void 0;function Se(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ee(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function xe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ae(e){var t=-1,r=e?e.length:0;for(this.__data__=new xe;++t<r;)this.add(e[t])}function Be(e){this.__data__=new Ee(e)}function Ce(e,t){var r=rt(e)||tt(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var s in e)!t&&!te.call(e,s)||i&&(\"length\"==s||Ge(s,n))||r.push(s);return r}function Ie(e,t){for(var r=e.length;r--;)if(et(e[r][0],t))return r;return-1}Se.prototype.clear=function(){this.__data__=de?de(null):{}},Se.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Se.prototype.get=function(e){var t=this.__data__;if(de){var r=t[e];return r===i?void 0:r}return te.call(t,e)?t[e]:void 0},Se.prototype.has=function(e){var t=this.__data__;return de?void 0!==t[e]:te.call(t,e)},Se.prototype.set=function(e,t){return this.__data__[e]=de&&void 0===t?i:t,this},Ee.prototype.clear=function(){this.__data__=[]},Ee.prototype.delete=function(e){var t=this.__data__,r=Ie(t,e);return!(r<0||(r==t.length-1?t.pop():ae.call(t,r,1),0))},Ee.prototype.get=function(e){var t=this.__data__,r=Ie(t,e);return r<0?void 0:t[r][1]},Ee.prototype.has=function(e){return Ie(this.__data__,e)>-1},Ee.prototype.set=function(e,t){var r=this.__data__,n=Ie(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},xe.prototype.clear=function(){this.__data__={hash:new Se,map:new(fe||Ee),string:new Se}},xe.prototype.delete=function(e){return ze(this,e).delete(e)},xe.prototype.get=function(e){return ze(this,e).get(e)},xe.prototype.has=function(e){return ze(this,e).has(e)},xe.prototype.set=function(e,t){return ze(this,e).set(e,t),this},Ae.prototype.add=Ae.prototype.push=function(e){return this.__data__.set(e,i),this},Ae.prototype.has=function(e){return this.__data__.has(e)},Be.prototype.clear=function(){this.__data__=new Ee},Be.prototype.delete=function(e){return this.__data__.delete(e)},Be.prototype.get=function(e){return this.__data__.get(e)},Be.prototype.has=function(e){return this.__data__.has(e)},Be.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ee){var i=n.__data__;if(!fe||i.length<r-1)return i.push([e,t]),this;n=this.__data__=new xe(i)}return n.set(e,t),this};var Te,De,Pe=(Te=function(e,t){return e&&Ne(e,t,ft)},function(e,t){if(null==e)return e;if(!nt(e))return Te(e,t);for(var r=e.length,n=De?r:-1,i=Object(e);(De?n--:++n<r)&&!1!==t(i[n],n,i););return e});function Oe(e,t){var r=[];return Pe(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r}var Ne=function(e){return function(t,r,n){for(var i=-1,s=Object(t),o=n(t),a=o.length;a--;){var u=o[e?a:++i];if(!1===r(s[u],u,s))break}return t}}();function Ue(e,t){for(var r=0,n=(t=We(t,e)?[t]:Ke(t)).length;null!=e&&r<n;)e=e[Ye(t[r++])];return r&&r==n?e:void 0}function Re(e,t){return null!=e&&t in Object(e)}function Le(e,t,r,n,i){return e===t||(null==e||null==t||!ot(e)&&!at(t)?e!=e&&t!=t:function(e,t,r,n,i,a){var u=rt(e),d=rt(t),y=f,x=f;u||(y=(y=qe(e))==c?v:y);d||(x=(x=qe(t))==c?v:x);var A=y==v&&!z(e),B=x==v&&!z(t),C=y==x;if(C&&!A)return a||(a=new Be),u||ct(e)?He(e,t,r,n,i,a):function(e,t,r,n,i,a,u){switch(r){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case S:return!(e.byteLength!=t.byteLength||!n(new se(e),new se(t)));case l:case h:case g:return et(+e,+t);case p:return e.name==t.name&&e.message==t.message;case b:case _:return e==t+\"\";case m:var c=V;case w:var f=a&o;if(c||(c=q),e.size!=t.size&&!f)return!1;var d=u.get(e);if(d)return d==t;a|=s,u.set(e,t);var y=He(c(e),c(t),n,i,a,u);return u.delete(e),y;case k:if(_e)return _e.call(e)==_e.call(t)}return!1}(e,t,y,r,n,i,a);if(!(i&o)){var I=A&&te.call(e,\"__wrapped__\"),T=B&&te.call(t,\"__wrapped__\");if(I||T){var D=I?e.value():e,P=T?t.value():t;return a||(a=new Be),r(D,P,n,i,a)}}if(!C)return!1;return a||(a=new Be),function(e,t,r,n,i,s){var a=i&o,u=ft(e),c=u.length,f=ft(t).length;if(c!=f&&!a)return!1;for(var l=c;l--;){var h=u[l];if(!(a?h in t:te.call(t,h)))return!1}var p=s.get(e);if(p&&s.get(t))return p==t;var d=!0;s.set(e,t),s.set(t,e);for(var y=a;++l<c;){h=u[l];var m=e[h],g=t[h];if(n)var v=a?n(g,m,h,t,e,s):n(m,g,h,e,t,s);if(!(void 0===v?m===g||r(m,g,n,i,s):v)){d=!1;break}y||(y=\"constructor\"==h)}if(d&&!y){var b=e.constructor,w=t.constructor;b!=w&&\"constructor\"in e&&\"constructor\"in t&&!(\"function\"==typeof b&&b instanceof b&&\"function\"==typeof w&&w instanceof w)&&(d=!1)}return s.delete(e),s.delete(t),d}(e,t,r,n,i,a)}(e,t,Le,r,n,i))}function Fe(e){return!(!ot(e)||Z&&Z in e)&&(it(e)||z(e)?ne:T).test(Qe(e))}function je(e){return\"function\"==typeof e?e:null==e?lt:\"object\"==typeof e?rt(e)?function(e,t){if(We(e)&&$e(t))return Xe(Ye(e),t);return function(r){var n=function(e,t,r){var n=null==e?void 0:Ue(e,t);return void 0===n?r:n}(r,e);return void 0===n&&n===t?function(e,t){return null!=e&&function(e,t,r){var n,i=-1,s=(t=We(t,e)?[t]:Ke(t)).length;for(;++i<s;){var o=Ye(t[i]);if(!(n=null!=e&&r(e,o)))break;e=e[o]}if(n)return n;return!!(s=e?e.length:0)&&st(s)&&Ge(o,s)&&(rt(e)||tt(e))}(e,t,Re)}(r,e):Le(t,n,void 0,s|o)}}(e[0],e[1]):function(e){var t=function(e){var t=ft(e),r=t.length;for(;r--;){var n=t[r],i=e[n];t[r]=[n,i,$e(i)]}return t}(e);if(1==t.length&&t[0][2])return Xe(t[0][0],t[0][1]);return function(r){return r===e||function(e,t,r,n){var i=r.length,a=i,u=!n;if(null==e)return!a;for(e=Object(e);i--;){var c=r[i];if(u&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<a;){var f=(c=r[i])[0],l=e[f],h=c[1];if(u&&c[2]){if(void 0===l&&!(f in e))return!1}else{var p=new Be;if(n)var d=n(l,h,f,e,t,p);if(!(void 0===d?Le(h,l,n,s|o,p):d))return!1}}return!0}(r,e,t)}}(e):We(t=e)?(r=Ye(t),function(e){return null==e?void 0:e[r]}):function(e){return function(t){return Ue(t,e)}}(t);var t,r}function Me(e){if(r=(t=e)&&t.constructor,n=\"function\"==typeof r&&r.prototype||Y,t!==n)return ue(e);var t,r,n,i=[];for(var s in Object(e))te.call(e,s)&&\"constructor\"!=s&&i.push(s);return i}function Ke(e){return rt(e)?e:Je(e)}function He(e,t,r,n,i,a){var u=i&o,c=e.length,f=t.length;if(c!=f&&!(u&&f>c))return!1;var l=a.get(e);if(l&&a.get(t))return l==t;var h=-1,p=!0,d=i&s?new Ae:void 0;for(a.set(e,t),a.set(t,e);++h<c;){var y=e[h],m=t[h];if(n)var g=u?n(m,y,h,t,e,a):n(y,m,h,e,t,a);if(void 0!==g){if(g)continue;p=!1;break}if(d){if(!H(t,function(e,t){if(!d.has(t)&&(y===e||r(y,e,n,i,a)))return d.add(t)})){p=!1;break}}else if(y!==m&&!r(y,m,n,i,a)){p=!1;break}}return a.delete(e),a.delete(t),p}function ze(e,t){var r,n,i=e.__data__;return(\"string\"==(n=typeof(r=t))||\"number\"==n||\"symbol\"==n||\"boolean\"==n?\"__proto__\"!==r:null===r)?i[\"string\"==typeof t?\"string\":\"hash\"]:i.map}function Ve(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Fe(r)?r:void 0}var qe=function(e){return re.call(e)};function Ge(e,t){return!!(t=null==t?u:t)&&(\"number\"==typeof e||D.test(e))&&e>-1&&e%1==0&&e<t}function We(e,t){if(rt(e))return!1;var r=typeof e;return!(\"number\"!=r&&\"symbol\"!=r&&\"boolean\"!=r&&null!=e&&!ut(e))||(A.test(e)||!x.test(e)||null!=t&&e in Object(t))}function $e(e){return e==e&&!ot(e)}function Xe(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}(ce&&qe(new ce(new ArrayBuffer(1)))!=E||fe&&qe(new fe)!=m||le&&\"[object Promise]\"!=qe(le.resolve())||he&&qe(new he)!=w||pe&&\"[object WeakMap]\"!=qe(new pe))&&(qe=function(e){var t=re.call(e),r=t==v?e.constructor:void 0,n=r?Qe(r):void 0;if(n)switch(n){case ye:return E;case me:return m;case ge:return\"[object Promise]\";case ve:return w;case be:return\"[object WeakMap]\"}return t});var Je=Ze(function(e){var t;e=null==(t=e)?\"\":function(e){if(\"string\"==typeof e)return e;if(ut(e))return ke?ke.call(e):\"\";var t=e+\"\";return\"0\"==t&&1/e==-a?\"-0\":t}(t);var r=[];return B.test(e)&&r.push(\"\"),e.replace(C,function(e,t,n,i){r.push(n?i.replace(I,\"$1\"):t||e)}),r});function Ye(e){if(\"string\"==typeof e||ut(e))return e;var t=e+\"\";return\"0\"==t&&1/e==-a?\"-0\":t}function Qe(e){if(null!=e){try{return ee.call(e)}catch(e){}try{return e+\"\"}catch(e){}}return\"\"}function Ze(e,t){if(\"function\"!=typeof e||t&&\"function\"!=typeof t)throw new TypeError(n);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=e.apply(this,n);return r.cache=s.set(i,o),o};return r.cache=new(Ze.Cache||xe),r}function et(e,t){return e===t||e!=e&&t!=t}function tt(e){return function(e){return at(e)&&nt(e)}(e)&&te.call(e,\"callee\")&&(!oe.call(e,\"callee\")||re.call(e)==c)}Ze.Cache=xe;var rt=Array.isArray;function nt(e){return null!=e&&st(e.length)&&!it(e)}function it(e){var t=ot(e)?re.call(e):\"\";return t==d||t==y}function st(e){return\"number\"==typeof e&&e>-1&&e%1==0&&e<=u}function ot(e){var t=typeof e;return!!e&&(\"object\"==t||\"function\"==t)}function at(e){return!!e&&\"object\"==typeof e}function ut(e){return\"symbol\"==typeof e||at(e)&&re.call(e)==k}var ct=M?function(e){return function(t){return e(t)}}(M):function(e){return at(e)&&st(e.length)&&!!P[re.call(e)]};function ft(e){return nt(e)?Ce(e):Me(e)}function lt(e){return e}e.exports=function(e,t){return(rt(e)?K:Oe)(e,je(t))}}).call(this,r(55)(e))},function(e,t,r){\"use strict\";const n=r(178),i=r(706),s=r(705),o=r(177),a=r(22);function u(e){const t=[],r=e.split(\"/\").slice(1);if(1===r.length&&\"\"===r[0])return[];for(let n=0;n<r.length;n++){const i=r[n];if(0!==o(i).size){if(++n>=r.length)throw b(\"invalid address: \"+e);t.push([i,r[n]])}else t.push([i])}return t}function c(e){const t=[];return n(e,function(e){const r=w(e);t.push(r.name),e.length>1&&t.push(e[1])}),\"/\"+t.join(\"/\")}function f(e){return n(e,function(e){Array.isArray(e)||(e=[e]);const t=w(e);return e.length>1?[t.code,s.toBuffer(t.code,e[1])]:[t.code]})}function l(e){return n(e,function(e){const t=w(e);return e.length>1?[t.code,s.toString(t.code,e[1])]:[t.code]})}function h(e){return m(Buffer.concat(n(e,function(e){const t=w(e);let r=Buffer.from(a.encode(t.code));return e.length>1&&(r=Buffer.concat([r,e[1]])),r})))}function p(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;return a.decode(t)+a.decode.bytes}function d(e){const t=[];let r=0;for(;r<e.length;){const n=a.decode(e,r),i=a.decode.bytes,s=p(o(n),e.slice(r+i));if(0===s){t.push([n]),r+=i;continue}const u=e.slice(r+i,r+i+s);if((r+=s+i)>e.length)throw b(\"Invalid address buffer: \"+e.toString(\"hex\"));t.push([n,u])}return t}function y(e){return h(f(u(e=v(e))))}function m(e){const t=g(e);if(t)throw t;return Buffer.from(e)}function g(e){try{d(e)}catch(e){return e}}function v(e){return\"/\"+i(e.trim().split(\"/\")).join(\"/\")}function b(e){return new Error(\"Error parsing address: \"+e)}function w(e){return o(e[0])}e.exports={stringToStringTuples:u,stringTuplesToString:c,tuplesToStringTuples:l,stringTuplesToTuples:f,bufferToTuples:d,tuplesToBuffer:h,bufferToString:function(e){return c(l(d(e)))},stringToBuffer:y,fromString:function(e){return y(e)},fromBuffer:m,validateBuffer:g,isValidBuffer:function(e){return void 0===g(e)},cleanPath:v,ParseError:b,protoFromTuple:w,sizeForAddr:p}},function(e,t,r){\"use strict\";const n=r(97),i={sha1:\"sha1\",\"sha2-256\":\"sha256\",\"sha2-512\":\"sha512\"};e.exports=function(e,t,r,s,o){const a=i[o];if(!a)throw new Error(`Hash '${o}' is unknown or not supported`);const u=n.pkcs5.pbkdf2(e,t,r,s,a);return n.util.encode64(u)}},function(e,t,r){\"use strict\";const n=r(24),i=r(2),s={\"P-256\":\"prime256v1\",\"P-384\":\"secp384r1\",\"P-521\":\"secp521r1\"};t.generateEphmeralKeyPair=function(e,t){if(!s[e])return t(new Error(`Unkown curve: ${e}`));const r=n.createECDH(s[e]);r.generateKeys(),i(()=>t(null,{key:r.getPublicKey(),genSharedKey(e,t,n){let s;\"function\"==typeof t&&(n=t,t=null),t&&r.setPrivateKey(t.private);try{s=r.computeSecret(e)}catch(e){return n(e)}i(()=>n(null,s))}}))}},function(e,t,r){\"use strict\";const n=r(709);e.exports=((e,t)=>{n.generateEphmeralKeyPair(e,t)})},function(e,t,r){\"use strict\";const n=r(146),i=r(327),s={\"AES-128\":{ivSize:16,keySize:16},\"AES-256\":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};e.exports=((e,t,r,o)=>{const a=s[e];if(!a)return o(new Error(\"unkown cipherType passed\"));if(!t)return o(new Error(\"unkown hashType passed\"));const u=a.keySize,c=a.ivSize,f=Buffer.from(\"key expansion\"),l=2*(c+u+20);i.create(t,r,(e,t)=>{if(e)return o(e);t.digest(f,(e,r)=>{if(e)return o(e);let i=[],s=0;n(()=>s<l,function(e){t.digest(Buffer.concat([r,f]),(n,o)=>{if(n)return e(n);let a=o.length;s+a>l&&(a=l-s),i.push(o),s+=a,t.digest(r,(t,n)=>{if(t)return e(t);r=n,e()})})},function(e){if(e)return o(e);const t=l/2,r=Buffer.concat(i),n=r.slice(0,t),s=r.slice(t,l),a=e=>({iv:e.slice(0,c),cipherKey:e.slice(c,c+u),macKey:e.slice(c+u)});o(null,{k1:a(n),k2:a(s)})})})})})},function(e,t){e.exports=require(\"secp256k1\")},function(e,t,r){\"use strict\";const n=r(712),i=r(31),s=r(2),o=\"sha2-256\";e.exports=(e=>{function t(e){if(!n.privateKeyVerify(e))throw new Error(\"Invalid private key\")}return{generateKey:function(t){let r;do{r=e(32)}while(!n.privateKeyVerify(r));((e,r)=>s(()=>t(e,r)))(null,r)},privateKeyLength:32,hashAndSign:function(e,t,r){const a=(e,t)=>s(()=>r(e,t));i.digest(t,o,(t,r)=>{if(t)return a(t);try{const i=n.sign(r,e),s=n.signatureExport(i.signature);return a(null,s)}catch(t){a(t)}})},hashAndVerify:function(e,t,r,a){const u=(e,t)=>s(()=>a(e,t));i.digest(r,o,(r,i)=>{if(r)return u(r);try{t=n.signatureImport(t);const s=n.verify(i,t,e);return u(null,s)}catch(r){u(r)}})},compressPublicKey:function(e){if(!n.publicKeyVerify(e))throw new Error(\"Invalid public key\");return n.publicKeyConvert(e,!0)},decompressPublicKey:function(e){return n.publicKeyConvert(e,!1)},validatePrivateKey:t,validatePublicKey:function(e){if(!n.publicKeyVerify(e))throw new Error(\"Invalid public key\")},computePublicKey:function(e){return t(e),n.publicKeyCreate(e)}}})},function(e,t,r){\"use strict\";const n=r(31);e.exports=((e,t,i)=>{i=i||r(713)(t);class s{constructor(e){i.validatePublicKey(e),this._key=e}verify(e,t,r){a(r),i.hashAndVerify(this._key,t,e,r)}marshal(){return i.compressPublicKey(this._key)}get bytes(){return e.PublicKey.encode({Type:e.KeyType.Secp256k1,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){a(e),n(this.bytes,\"sha2-256\",e)}}class o{constructor(e,t){this._key=e,this._publicKey=t||i.computePublicKey(e),i.validatePrivateKey(this._key),i.validatePublicKey(this._publicKey)}sign(e,t){a(t),i.hashAndSign(this._key,e,t)}get public(){return new s(this._publicKey)}marshal(){return this._key}get bytes(){return e.PrivateKey.encode({Type:e.KeyType.Secp256k1,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){a(e),n(this.bytes,\"sha2-256\",e)}}function a(e){if(\"function\"!=typeof e)throw new Error(\"callback is required\")}return{Secp256k1PublicKey:s,Secp256k1PrivateKey:o,unmarshalSecp256k1PrivateKey:function(e,t){t(null,new o(e),null)},unmarshalSecp256k1PublicKey:function(e){return new s(e)},generateKeyPair:function(e,t){void 0===t&&\"function\"==typeof e&&(t=e),a(t),i.generateKey((e,r)=>{if(e)return t(e);let n;try{n=new o(r)}catch(e){return t(e)}t(null,n)})}}})},function(e,t){e.exports=require(\"tweetnacl\")},function(e,t,r){\"use strict\";const n=r(715),i=r(2);t.publicKeyLength=n.sign.publicKeyLength,t.privateKeyLength=n.sign.secretKeyLength,t.generateKey=function(e){i(()=>{let t;try{t=n.sign.keyPair()}catch(t){return e(t)}e(null,t)})},t.generateKeyFromSeed=function(e,t){i(()=>{let r;try{r=n.sign.keyPair.fromSeed(e)}catch(e){return t(e)}t(null,r)})},t.hashAndSign=function(e,t,r){i(()=>{r(null,Buffer.from(n.sign.detached(t,e)))})},t.hashAndVerify=function(e,t,r,s){i(()=>{let i;try{i=n.sign.detached.verify(r,t,e)}catch(e){return s(e)}s(null,i)})}},function(e,t,r){\"use strict\";const n=r(31),i=r(40),s=r(56),o=r(716),a=i(r(184));class u{constructor(e){this._key=l(e,o.publicKeyLength)}verify(e,t,r){f(r),o.hashAndVerify(this._key,t,e,r)}marshal(){return Buffer.from(this._key)}get bytes(){return a.PublicKey.encode({Type:a.KeyType.Ed25519,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){f(e),n(this.bytes,\"sha2-256\",e)}}class c{constructor(e,t){this._key=l(e,o.privateKeyLength),this._publicKey=l(t,o.publicKeyLength)}sign(e,t){f(t),o.hashAndSign(this._key,e,t)}get public(){if(!this._publicKey)throw new Error(\"public key not provided\");return new u(this._publicKey)}marshal(){return Buffer.concat([Buffer.from(this._key),Buffer.from(this._publicKey)])}get bytes(){return a.PrivateKey.encode({Type:a.KeyType.Ed25519,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){f(e),n(this.bytes,\"sha2-256\",e)}id(e){this.public.hash((t,r)=>{if(t)return e(t);e(null,s.encode(r))})}}function f(e){if(\"function\"!=typeof e)throw new Error(\"callback is required\")}function l(e,t){if(Buffer.isBuffer(e)&&(e=new Uint8Array(e)),!(e instanceof Uint8Array)||e.length!==t)throw new Error(\"Key must be a Uint8Array or Buffer of length \"+t);return e}e.exports={Ed25519PublicKey:u,Ed25519PrivateKey:c,unmarshalEd25519PrivateKey:function(e,t){try{e=l(e,o.privateKeyLength+o.publicKeyLength)}catch(e){return t(e)}const r=e.slice(0,o.privateKeyLength),n=e.slice(o.privateKeyLength,e.length);t(null,new c(r,n))},unmarshalEd25519PublicKey:function(e){return e=l(e,o.publicKeyLength),new u(e)},generateKeyPair:function(e,t){void 0===t&&\"function\"==typeof e&&(t=e),o.generateKey((e,r)=>{if(e)return t(e);let n;try{n=new c(r.secretKey,r.publicKey)}catch(e){return void t(e)}t(null,n)})},generateKeyPairFromSeed:function(e,t,r){void 0===r&&\"function\"==typeof t&&(r=t),o.generateKeyFromSeed(e,(e,t)=>{if(e)return r(e);let n;try{n=new c(t.secretKey,t.publicKey)}catch(e){return void r(e)}r(null,n)})}}},function(e,t,r){\"use strict\";const n=r(126).bignum;t.toBase64=function(e,t){return e.toArrayLike(Buffer,\"be\",t).toString(\"base64\").replace(/(=*)$/,\"\").replace(/\\+/g,\"-\").replace(/\\//g,\"_\")},t.toBn=function(e){return new n(Buffer.from(e,\"base64\"))}},function(e,t,r){\"use strict\";const n=r(126),i=r(718),s=i.toBase64,o=i.toBn,a=n.define(\"RSAPrivateKey\",function(){this.seq().obj(this.key(\"version\").int(),this.key(\"modulus\").int(),this.key(\"publicExponent\").int(),this.key(\"privateExponent\").int(),this.key(\"prime1\").int(),this.key(\"prime2\").int(),this.key(\"exponent1\").int(),this.key(\"exponent2\").int(),this.key(\"coefficient\").int())}),u=n.define(\"AlgorithmIdentifier\",function(){this.seq().obj(this.key(\"algorithm\").objid({\"1.2.840.113549.1.1.1\":\"rsa\"}),this.key(\"none\").optional().null_(),this.key(\"curve\").optional().objid(),this.key(\"params\").optional().seq().obj(this.key(\"p\").int(),this.key(\"q\").int(),this.key(\"g\").int()))}),c=n.define(\"RSAPublicKey\",function(){this.seq().obj(this.key(\"algorithm\").use(u),this.key(\"subjectPublicKey\").bitstr())}),f=n.define(\"RSAPublicKey\",function(){this.seq().obj(this.key(\"modulus\").int(),this.key(\"publicExponent\").int())});t.pkcs1ToJwk=function(e){const t=a.decode(e,\"der\");return{kty:\"RSA\",n:s(t.modulus),e:s(t.publicExponent),d:s(t.privateExponent),p:s(t.prime1),q:s(t.prime2),dp:s(t.exponent1),dq:s(t.exponent2),qi:s(t.coefficient),alg:\"RS256\",kid:\"2011-04-29\"}},t.jwkToPkcs1=function(e){return a.encode({version:0,modulus:o(e.n),publicExponent:o(e.e),privateExponent:o(e.d),prime1:o(e.p),prime2:o(e.q),exponent1:o(e.dp),exponent2:o(e.dq),coefficient:o(e.qi)},\"der\")},t.pkixToJwk=function(e){const t=c.decode(e,\"der\"),r=f.decode(t.subjectPublicKey.data,\"der\");return{kty:\"RSA\",n:s(r.modulus),e:s(r.publicExponent),alg:\"RS256\",kid:\"2011-04-29\"}},t.jwkToPkix=function(e){return c.encode({algorithm:{algorithm:\"rsa\",none:null},subjectPublicKey:{data:f.encode({modulus:o(e.n),publicExponent:o(e.e)},\"der\")}},\"der\")}},function(e,t,r){var n=r(126),i=r(24),s=n.bignum,o=new s(0),a=new s(1),u=new s(2);function c(e,t){do{var r=new s(i.randomBytes(t.byteLength()))}while(r.cmp(e)<=0||r.cmp(t)>=0);return r}function f(e,t,r){for(var n=e.toRed(s.red(r)).redPow(t).fromRed(),i=o;0!==n.cmp(a);)i=n,n=n.mul(n).mod(r);return 0===i.cmp(r.sub(a))?o:i}e.exports=function(e,t,r){var n=function(e){if(0===e.cmp(o))return o;for(var t=e;t.isEven();)t=t.div(u);return t}(e.mul(t).sub(a));do{var i=f(c(u,r),n,r)}while(0===i.cmp(o));var s=i.sub(a).gcd(r);return{p:s,q:r.div(s)}}},function(e,t){var r={},n=(r.aes={},r.md={},r.pki={}),i=(r.pki.rsa=r.rsa={},r.util={});function s(e){return e.replace(/\\r/g,\"\")+\"\\n\"}e.exports=function(e){e||(e={}),void 0===e.bits&&(e.bits=2048);var t=r.rsa.generateKeyPair(e);return t={public:s(r.pki.publicKeyToRSAPublicKeyPem(t.publicKey,72)),private:s(r.pki.privateKeyToPem(t.privateKey,72))}},i.fillString=function(e,t){for(var r=\"\";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r};var o=null,a=!1,u=function(e,t,r){for(var n,i,s,o,a,u,c,f=r.length();f>=64;){for(i=e.h0,s=e.h1,o=e.h2,a=e.h3,u=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,n=(i<<5|i>>>27)+(a^s&(o^a))+u+1518500249+n,u=a,a=o,o=s<<30|s>>>2,s=i,i=n;for(;c<20;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(i<<5|i>>>27)+(a^s&(o^a))+u+1518500249+n,u=a,a=o,o=s<<30|s>>>2,s=i,i=n;for(;c<32;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(i<<5|i>>>27)+(s^o^a)+u+1859775393+n,u=a,a=o,o=s<<30|s>>>2,s=i,i=n;for(;c<40;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(s^o^a)+u+1859775393+n,u=a,a=o,o=s<<30|s>>>2,s=i,i=n;for(;c<60;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(s&o|a&(s^o))+u+2400959708+n,u=a,a=o,o=s<<30|s>>>2,s=i,i=n;for(;c<80;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(s^o^a)+u+3395469782+n,u=a,a=o,o=s<<30|s>>>2,s=i,i=n;e.h0+=i,e.h1+=s,e.h2+=o,e.h3+=a,e.h4+=u,f-=64}};(r.sha1=r.md.sha1={}).create=function(){a||(o=String.fromCharCode(128),o+=r.util.fillString(String.fromCharCode(0),64),a=!0);var e=null,t=r.util.createBuffer(),n=new Array(80),i={algorithm:\"sha1\",blockLength:64,digestLength:20,messageLength:0,start:function(){i.messageLength=0,t=r.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520}}};return i.start(),i.update=function(s,o){\"utf8\"===o&&(s=r.util.encodeUtf8(s)),i.messageLength+=s.length,t.putBytes(s),u(e,n,t),(t.read>2048||0===t.length())&&t.compact()},i.digest=function(){var s=i.messageLength,a=r.util.createBuffer();a.putBytes(t.bytes()),a.putBytes(o.substr(0,64-(s+8)%64)),a.putInt32(s>>>29&255),a.putInt32(s<<3&4294967295);var c={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};u(c,n,a);var f=r.util.createBuffer();return f.putInt32(c.h0),f.putInt32(c.h1),f.putInt32(c.h2),f.putInt32(c.h3),f.putInt32(c.h4),f},i},i.ByteBuffer=function(e){this.data=e||\"\",this.read=0},i.ByteBuffer.prototype.length=function(){return this.data.length-this.read},i.ByteBuffer.prototype.isEmpty=function(){return this.data.length-this.read==0},i.ByteBuffer.prototype.putByte=function(e){this.data+=String.fromCharCode(e)},i.ByteBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);this.data=r},i.ByteBuffer.prototype.putBytes=function(e){this.data+=e},i.ByteBuffer.prototype.putString=function(e){this.data+=i.encodeUtf8(e)},i.ByteBuffer.prototype.putInt16=function(e){this.data+=String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},i.ByteBuffer.prototype.putInt24=function(e){this.data+=String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},i.ByteBuffer.prototype.putInt32=function(e){this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},i.ByteBuffer.prototype.putInt16Le=function(e){this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)},i.ByteBuffer.prototype.putInt24Le=function(e){this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)},i.ByteBuffer.prototype.putInt32Le=function(e){this.data+=String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255)},i.ByteBuffer.prototype.putInt=function(e,t){do{t-=8,this.data+=String.fromCharCode(e>>t&255)}while(t>0)},i.ByteBuffer.prototype.putBuffer=function(e){this.data+=e.getBytes()},i.ByteBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},i.ByteBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},i.ByteBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},i.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},i.ByteBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},i.ByteBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},i.ByteBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},i.ByteBuffer.prototype.getInt=function(e){var t=0;do{t=(t<<e)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},i.ByteBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t=\"\":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},i.ByteBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},i.ByteBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},i.ByteBuffer.prototype.setAt=function(e,t){this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1)},i.ByteBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},i.ByteBuffer.prototype.copy=function(){var e=i.createBuffer(this.data);return e.read=this.read,e},i.ByteBuffer.prototype.compact=function(){this.read>0&&(this.data=this.data.slice(this.read),this.read=0)},i.ByteBuffer.prototype.clear=function(){this.data=\"\",this.read=0},i.ByteBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);this.data=this.data.substr(this.read,t),this.read=0},i.ByteBuffer.prototype.toHex=function(){for(var e=\"\",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+=\"0\"),e+=r.toString(16)}return e},i.ByteBuffer.prototype.toString=function(){return i.decodeUtf8(this.bytes())},i.createBuffer=function(e,t){return t=t||\"raw\",void 0!==e&&\"utf8\"===t&&(e=i.encodeUtf8(e)),new i.ByteBuffer(e)};(r.prng={}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0},n=e.md,i=new Array(32),s=0;s<32;++s)i[s]=n.create();function o(){if(t.pools[0].messageLength>=32)return a();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),a()}function a(){var e=r.md.sha1.create();e.update(t.pools[0].digest().getBytes()),t.pools[0].start();for(var n=1,i=1;i<32;++i)(n=31===n?2147483648:n<<2)%t.reseeds==0&&(e.update(t.pools[i].digest().getBytes()),t.pools[i].start());var s=e.digest().getBytes();e.start(),e.update(s);var o=e.digest().getBytes();t.key=t.plugin.formatKey(s),t.seed=t.plugin.formatSeed(o),++t.reseeds,t.generated=0,t.time=+new Date}function u(e){var t=r.util.createBuffer();if(\"undefined\"!=typeof window&&window.crypto&&window.crypto.getRandomValues){var n=new Uint32Array(e/4);try{window.crypto.getRandomValues(n);for(var i=0;i<n.length;++i)t.putInt32(n[i])}catch(e){}}if(t.length()<e)for(var s,o,a,u=Math.floor(65535*Math.random());t.length()<e;){o=16807*(65535&u),o+=(32767&(s=16807*(u>>16)))<<16,u=4294967295&(o=(2147483647&(o+=s>>15))+(o>>31));for(i=0;i<3;++i)a=u>>>(i<<3),a^=Math.floor(255*Math.random()),t.putByte(String.fromCharCode(255&a))}return t.getBytes()}return t.pools=i,t.pool=0,t.generate=function(e,n){if(!n)return t.generateSync(e);var i=t.plugin.cipher,s=t.plugin.increment,o=t.plugin.formatKey,u=t.plugin.formatSeed,c=r.util.createBuffer();!function f(l){if(l)return n(l);if(c.length()>=e)return n(null,c.getBytes(e));if(t.generated>=1048576){var h=+new Date;(null===t.time||h-t.time>100)&&(t.key=null)}if(null===t.key)return function(e){if(t.pools[0].messageLength>=32)return a(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,function(r,n){if(r)return e(r);t.collect(n),a(),e()})}(f);var p=i(t.key,t.seed);t.generated+=p.length;c.putBytes(p);t.key=o(i(t.key,s(t.seed)));t.seed=u(i(t.key,t.seed));r.util.setImmediate(f)}()},t.generateSync=function(e){for(var n=t.plugin.cipher,i=t.plugin.increment,s=t.plugin.formatKey,a=t.plugin.formatSeed,u=r.util.createBuffer();u.length()<e;){if(t.generated>=1048576){var c=+new Date;(null===t.time||c-t.time>100)&&(t.key=null)}null===t.key&&o();var f=n(t.key,t.seed);t.generated+=f.length,u.putBytes(f),t.key=s(n(t.key,i(t.seed))),t.seed=a(n(t.key,t.seed))}return u.getBytes(e)},t.seedFile=function(e,t){try{t(null,u(e))}catch(e){t(e)}},t.seedFileSync=u,t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n=\"\",i=0;i<r;i+=8)n+=String.fromCharCode(e>>i&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener(\"message\",function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener(\"message\",e),t(n.forge.prng.err,n.forge.prng.bytes))}),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener(\"message\",function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})})})}},t};var c,f,l,h,p,d=!1;r.aes._expandKey=function(e,t){return d||function(){d=!0,l=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;c=new Array(256),f=new Array(256),h=new Array(4),p=new Array(4);for(t=0;t<4;++t)h[t]=new Array(256),p[t]=new Array(256);var r,n,i,s,o,a,u,y=0,m=0;for(t=0;t<256;++t){s=(s=m^m<<1^m<<2^m<<3^m<<4)>>8^255&s^99,c[y]=s,f[s]=y,a=(o=e[s])<<24^s<<16^s<<8^s^o,u=((r=e[y])^(n=e[r])^(i=e[n]))<<24^(y^i)<<16^(y^n^i)<<8^y^r^i;for(var g=0;g<4;++g)h[g][y]=a,p[g][s]=u,a=a<<24|a>>>8,u=u<<24|u>>>8;0===y?y=m=1:(y=r^e[e[e[r^i]]],m^=e[e[m]])}}(),function(e,t){for(var r,n=e.slice(0),i=1,s=n.length,o=4*(s+6+1),a=s;a<o;++a)r=n[a-1],a%s==0?(r=c[r>>>16&255]<<24^c[r>>>8&255]<<16^c[255&r]<<8^c[r>>>24]^l[i]<<24,i++):s>6&&a%s==4&&(r=c[r>>>24]<<24^c[r>>>16&255]<<16^c[r>>>8&255]<<8^c[255&r]),n[a]=n[a-s]^r;if(t){for(var u,f=p[0],h=p[1],d=p[2],y=p[3],m=n.slice(0),g=(a=0,(o=n.length)-4);a<o;a+=4,g-=4)if(0===a||a===o-4)m[a]=n[g],m[a+1]=n[g+3],m[a+2]=n[g+2],m[a+3]=n[g+1];else for(var v=0;v<4;++v)u=n[g+v],m[a+(3&-v)]=f[c[u>>>24]]^h[c[u>>>16&255]]^d[c[u>>>8&255]]^y[c[255&u]];n=m}return n}(e,t)};r.aes._updateBlock=function(e,t,r,n){var i,s,o,a,u,l,d,y,m,g,v,b,w=e.length/4-1;n?(i=p[0],s=p[1],o=p[2],a=p[3],u=f):(i=h[0],s=h[1],o=h[2],a=h[3],u=c),l=t[0]^e[0],d=t[n?3:1]^e[1],y=t[2]^e[2],m=t[n?1:3]^e[3];for(var _=3,k=1;k<w;++k)g=i[l>>>24]^s[d>>>16&255]^o[y>>>8&255]^a[255&m]^e[++_],v=i[d>>>24]^s[y>>>16&255]^o[m>>>8&255]^a[255&l]^e[++_],b=i[y>>>24]^s[m>>>16&255]^o[l>>>8&255]^a[255&d]^e[++_],m=i[m>>>24]^s[l>>>16&255]^o[d>>>8&255]^a[255&y]^e[++_],l=g,d=v,y=b;r[0]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[y>>>8&255]<<8^u[255&m]^e[++_],r[n?3:1]=u[d>>>24]<<24^u[y>>>16&255]<<16^u[m>>>8&255]<<8^u[255&l]^e[++_],r[2]=u[y>>>24]<<24^u[m>>>16&255]<<16^u[l>>>8&255]<<8^u[255&d]^e[++_],r[n?1:3]=u[m>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[255&y]^e[++_]};var y={},m=new Array(4),g=r.util.createBuffer();y.formatKey=function(e){var t=r.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),r.aes._expandKey(e,!1)},y.formatSeed=function(e){var t=r.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},y.cipher=function(e,t){return r.aes._updateBlock(e,t,m,!1),g.putInt32(m[0]),g.putInt32(m[1]),g.putInt32(m[2]),g.putInt32(m[3]),g.getBytes()},y.increment=function(e){return++e[3],e},y.md=r.md.sha1;var v,b=r.prng.create(y);if(!(\"undefined\"!=typeof window&&window.crypto&&window.crypto.getRandomValues||(\"undefined\"==typeof window||window.document,b.collectInt(+new Date,32),\"undefined\"==typeof navigator))){var w=\"\";for(var _ in navigator)try{\"string\"==typeof navigator[_]&&(w+=navigator[_])}catch(e){}b.collect(w),w=null}r.random=b,r.random.getBytes=function(e,t){return r.random.generate(e,t)},r.pki.rsa.createKeyPairGenerationState=function(e,t){\"string\"==typeof e&&(e=parseInt(e,10));var n={state:0,bits:e=e||1024,rng:{nextBytes:function(e){for(var t=r.random.getBytes(e.length),n=0;n<e.length;++n)e[n]=t.charCodeAt(n)}},eInt:t||65537,e:new k(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null};return n.e.fromInt(n.eInt),n};function k(e,t,r){this.data=[],null!=e&&(\"number\"==typeof e?this.fromNumber(e,t,r):null==t&&\"string\"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function S(){return new k(null)}function E(e,t,r,n,i,s){for(var o=16383&t,a=t>>14;--s>=0;){var u=16383&this.data[e],c=this.data[e++]>>14,f=a*u+c*o;i=((u=o*u+((16383&f)<<14)+r.data[n]+i)>>28)+(f>>14)+a*c,r.data[n++]=268435455&u}return i}\"undefined\"==typeof navigator?(k.prototype.am=E,v=28):\"Microsoft Internet Explorer\"==navigator.appName?(k.prototype.am=function(e,t,r,n,i,s){for(var o=32767&t,a=t>>15;--s>=0;){var u=32767&this.data[e],c=this.data[e++]>>15,f=a*u+c*o;i=((u=o*u+((32767&f)<<15)+r.data[n]+(1073741823&i))>>>30)+(f>>>15)+a*c+(i>>>30),r.data[n++]=1073741823&u}return i},v=30):\"Netscape\"!=navigator.appName?(k.prototype.am=function(e,t,r,n,i,s){for(;--s>=0;){var o=t*this.data[e++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=67108863&o}return i},v=26):(k.prototype.am=E,v=28),k.prototype.DB=v,k.prototype.DM=(1<<v)-1,k.prototype.DV=1<<v;k.prototype.FV=Math.pow(2,52),k.prototype.F1=52-v,k.prototype.F2=2*v-52;var x,A,B=\"0123456789abcdefghijklmnopqrstuvwxyz\",C=new Array;for(x=\"0\".charCodeAt(0),A=0;A<=9;++A)C[x++]=A;for(x=\"a\".charCodeAt(0),A=10;A<36;++A)C[x++]=A;for(x=\"A\".charCodeAt(0),A=10;A<36;++A)C[x++]=A;function I(e){return B.charAt(e)}function T(e,t){var r=C[e.charCodeAt(t)];return null==r?-1:r}function D(e){var t=S();return t.fromInt(e),t}function P(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function O(e){this.m=e}function N(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function U(e,t){return e&t}function R(e,t){return e|t}function L(e,t){return e^t}function F(e,t){return e&~t}function j(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function M(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function K(){}function H(e){return e}function z(e){this.r2=S(),this.q3=S(),k.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}O.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},O.prototype.revert=function(e){return e},O.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},O.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},O.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},N.prototype.convert=function(e){var t=S();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(k.ZERO)>0&&this.m.subTo(t,t),t},N.prototype.revert=function(e){var t=S();return e.copyTo(t),this.reduce(t),t},N.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},N.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},N.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},k.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},k.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+DV:this.t=0},k.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o=8==r?255&e[n]:T(e,n);o<0?\"-\"==e.charAt(n)&&(i=!0):(i=!1,0==s?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&k.ZERO.subTo(this,this)},k.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},k.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},k.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},k.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,s=(1<<i)-1,o=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+o+1]=this.data[r]>>i|a,a=(this.data[r]&s)<<n;for(r=o-1;r>=0;--r)t.data[r]=0;t.data[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()},k.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&s)<<i,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}},k.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},k.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&k.ZERO.subTo(t,t)},k.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},k.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=S());var s=S(),o=this.s,a=e.s,u=this.DB-P(n.data[n.t-1]);u>0?(n.lShiftTo(u,s),i.lShiftTo(u,r)):(n.copyTo(s),i.copyTo(r));var c=s.t,f=s.data[c-1];if(0!=f){var l=f*(1<<this.F1)+(c>1?s.data[c-2]>>this.F2:0),h=this.FV/l,p=(1<<this.F1)/l,d=1<<this.F2,y=r.t,m=y-c,g=null==t?S():t;for(s.dlShiftTo(m,g),r.compareTo(g)>=0&&(r.data[r.t++]=1,r.subTo(g,r)),k.ONE.dlShiftTo(c,g),g.subTo(s,s);s.t<c;)s.data[s.t++]=0;for(;--m>=0;){var v=r.data[--y]==f?this.DM:Math.floor(r.data[y]*h+(r.data[y-1]+d)*p);if((r.data[y]+=s.am(0,v,r,m,0,c))<v)for(s.dlShiftTo(m,g),r.subTo(g,r);r.data[y]<--v;)r.subTo(g,r)}null!=t&&(r.drShiftTo(c,t),o!=a&&k.ZERO.subTo(t,t)),r.t=c,r.clamp(),u>0&&r.rShiftTo(u,r),o<0&&k.ZERO.subTo(r,r)}}},k.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},k.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},k.prototype.exp=function(e,t){if(e>4294967295||e<1)return k.ONE;var r=S(),n=S(),i=t.convert(this),s=P(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var o=r;r=n,n=o}return t.revert(r)},k.prototype.toString=function(e){if(this.s<0)return\"-\"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,s=\"\",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this.data[o]>>a)>0&&(i=!0,s=I(r));o>=0;)a<t?(r=(this.data[o]&(1<<a)-1)<<t-a,r|=this.data[--o]>>(a+=this.DB-t)):(r=this.data[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(i=!0),i&&(s+=I(r));return i?s:\"0\"},k.prototype.negate=function(){var e=S();return k.ZERO.subTo(this,e),e},k.prototype.abs=function(){return this.s<0?this.negate():this},k.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},k.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+P(this.data[this.t-1]^this.s&this.DM)},k.prototype.mod=function(e){var t=S();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(k.ZERO)>0&&e.subTo(t,t),t},k.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new O(t):new N(t),this.exp(e,r)},k.ZERO=D(0),k.ONE=D(1),K.prototype.convert=H,K.prototype.revert=H,K.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},K.prototype.sqrTo=function(e,t){e.squareTo(t)},z.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=S();return e.copyTo(t),this.reduce(t),t},z.prototype.revert=function(e){return e},z.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},z.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},z.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var V=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],q=(1<<26)/V[V.length-1];k.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},k.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return\"0\";var t=this.chunkSize(e),r=Math.pow(e,t),n=D(r),i=S(),s=S(),o=\"\";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(e)+o},k.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,a=0;a<e.length;++a){var u=T(e,a);u<0?\"-\"==e.charAt(a)&&0==this.signum()&&(i=!0):(o=t*o+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&k.ZERO.subTo(this,this)},k.prototype.fromNumber=function(e,t,r){if(\"number\"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(k.ONE.shiftLeft(e-1),R,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(k.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},k.prototype.bitwiseTo=function(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},k.prototype.changeBit=function(e,t){var r=k.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},k.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},k.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},k.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},k.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()},k.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},k.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},k.prototype.millerRabin=function(e){var t=this.subtract(k.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>V.length&&(e=V.length);for(var i=S(),s=0;s<e;++s){i.fromInt(V[s]);var o=i.modPow(n,this);if(0!=o.compareTo(k.ONE)&&0!=o.compareTo(t)){for(var a=1;a++<r&&0!=o.compareTo(t);)if(0==(o=o.modPowInt(2,this)).compareTo(k.ONE))return!1;if(0!=o.compareTo(t))return!1}}return!0},k.prototype.clone=function(){var e=S();return this.copyTo(e),e},k.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},k.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},k.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},k.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},k.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},k.prototype.equals=function(e){return 0==this.compareTo(e)},k.prototype.min=function(e){return this.compareTo(e)<0?this:e},k.prototype.max=function(e){return this.compareTo(e)>0?this:e},k.prototype.and=function(e){var t=S();return this.bitwiseTo(e,U,t),t},k.prototype.or=function(e){var t=S();return this.bitwiseTo(e,R,t),t},k.prototype.xor=function(e){var t=S();return this.bitwiseTo(e,L,t),t},k.prototype.andNot=function(e){var t=S();return this.bitwiseTo(e,F,t),t},k.prototype.not=function(){for(var e=S(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},k.prototype.shiftLeft=function(e){var t=S();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},k.prototype.shiftRight=function(e){var t=S();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},k.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+j(this.data[e]);return this.s<0?this.t*this.DB:-1},k.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=M(this.data[r]^t);return e},k.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},k.prototype.setBit=function(e){return this.changeBit(e,R)},k.prototype.clearBit=function(e){return this.changeBit(e,F)},k.prototype.flipBit=function(e){return this.changeBit(e,L)},k.prototype.add=function(e){var t=S();return this.addTo(e,t),t},k.prototype.subtract=function(e){var t=S();return this.subTo(e,t),t},k.prototype.multiply=function(e){var t=S();return this.multiplyTo(e,t),t},k.prototype.divide=function(e){var t=S();return this.divRemTo(e,t,null),t},k.prototype.remainder=function(e){var t=S();return this.divRemTo(e,null,t),t},k.prototype.divideAndRemainder=function(e){var t=S(),r=S();return this.divRemTo(e,t,r),new Array(t,r)},k.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),s=D(1);if(i<=0)return s;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new O(t):t.isEven()?new z(t):new N(t);var o=new Array,a=3,u=r-1,c=(1<<r)-1;if(o[1]=n.convert(this),r>1){var f=S();for(n.sqrTo(o[1],f);a<=c;)o[a]=S(),n.mulTo(f,o[a-2],o[a]),a+=2}var l,h,p=e.t-1,d=!0,y=S();for(i=P(e.data[p])-1;p>=0;){for(i>=u?l=e.data[p]>>i-u&c:(l=(e.data[p]&(1<<i+1)-1)<<u-i,p>0&&(l|=e.data[p-1]>>this.DB+i-u)),a=r;0==(1&l);)l>>=1,--a;if((i-=a)<0&&(i+=this.DB,--p),d)o[l].copyTo(s),d=!1;else{for(;a>1;)n.sqrTo(s,y),n.sqrTo(y,s),a-=2;a>0?n.sqrTo(s,y):(h=s,s=y,y=h),n.mulTo(y,o[l],s)}for(;p>=0&&0==(e.data[p]&1<<i);)n.sqrTo(s,y),h=s,s=y,y=h,--i<0&&(i=this.DB-1,--p)}return n.revert(s)},k.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return k.ZERO;for(var r=e.clone(),n=this.clone(),i=D(1),s=D(0),o=D(0),a=D(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),t&&o.subTo(i,o),a.subTo(s,a))}return 0!=n.compareTo(k.ONE)?k.ZERO:a.compareTo(e)>=0?a.subtract(e):a.signum()<0?(a.addTo(e,a),a.signum()<0?a.add(e):a):a},k.prototype.pow=function(e){return this.exp(e,new K)},k.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r},k.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=V[V.length-1]){for(t=0;t<V.length;++t)if(r.data[0]==V[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<V.length;){for(var n=V[t],i=t+1;i<V.length&&n<q;)n*=V[i++];for(n=r.modInt(n);t<i;)if(n%V[t++]==0)return!1}return r.millerRabin(e)},r.jsbn=r.jsbn||{},r.jsbn.BigInteger=k;i=r.util=r.util||{};\"undefined\"!=typeof process&&process.nextTick?(i.nextTick=process.nextTick,\"function\"==typeof setImmediate?i.setImmediate=setImmediate:i.setImmediate=i.nextTick):\"function\"==typeof setImmediate?(i.setImmediate=setImmediate,i.nextTick=function(e){return setImmediate(e)}):(i.setImmediate=function(e){setTimeout(e,0)},i.nextTick=i.setImmediate);var G=function(e,t,r){var n;if(r)n=e.modPow(t.e,t.n);else{t.dP||(t.dP=t.d.mod(t.p.subtract(k.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(k.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);n=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s)}return n};i.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},i.decodeUtf8=function(e){return decodeURIComponent(escape(e))},i.createBuffer=function(e,t){return t=t||\"raw\",void 0!==e&&\"utf8\"===t&&(e=i.encodeUtf8(e)),new i.ByteBuffer(e)},i.hexToBytes=function(e){var t=\"\",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},n.rsa.decrypt=function(e,t,n,i){var s=Math.ceil(t.n.bitLength()/8);if(e.length!=s)throw{message:\"Encrypted message length is invalid.\",length:e.length,expected:s};for(var o=new k(r.util.createBuffer(e).toHex(),16),a=G(o,t,n).toString(16),u=r.util.createBuffer(),c=s-Math.ceil(a.length/2);c>0;)u.putByte(0),--c;if(u.putBytes(r.util.hexToBytes(a)),!1!==i){var f=u.getByte(),l=u.getByte();if(0!==f||n&&0!==l&&1!==l||!n&&2!=l||n&&0===l&&void 0===i)throw{message:\"Encryption block is invalid.\"};var h=0;if(0===l){h=s-3-i;for(var p=0;p<h;++p)if(0!==u.getByte())throw{message:\"Encryption block is invalid.\"}}else if(1===l)for(h=0;u.length()>1;){if(255!==u.getByte()){--u.read;break}++h}else if(2===l)for(h=0;u.length()>1;){if(0===u.getByte()){--u.read;break}++h}if(0!==u.getByte()||h!==s-3-u.length())throw{message:\"Encryption block is invalid.\"}}return u.getBytes()},n.rsa.encrypt=function(e,t,n){var i=n,s=r.util.createBuffer(),o=Math.ceil(t.n.bitLength()/8);if(!1!==n&&!0!==n){if(e.length>o-11)throw{message:\"Message is too long to encrypt.\",length:e.length,max:o-11};s.putByte(0),s.putByte(n);var a,u=o-3-e.length;if(0===n||1===n){i=!1,a=0===n?0:255;for(var c=0;c<u;++c)s.putByte(a)}else{i=!0;for(c=0;c<u;++c)a=Math.floor(255*Math.random())+1,s.putByte(a)}s.putByte(0)}s.putBytes(e);for(var f=new k(s.toHex(),16),l=G(f,t,i).toString(16),h=r.util.createBuffer(),p=o-Math.ceil(l.length/2);p>0;)h.putByte(0),--p;return h.putBytes(r.util.hexToBytes(l)),h.getBytes()},n.rsa.setPrivateKey=function(e,t,r,i,s,o,a,u){var c={n:e,e:t,d:r,p:i,q:s,dP:o,dQ:a,qInv:u,decrypt:function(e){return n.rsa.decrypt(e,c,!1)},sign:function(e,t){var r=!1;void 0===t&&(t={encode:emsaPkcs1v15encode},r=1);var i=t.encode(e,c.n.bitLength());return n.rsa.encrypt(i,c,r)}};return c};var W=function(e){var t=e.getByte();if(128!=t)return 128&t?e.getInt((127&t)<<3):t},$=r.asn1=r.asn1||{};$.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},$.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},$.create=function(e,t,r,n){if(n.constructor==Array){for(var i=[],s=0;s<n.length;++s)void 0!==n[s]&&i.push(n[s]);n=i}return{tagClass:e,type:t,constructed:r,composed:r||n.constructor==Array,value:n}},$.fromDer=function(e){if(e.constructor==String&&(e=r.util.createBuffer(e)),e.length()<2)throw{message:\"Too few bytes to parse DER.\",bytes:e.length()};var t,n=e.getByte(),i=192&n,s=31&n,o=W(e);if(e.length()<o)throw{message:\"Too few bytes to read ASN.1 value.\",detail:e.length()+\" < \"+o};var a=32==(32&n),u=a;if(!u&&i===$.Class.UNIVERSAL&&s===$.Type.BITSTRING&&o>1){var c=e.read;if(0===e.getByte()){var f=192&(n=e.getByte());if(f===$.Class.UNIVERSAL||f===$.Class.CONTEXT_SPECIFIC)try{(u=W(e)===o-(e.read-c))&&(++c,--o)}catch(e){}}e.read=c}if(u)if(t=[],void 0===o)for(;;){if(e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2);break}t.push($.fromDer(e))}else for(var l=e.length();o>0;)t.push($.fromDer(e)),o-=l-e.length(),l=e.length();else{if(void 0===o)throw{message:\"Non-constructed ASN.1 object of indefinite length.\"};if(s===$.Type.BMPSTRING){t=\"\";for(var h=0;h<o;h+=2)t+=String.fromCharCode(e.getInt16())}else t=e.getBytes(o)}return $.create(i,s,a,t)},$.toDer=function(e){var t=r.util.createBuffer(),n=e.tagClass|e.type,i=r.util.createBuffer();if(e.composed){e.constructed?n|=32:i.putByte(0);for(var s=0;s<e.value.length;++s)void 0!==e.value[s]&&i.putBuffer($.toDer(e.value[s]))}else if(e.type===$.Type.BMPSTRING)for(s=0;s<e.value.length;++s)i.putInt16(e.value.charCodeAt(s));else i.putBytes(e.value);if(t.putByte(n),i.length()<=127)t.putByte(127&i.length());else{var o=i.length(),a=\"\";do{a+=String.fromCharCode(255&o),o>>>=8}while(o>0);t.putByte(128|a.length);for(s=a.length-1;s>=0;--s)t.putByte(a.charCodeAt(s))}return t.putBuffer(i),t},n.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e){return n.rsa.encrypt(e,r,2)},verify:function(e,t,i){var s=void 0===i&&void 0,o=n.rsa.decrypt(t,r,!0,s);return void 0===i?e===$.fromDer(o).value[1].value:i.verify(e,o,r.n.bitLength())}};return r};var X=[6,4,2,4,2,4,6,2];n.rsa.stepKeyPairGenerationState=function(e,t){var n=new k(null);n.fromInt(30);for(var i,s=0,o=function(e,t){return e|t},a=+new Date,u=0;null===e.keys&&(t<=0||u<t);){if(0===e.state){var c=null===e.p?e.pBits:e.qBits,f=c-1;0===e.pqState?(e.num=new k(c,e.rng),e.num.testBit(f)||e.num.bitwiseTo(k.ONE.shiftLeft(f),o,e.num),e.num.dAddOffset(31-e.num.mod(n).byteValue(),0),s=0,++e.pqState):1===e.pqState?e.num.bitLength()>c?e.pqState=0:e.num.isProbablePrime(1)?++e.pqState:e.num.dAddOffset(X[s++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(k.ONE).gcd(e.e).compareTo(k.ONE)?3:0:3===e.pqState&&(e.pqState=0,e.num.isProbablePrime(10)&&(null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state),e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(k.ONE),e.q1=e.q.subtract(k.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(k.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var l=e.e.modInverse(e.phi);e.keys={privateKey:r.pki.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:r.pki.rsa.setPublicKey(e.n,e.e)}}u+=(i=+new Date)-a,a=i}return null!==e.keys},n.rsa.generateKeyPair=function(e,t,i,s){1===arguments.length?\"object\"==typeof e?(i=e,e=void 0):\"function\"==typeof e&&(s=e,e=void 0):2===arguments.length?(\"number\"==typeof e?\"function\"==typeof t?s=t:i=t:(i=e,s=t,e=void 0),t=void 0):3===arguments.length&&(\"number\"==typeof t?\"function\"==typeof i&&(s=i,i=void 0):(s=i,i=t,t=void 0)),i=i||{},void 0===e&&(e=i.bits||1024),void 0===t&&(t=i.e||65537);var o=n.rsa.createKeyPairGenerationState(e,t);if(!s)return n.rsa.stepKeyPairGenerationState(o,0),o.keys;!function(e,t,n){if(\"function\"==typeof t&&(n=t,t={}),\"undefined\"==typeof Worker)return function t(){if(r.pki.rsa.stepKeyPairGenerationState(e,10))return n(null,e.keys);r.util.setImmediate(t)}();var i=t.workers||2,s=t.workLoad||100,o=30*s/8,a=t.workerScript||\"forge/prime.worker.js\",u=new k(null);u.fromInt(30);var c=function(e,t){return e|t};function f(){l(e.pBits,function(t,r){if(t)return n(t);e.p=r,l(e.qBits,h)})}function l(t,r){for(var n=[],f=0;f<i;++f)n[f]=new Worker(a);var l=h();for(f=0;f<i;++f)n[f].addEventListener(\"message\",d);function h(){var r=t-1,n=new k(t,e.rng);return n.testBit(r)||n.bitwiseTo(k.ONE.shiftLeft(r),c,n),n.dAddOffset(31-n.mod(u).byteValue(),0),n}var p=!1;function d(i){if(!p){var a=i.data;if(a.found){for(var u=0;u<n.length;++u)n[u].terminate();return p=!0,r(null,new k(a.prime,16))}l.bitLength()>t&&(l=h());var c=l.toString(16);i.target.postMessage({e:e.eInt,hex:c,workLoad:s}),l.dAddOffset(o,0)}}}function h(t,i){if(e.q=i,e.p.compareTo(e.q)<0){var s=e.p;e.p=e.q,e.q=s}if(e.p1=e.p.subtract(k.ONE),e.q1=e.q.subtract(k.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(k.ONE))return e.p=e.q=null,void f();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void l(e.qBits,h);var o=e.e.modInverse(e.phi);e.keys={privateKey:r.pki.rsa.setPrivateKey(e.n,e.e,o,e.p,e.q,o.mod(e.p1),o.mod(e.q1),e.q.modInverse(e.p)),publicKey:r.pki.rsa.setPublicKey(e.n,e.e)},n(null,e.keys)}f()}(o,i,s)};var J=function(e){var t=e.toString(16);return t[0]>=\"8\"&&(t=\"00\"+t),r.util.hexToBytes(t)};n.publicKeyToRSAPublicKey=function(e){return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.n)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.e))])};var Y=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";i.encode64=function(e,t){for(var r,n,i,s=\"\",o=\"\",a=0;a<e.length;)r=e.charCodeAt(a++),n=e.charCodeAt(a++),i=e.charCodeAt(a++),s+=Y.charAt(r>>2),s+=Y.charAt((3&r)<<4|n>>4),isNaN(n)?s+=\"==\":(s+=Y.charAt((15&n)<<2|i>>6),s+=isNaN(i)?\"=\":Y.charAt(63&i)),t&&s.length>t&&(o+=s.substr(0,t)+\"\\r\\n\",s=s.substr(t));return o+=s},n.publicKeyToRSAPublicKeyPem=function(e,t){var i=$.toDer(n.publicKeyToRSAPublicKey(e));return\"-----BEGIN RSA PUBLIC KEY-----\\r\\n\"+(i=r.util.encode64(i.getBytes(),t||64))+\"\\r\\n-----END RSA PUBLIC KEY-----\"},n.privateKeyToAsn1=n.privateKeyToRSAPrivateKey=function(e){return $.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,String.fromCharCode(0)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.n)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.e)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.d)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.p)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.q)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.dP)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.dQ)),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,J(e.qInv))])},n.privateKeyToPem=function(e,t){var i=$.toDer(n.privateKeyToAsn1(e));return\"-----BEGIN RSA PRIVATE KEY-----\\r\\n\"+(i=r.util.encode64(i.getBytes(),t||64))+\"\\r\\n-----END RSA PRIVATE KEY-----\"}},function(e,t,r){\"use strict\";const n=r(31),i=r(40),s=r(56),o=r(311),a=i(r(184)),u=r(97),c=r(2);class f{constructor(e){this._key=e}verify(e,t,r){h(r),o.hashAndVerify(this._key,t,e,r)}marshal(){return o.utils.jwkToPkix(this._key)}get bytes(){return a.PublicKey.encode({Type:a.KeyType.RSA,Data:this.marshal()})}encrypt(e){return this._key.encrypt(e,\"RSAES-PKCS1-V1_5\")}equals(e){return this.bytes.equals(e.bytes)}hash(e){h(e),n(this.bytes,\"sha2-256\",e)}}class l{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return o.getRandomValues(new Uint8Array(16))}sign(e,t){h(t),o.hashAndSign(this._key,e,t)}get public(){if(!this._publicKey)throw new Error(\"public key not provided\");return new f(this._publicKey)}decrypt(e,t){o.decrypt(this._key,e,t)}marshal(){return o.utils.jwkToPkcs1(this._key)}get bytes(){return a.PrivateKey.encode({Type:a.KeyType.RSA,Data:this.marshal()})}equals(e){return this.bytes.equals(e.bytes)}hash(e){h(e),n(this.bytes,\"sha2-256\",e)}id(e){this.public.hash((t,r)=>{if(t)return e(t);e(null,s.encode(r))})}export(e,t,r){\"function\"==typeof t&&(r=t,t=e,e=\"pkcs-8\"),h(r),c(()=>{let n=null,i=null;try{const r=new u.util.ByteBuffer(this.marshal()),s=u.asn1.fromDer(r),o=u.pki.privateKeyFromAsn1(s);if(\"pkcs-8\"===e){const e={algorithm:\"aes256\",count:1e4,saltSize:16,prfAlgorithm:\"sha512\"};i=u.pki.encryptRsaPrivateKey(o,t,e)}else n=new Error(`Unknown export format '${e}'`)}catch(e){n=e}r(n,i)})}}function h(e){if(\"function\"!=typeof e)throw new Error(\"callback is required\")}e.exports={RsaPublicKey:f,RsaPrivateKey:l,unmarshalRsaPublicKey:function(e){const t=o.utils.pkixToJwk(e);return new f(t)},unmarshalRsaPrivateKey:function(e,t){const r=o.utils.pkcs1ToJwk(e);o.unmarshalPrivateKey(r,(e,r)=>{if(e)return t(e);t(null,new l(r.privateKey,r.publicKey))})},generateKeyPair:function(e,t){o.generateKey(e,(e,r)=>{if(e)return t(e);t(null,new l(r.privateKey,r.publicKey))})},fromJwk:function(e,t){o.unmarshalPrivateKey(e,(e,r)=>{if(e)return t(e);t(null,new l(r.privateKey,r.publicKey))})}}},function(e,t,r){var n=r(4);r(314),r(312),r(6);var i=\"forge.task\",s={},o=0;n.debug.set(i,\"tasks\",s);var a={};n.debug.set(i,\"queues\",a);var u=\"ready\",c=\"running\",f=\"blocked\",l=\"sleeping\",h=\"done\",p=\"error\",d={ready:{}};d.ready.stop=u,d.ready.start=c,d.ready.cancel=h,d.ready.fail=p,d.running={},d.running.stop=u,d.running.start=c,d.running.block=f,d.running.unblock=c,d.running.sleep=l,d.running.wakeup=c,d.running.cancel=h,d.running.fail=p,d.blocked={},d.blocked.stop=f,d.blocked.start=f,d.blocked.block=f,d.blocked.unblock=f,d.blocked.sleep=f,d.blocked.wakeup=f,d.blocked.cancel=h,d.blocked.fail=p,d.sleeping={},d.sleeping.stop=l,d.sleeping.start=l,d.sleeping.block=l,d.sleeping.unblock=l,d.sleeping.sleep=l,d.sleeping.wakeup=l,d.sleeping.cancel=h,d.sleeping.fail=p,d.done={},d.done.stop=h,d.done.start=h,d.done.block=h,d.done.unblock=h,d.done.sleep=h,d.done.wakeup=h,d.done.cancel=h,d.done.fail=p,d.error={},d.error.stop=p,d.error.start=p,d.error.block=p,d.error.unblock=p,d.error.sleep=p,d.error.wakeup=p,d.error.cancel=p,d.error.fail=p;var y=function(e){this.id=-1,this.name=e.name||\"?\",this.parent=e.parent||null,this.run=e.run,this.subtasks=[],this.error=!1,this.state=u,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=o++,s[this.id]=this};y.prototype.debug=function(e){e=e||\"\",n.log.debug(i,e,\"[%s][%s] task:\",this.id,this.name,this,\"subtasks:\",this.subtasks.length,\"queue:\",a)},y.prototype.next=function(e,t){\"function\"==typeof e&&(t=e,e=this.name);var r=new y({run:t,name:e,parent:this});return r.state=c,r.type=this.type,r.successCallback=this.successCallback||null,r.failureCallback=this.failureCallback||null,this.subtasks.push(r),this},y.prototype.parallel=function(e,t){return n.util.isArray(e)&&(t=e,e=this.name),this.next(e,function(r){var i=r;i.block(t.length);for(var s=function(e,r){n.task.start({type:e,run:function(e){t[r](e)},success:function(e){i.unblock()},failure:function(e){i.unblock()}})},o=0;o<t.length;o++){s(e+\"__parallel-\"+r.id+\"-\"+o,o)}})},y.prototype.stop=function(){this.state=d[this.state].stop},y.prototype.start=function(){this.error=!1,this.state=d[this.state].start,this.state===c&&(this.start=new Date,this.run(this),m(this,0))},y.prototype.block=function(e){e=void 0===e?1:e,this.blocks+=e,this.blocks>0&&(this.state=d[this.state].block)},y.prototype.unblock=function(e){return e=void 0===e?1:e,this.blocks-=e,0===this.blocks&&this.state!==h&&(this.state=c,m(this,0)),this.blocks},y.prototype.sleep=function(e){e=void 0===e?0:e,this.state=d[this.state].sleep;var t=this;this.timeoutId=setTimeout(function(){t.timeoutId=null,t.state=c,m(t,0)},e)},y.prototype.wait=function(e){e.wait(this)},y.prototype.wakeup=function(){this.state===l&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=c,m(this,0))},y.prototype.cancel=function(){this.state=d[this.state].cancel,this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},y.prototype.fail=function(e){if(this.error=!0,g(this,!0),e)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,m(e,0);else{if(null!==this.parent){for(var t=this.parent;null!==t.parent;)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,t=t.parent;g(t,!0)}this.failureCallback&&this.failureCallback(this)}};var m=function(e,t){var r=t>30||+new Date-e.swapTime>20,n=function(t){if(t++,e.state===c)if(r&&(e.swapTime=+new Date),e.subtasks.length>0){var n=e.subtasks.shift();n.error=e.error,n.swapTime=e.swapTime,n.userData=e.userData,n.run(n),n.error||m(n,t)}else g(e),e.error||null!==e.parent&&(e.parent.error=e.error,e.parent.swapTime=e.swapTime,e.parent.userData=e.userData,m(e.parent,t))};r?setTimeout(n,0):n(t)},g=function(e,t){e.state=h,delete s[e.id],null===e.parent&&(e.type in a?0===a[e.type].length?n.log.error(i,\"[%s][%s] task queue empty [%s]\",e.id,e.name,e.type):a[e.type][0]!==e?n.log.error(i,\"[%s][%s] task not first in queue [%s]\",e.id,e.name,e.type):(a[e.type].shift(),0===a[e.type].length?delete a[e.type]:a[e.type][0].start()):n.log.error(i,\"[%s][%s] task queue missing [%s]\",e.id,e.name,e.type),t||(e.error&&e.failureCallback?e.failureCallback(e):!e.error&&e.successCallback&&e.successCallback(e)))};e.exports=n.task=n.task||{},n.task.start=function(e){var t=new y({run:e.run,name:e.name||\"?\"});t.type=e.type,t.successCallback=e.success||null,t.failureCallback=e.failure||null,t.type in a?a[e.type].push(t):(a[t.type]=[t],function(e){e.error=!1,e.state=d[e.state].start,setTimeout(function(){e.state===c&&(e.swapTime=+new Date,e.run(e),m(e,0))},0)}(t))},n.task.cancel=function(e){e in a&&(a[e]=[a[e][0]])},n.task.createCondition=function(){var e={tasks:{},wait:function(t){t.id in e.tasks||(t.block(),e.tasks[t.id]=t)},notify:function(){var t=e.tasks;for(var r in e.tasks={},t)t[r].unblock()}};return e}},function(e,t,r){var n=r(4);r(68),r(96),r(182),r(95),r(6);var i=e.exports=n.ssh=n.ssh||{};function s(e,t){var r=t.toString(16);r[0]>=\"8\"&&(r=\"00\"+r);var i=n.util.hexToBytes(r);e.putInt32(i.length),e.putBytes(i)}function o(e,t){e.putInt32(t.length),e.putString(t)}function a(){for(var e=n.md.sha1.create(),t=arguments.length,r=0;r<t;++r)e.update(arguments[r]);return e.digest()}i.privateKeyToPutty=function(e,t,r){r=r||\"\";var i=\"\"===(t=t||\"\")?\"none\":\"aes256-cbc\",u=\"PuTTY-User-Key-File-2: ssh-rsa\\r\\n\";u+=\"Encryption: \"+i+\"\\r\\n\",u+=\"Comment: \"+r+\"\\r\\n\";var c=n.util.createBuffer();o(c,\"ssh-rsa\"),s(c,e.e),s(c,e.n);var f=n.util.encode64(c.bytes(),64),l=Math.floor(f.length/66)+1;u+=\"Public-Lines: \"+l+\"\\r\\n\",u+=f;var h,p=n.util.createBuffer();if(s(p,e.d),s(p,e.p),s(p,e.q),s(p,e.qInv),t){var d=p.length()+16-1;d-=d%16;var y=a(p.bytes());y.truncate(y.length()-d+p.length()),p.putBuffer(y);var m=n.util.createBuffer();m.putBuffer(a(\"\\0\\0\\0\\0\",t)),m.putBuffer(a(\"\\0\\0\\0\u0001\",t));var g=n.aes.createEncryptionCipher(m.truncate(8),\"CBC\");g.start(n.util.createBuffer().fillWithByte(0,16)),g.update(p.copy()),g.finish();var v=g.output;v.truncate(16),h=n.util.encode64(v.bytes(),64)}else h=n.util.encode64(p.bytes(),64);u+=\"\\r\\nPrivate-Lines: \"+(l=Math.floor(h.length/66)+1)+\"\\r\\n\",u+=h;var b=a(\"putty-private-key-file-mac-key\",t),w=n.util.createBuffer();o(w,\"ssh-rsa\"),o(w,i),o(w,r),w.putInt32(c.length()),w.putBuffer(c),w.putInt32(p.length()),w.putBuffer(p);var _=n.hmac.create();return _.start(\"sha1\",b),_.update(w.bytes()),u+=\"\\r\\nPrivate-MAC: \"+_.digest().toHex()+\"\\r\\n\"},i.publicKeyToOpenSSH=function(e,t){t=t||\"\";var r=n.util.createBuffer();return o(r,\"ssh-rsa\"),s(r,e.e),s(r,e.n),\"ssh-rsa \"+n.util.encode64(r.bytes())+\" \"+t},i.privateKeyToOpenSSH=function(e,t){return t?n.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:\"aes128\"}):n.pki.privateKeyToPem(e)},i.getPublicKeyFingerprint=function(e,t){var r=(t=t||{}).md||n.md.md5.create(),i=n.util.createBuffer();o(i,\"ssh-rsa\"),s(i,e.e),s(i,e.n),r.start(),r.update(i.getBytes());var a=r.digest();if(\"hex\"===t.encoding){var u=a.toHex();return t.delimiter?u.match(/.{2}/g).join(t.delimiter):u}if(\"binary\"===t.encoding)return a.getBytes();if(t.encoding)throw new Error('Unknown encoding \"'+t.encoding+'\".');return a}},function(e,t,r){var n=r(4);r(68),r(58),r(129),r(67),r(83),r(316),r(42),r(6),r(180);var i=n.asn1,s=e.exports=n.pkcs7=n.pkcs7||{};function o(e){var t={},r=[];if(!i.validate(e,s.asn1.recipientInfoValidator,t,r)){var o=new Error(\"Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.\");throw o.errors=r,o}return{version:t.version.charCodeAt(0),issuer:n.pki.RDNAttributesAsArray(t.issuer),serialNumber:n.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:i.derToOid(t.encAlgorithm),parameter:t.encParameter.value,content:t.encKey}}}function a(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:e.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.digestAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,\"\")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureAlgorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,\"\")])),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[]),s=0;s<e.unauthenticatedAttributes.length;++s){var o=e.unauthenticatedAttributes[s];r.values.push(u(o))}t.value.push(r)}return t}function u(e){var t;if(e.type===n.pki.oids.contentType)t=i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.value).getBytes());else if(e.type===n.pki.oids.messageDigest)t=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===n.pki.oids.signingTime){var r=new Date(\"1950-01-01T00:00:00Z\"),s=new Date(\"2050-01-01T00:00:00Z\"),o=e.value;if(\"string\"==typeof o){var a=Date.parse(o);o=isNaN(a)?13===o.length?i.utcTimeToDate(o):i.generalizedTimeToDate(o):new Date(a)}t=o>=r&&o<s?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(o)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(o))}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[t])])}function c(e,t,r){var s={};if(!i.validate(t,r,s,[])){var o=new Error(\"Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.\");throw o.errors=o,o}if(i.derToOid(s.contentType)!==n.pki.oids.data)throw new Error(\"Unsupported PKCS#7 message. Only wrapped ContentType Data supported.\");if(s.encryptedContent){var a=\"\";if(n.util.isArray(s.encryptedContent))for(var u=0;u<s.encryptedContent.length;++u){if(s.encryptedContent[u].type!==i.Type.OCTETSTRING)throw new Error(\"Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.\");a+=s.encryptedContent[u].value}else a=s.encryptedContent;e.encryptedContent={algorithm:i.derToOid(s.encAlgorithm),parameter:n.util.createBuffer(s.encParameter.value),content:n.util.createBuffer(a)}}if(s.content){a=\"\";if(n.util.isArray(s.content))for(u=0;u<s.content.length;++u){if(s.content[u].type!==i.Type.OCTETSTRING)throw new Error(\"Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.\");a+=s.content[u].value}else a=s.content;e.content=n.util.createBuffer(a)}return e.version=s.version.charCodeAt(0),e.rawCapture=s,s}function f(e){if(void 0===e.encryptedContent.key)throw new Error(\"Symmetric key not available.\");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case n.pki.oids[\"aes128-CBC\"]:case n.pki.oids[\"aes192-CBC\"]:case n.pki.oids[\"aes256-CBC\"]:t=n.aes.createDecryptionCipher(e.encryptedContent.key);break;case n.pki.oids.desCBC:case n.pki.oids[\"des-EDE3-CBC\"]:t=n.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error(\"Unsupported symmetric cipher, OID \"+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error(\"Symmetric decryption failed.\");e.content=t.output}}s.messageFromPem=function(e){var t=n.pem.decode(e)[0];if(\"PKCS7\"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not \"PKCS#7\".');throw r.headerType=t.type,r}if(t.procType&&\"ENCRYPTED\"===t.procType.type)throw new Error(\"Could not convert PKCS#7 message from PEM; PEM is encrypted.\");var o=i.fromDer(t.body);return s.messageFromAsn1(o)},s.messageToPem=function(e,t){var r={type:\"PKCS7\",body:i.toDer(e.toAsn1()).getBytes()};return n.pem.encode(r,{maxline:t})},s.messageFromAsn1=function(e){var t={},r=[];if(!i.validate(e,s.asn1.contentInfoValidator,t,r)){var o=new Error(\"Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.\");throw o.errors=r,o}var a,u=i.derToOid(t.contentType);switch(u){case n.pki.oids.envelopedData:a=s.createEnvelopedData();break;case n.pki.oids.encryptedData:a=s.createEncryptedData();break;case n.pki.oids.signedData:a=s.createSignedData();break;default:throw new Error(\"Cannot read PKCS#7 message. ContentType with OID \"+u+\" is not (yet) supported.\")}return a.fromAsn1(t.content.value[0]),a},s.createSignedData=function(){var e=null;return e={type:n.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(c(e,t,s.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,i=0;i<r.length;++i)e.certificates.push(n.pki.certificateFromAsn1(r[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(n.pki.certificateToAsn1(e.certificates[r]));var s=[],o=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&o.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,t)),s.length>0&&o.value[0].value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(i.create(i.Class.UNIVERSAL,i.Type.SET,!0,e.signerInfos)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var r=t.issuer,i=t.serialNumber;if(t.certificate){var s=t.certificate;\"string\"==typeof s&&(s=n.pki.certificateFromPem(s)),r=s.issuer.attributes,i=s.serialNumber}var o=t.key;if(!o)throw new Error(\"Could not add PKCS#7 signer; no private key specified.\");\"string\"==typeof o&&(o=n.pki.privateKeyFromPem(o));var a=t.digestAlgorithm||n.pki.oids.sha1;switch(a){case n.pki.oids.sha1:case n.pki.oids.sha256:case n.pki.oids.sha384:case n.pki.oids.sha512:case n.pki.oids.md5:break;default:throw new Error(\"Could not add PKCS#7 signer; unknown message digest algorithm: \"+a)}var u=t.authenticatedAttributes||[];if(u.length>0){for(var c=!1,f=!1,l=0;l<u.length;++l){var h=u[l];if(c||h.type!==n.pki.oids.contentType){if(f||h.type!==n.pki.oids.messageDigest);else if(f=!0,c)break}else if(c=!0,f)break}if(!c||!f)throw new Error(\"Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.\")}e.signers.push({key:o,version:1,issuer:r,serialNumber:i,digestAlgorithm:a,signatureAlgorithm:n.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(){var t;\"object\"==typeof e.content&&null!==e.contentInfo||(e.contentInfo=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes())]),\"content\"in e&&(e.content instanceof n.util.ByteBuffer?t=e.content.bytes():\"string\"==typeof e.content&&(t=n.util.encodeUtf8(e.content)),e.contentInfo.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t)]))));0!==e.signers.length&&function(t){if(e.contentInfo.value.length<2)throw new Error(\"Could not sign PKCS#7 message; there is no content to sign.\");var r=i.derToOid(e.contentInfo.value[0].value),s=e.contentInfo.value[1];s=s.value[0];var o=i.toDer(s);for(var c in o.getByte(),i.getBerValueLength(o),o=o.getBytes(),t)t[c].start().update(o);for(var f=new Date,l=0;l<e.signers.length;++l){var h=e.signers[l];if(0===h.authenticatedAttributes.length){if(r!==n.pki.oids.data)throw new Error(\"Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.\")}else{h.authenticatedAttributesAsn1=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var p=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[]),d=0;d<h.authenticatedAttributes.length;++d){var y=h.authenticatedAttributes[d];y.type===n.pki.oids.messageDigest?y.value=t[h.digestAlgorithm].digest():y.type===n.pki.oids.signingTime&&(y.value||(y.value=f)),p.value.push(u(y)),h.authenticatedAttributesAsn1.value.push(u(y))}o=i.toDer(p).getBytes(),h.md.start().update(o)}h.signature=h.key.sign(h.md,\"RSASSA-PKCS1-V1_5\")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(a(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var s=e.signers[r],o=s.digestAlgorithm;o in t||(t[o]=n.md[n.pki.oids[o]].create()),0===s.authenticatedAttributes.length?s.md=t[o]:s.md=n.md[n.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,\"\")]));return t}())},verify:function(){throw new Error(\"PKCS#7 signature verification not yet implemented.\")},addCertificate:function(t){\"string\"==typeof t&&(t=n.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error(\"PKCS#7 CRL support not yet implemented.\")}}},s.createEncryptedData=function(){var e=null;return e={type:n.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:n.pki.oids[\"aes256-CBC\"]},fromAsn1:function(t){c(e,t,s.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),f(e)}}},s.createEnvelopedData=function(){var e=null;return e={type:n.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:n.pki.oids[\"aes256-CBC\"]},fromAsn1:function(t){var r=c(e,t,s.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.type).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,function(e){for(var t=[],r=0;r<e.length;++r)t.push((s=e[r],i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(s.version).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[n.pki.distinguishedNameToAsn1({attributes:s.issuer}),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(s.serialNumber))]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(s.encryptedContent.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,\"\")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,s.encryptedContent.content)])));var s;return t}(e.recipients)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,(t=e.encryptedContent,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(n.pki.oids.data).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.algorithm).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.parameter.getBytes())]),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],s=i.issuer;if(i.serialNumber===t.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:case n.pki.oids.desCBC:var i=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=n.util.createBuffer(i);break;default:throw new Error(\"Unsupported asymmetric cipher, OID \"+t.encryptedContent.algorithm)}f(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:n.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var i,s,o;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case n.pki.oids[\"aes128-CBC\"]:i=16,s=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids[\"aes192-CBC\"]:i=24,s=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids[\"aes256-CBC\"]:i=32,s=16,o=n.aes.createEncryptionCipher;break;case n.pki.oids[\"des-EDE3-CBC\"]:i=24,s=8,o=n.des.createEncryptionCipher;break;default:throw new Error(\"Unsupported symmetric cipher, OID \"+r)}if(void 0===t)t=n.util.createBuffer(n.random.getBytes(i));else if(t.length()!=i)throw new Error(\"Symmetric key has wrong length; got \"+t.length()+\" bytes, expected \"+i+\".\");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=n.util.createBuffer(n.random.getBytes(s));var a=o(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error(\"Symmetric encryption failed.\");e.encryptedContent.content=a.output}for(var u=0;u<e.recipients.length;++u){var c=e.recipients[u];if(void 0===c.encryptedContent.content)switch(c.encryptedContent.algorithm){case n.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error(\"Unsupported asymmetric cipher, OID \"+c.encryptedContent.algorithm)}}}}}},function(e,t,r){e.exports=r(57),r(182),r(95),r(322),r(313)},function(e,t,r){var n=r(4);r(6),r(42),r(127),e.exports=n.kem=n.kem||{};var i=n.jsbn.BigInteger;function s(e,t,r,i){e.generate=function(e,s){for(var o=new n.util.ByteBuffer,a=Math.ceil(s/i)+r,u=new n.util.ByteBuffer,c=r;c<a;++c){u.putInt32(c),t.start(),t.update(e+u.getBytes());var f=t.digest();o.putBytes(f.getBytes(i))}return o.truncate(o.length()-s),o.getBytes()}}n.kem.rsa={},n.kem.rsa.create=function(e,t){var r=(t=t||{}).prng||n.random,s={encrypt:function(t,s){var o,a=Math.ceil(t.n.bitLength()/8);do{o=new i(n.util.bytesToHex(r.getBytesSync(a)),16).mod(t.n)}while(o.equals(i.ZERO));var u=a-(o=n.util.hexToBytes(o.toString(16))).length;return u>0&&(o=n.util.fillString(String.fromCharCode(0),u)+o),{encapsulation:t.encrypt(o,\"NONE\"),key:e.generate(o,s)}},decrypt:function(t,r,n){var i=t.decrypt(r,\"NONE\");return e.generate(i,n)}};return s},n.kem.kdf1=function(e,t){s(this,e,0,t||e.digestLength)},n.kem.kdf2=function(e,t){s(this,e,1,t||e.digestLength)}},function(e,t,r){var n=r(4);if(r(127),r(42),r(313),r(6),void 0===i)var i=n.jsbn.BigInteger;var s=n.util.ByteBuffer,o=\"undefined\"==typeof Buffer?Uint8Array:Buffer;n.pki=n.pki||{},e.exports=n.pki.ed25519=n.ed25519=n.ed25519||{};var a=n.ed25519;function u(e){var t=e.message;if(t instanceof Uint8Array)return t;var r=e.encoding;if(void 0===t){if(!e.md)throw new TypeError('\"options.message\" or \"options.md\" not specified.');t=e.md.digest().getBytes(),r=\"binary\"}if(\"string\"==typeof t&&!r)throw new TypeError('\"options.encoding\" must be \"binary\" or \"utf8\".');if(\"string\"==typeof t){if(\"undefined\"!=typeof Buffer)return new Buffer(t,r);t=new s(t,r)}else if(!(t instanceof s))throw new TypeError('\"options.message\" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with \"options.encoding\" specifying its encoding.');for(var n=new o(t.length()),i=0;i<n.length;++i)n[i]=t.at(i);return n}a.constants={},a.constants.PUBLIC_KEY_BYTE_LENGTH=32,a.constants.PRIVATE_KEY_BYTE_LENGTH=64,a.constants.SEED_BYTE_LENGTH=32,a.constants.SIGN_BYTE_LENGTH=64,a.constants.HASH_BYTE_LENGTH=64,a.generateKeyPair=function(e){var t=(e=e||{}).seed;if(void 0===t)t=n.random.getBytesSync(a.constants.SEED_BYTE_LENGTH);else if(\"string\"==typeof t){if(t.length!==a.constants.SEED_BYTE_LENGTH)throw new TypeError('\"seed\" must be '+a.constants.SEED_BYTE_LENGTH+\" bytes in length.\")}else if(!(t instanceof Uint8Array))throw new TypeError('\"seed\" must be a node.js Buffer, Uint8Array, or a binary string.');t=u({message:t,encoding:\"binary\"});for(var r=new o(a.constants.PUBLIC_KEY_BYTE_LENGTH),i=new o(a.constants.PRIVATE_KEY_BYTE_LENGTH),s=0;s<32;++s)i[s]=t[s];return function(e,t){var r,n=[P(),P(),P(),P()],i=g(t,32);for(i[0]&=248,i[31]&=127,i[31]|=64,C(n,i),k(e,n),r=0;r<32;++r)t[r+32]=e[r]}(r,i),{publicKey:r,privateKey:i}},a.publicKeyFromPrivateKey=function(e){var t=u({message:(e=e||{}).privateKey,encoding:\"binary\"});if(t.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('\"options.privateKey\" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new o(a.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=t[32+n];return r},a.sign=function(e){var t=u(e=e||{}),r=u({message:e.privateKey,encoding:\"binary\"});if(r.length!==a.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('\"options.privateKey\" must have a byte length of '+a.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new o(a.constants.SIGN_BYTE_LENGTH+t.length);!function(e,t,r,n){var i,s,o=new Float64Array(64),a=[P(),P(),P(),P()],u=g(n,32);u[0]&=248,u[31]&=127,u[31]|=64;var c=r+64;for(i=0;i<r;++i)e[64+i]=t[i];for(i=0;i<32;++i)e[32+i]=u[32+i];var f=g(e.subarray(32),r+32);for(b(f),C(a,f),k(e,a),i=32;i<64;++i)e[i]=n[i];var l=g(e,r+64);for(b(l),i=32;i<64;++i)o[i]=0;for(i=0;i<32;++i)o[i]=f[i];for(i=0;i<32;++i)for(s=0;s<32;s++)o[i+s]+=l[i]*u[s];v(e.subarray(32),o)}(n,t,t.length,r);for(var i=new o(a.constants.SIGN_BYTE_LENGTH),s=0;s<i.length;++s)i[s]=n[s];return i},a.verify=function(e){var t=u(e=e||{});if(void 0===e.signature)throw new TypeError('\"options.signature\" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=u({message:e.signature,encoding:\"binary\"});if(r.length!==a.constants.SIGN_BYTE_LENGTH)throw new TypeError('\"options.signature\" must have a byte length of '+a.constants.SIGN_BYTE_LENGTH);var n=u({message:e.publicKey,encoding:\"binary\"});if(n.length!==a.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('\"options.publicKey\" must have a byte length of '+a.constants.PUBLIC_KEY_BYTE_LENGTH);var i,s=new o(a.constants.SIGN_BYTE_LENGTH+t.length),h=new o(a.constants.SIGN_BYTE_LENGTH+t.length);for(i=0;i<a.constants.SIGN_BYTE_LENGTH;++i)s[i]=r[i];for(i=0;i<t.length;++i)s[i+a.constants.SIGN_BYTE_LENGTH]=t[i];return function(e,t,r,n){var i,s=new o(32),a=[P(),P(),P(),P()],u=[P(),P(),P(),P()];if(-1,r<64)return-1;if(function(e,t){var r=P(),n=P(),i=P(),s=P(),o=P(),a=P(),u=P();I(e[2],f),function(e,t){var r;for(r=0;r<16;++r)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(e[1],t),U(i,e[1]),R(s,i,l),N(i,i,e[2]),O(s,e[2],s),U(o,s),U(a,o),R(u,a,o),R(r,u,i),R(r,r,s),function(e,t){var r,n=P();for(r=0;r<16;++r)n[r]=t[r];for(r=250;r>=0;--r)U(n,n),1!==r&&R(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}(r,r),R(r,r,i),R(r,r,s),R(r,r,s),R(e[0],r,s),U(n,e[0]),R(n,n,s),E(n,i)&&R(e[0],e[0],m);if(U(n,e[0]),R(n,n,s),E(n,i))return-1;A(e[0])===t[31]>>7&&N(e[0],c,e[0]);return R(e[3],e[0],e[1]),0}(u,n))return-1;for(i=0;i<r;++i)e[i]=t[i];for(i=0;i<32;++i)e[i+32]=n[i];var h=g(e,r);if(b(h),B(a,u,h),C(u,t.subarray(32)),w(a,u),k(s,a),r-=64,x(t,0,s,0)){for(i=0;i<r;++i)e[i]=0;return-1}for(i=0;i<r;++i)e[i]=t[i+64];return r}(h,s,s.length,n)>=0};var c=P(),f=P([1]),l=P([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=P([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),p=P([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),d=P([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),m=P([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function g(e,t){var r=n.md.sha512.create(),i=new s(e);r.update(i.getBytes(t),\"binary\");var u=r.digest().getBytes();if(\"undefined\"!=typeof Buffer)return new Buffer(u,\"binary\");for(var c=new o(a.constants.HASH_BYTE_LENGTH),f=0;f<64;++f)c[f]=u.charCodeAt(f);return c}function v(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*y[i-(n-32)],r=t[i]+128>>8,t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;++i)t[i]+=r-(t[31]>>4)*y[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;++i)t[i]-=r*y[i];for(n=0;n<32;++n)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function b(e){for(var t=new Float64Array(64),r=0;r<64;++r)t[r]=e[r],e[r]=0;v(e,t)}function w(e,t){var r=P(),n=P(),i=P(),s=P(),o=P(),a=P(),u=P(),c=P(),f=P();N(r,e[1],e[0]),N(f,t[1],t[0]),R(r,r,f),O(n,e[0],e[1]),O(f,t[0],t[1]),R(n,n,f),R(i,e[3],t[3]),R(i,i,h),R(s,e[2],t[2]),O(s,s,s),N(o,n,r),N(a,s,i),O(u,s,i),O(c,n,r),R(e[0],o,a),R(e[1],c,u),R(e[2],u,a),R(e[3],o,c)}function _(e,t,r){for(var n=0;n<4;++n)D(e[n],t[n],r)}function k(e,t){var r=P(),n=P(),i=P();!function(e,t){var r,n=P();for(r=0;r<16;++r)n[r]=t[r];for(r=253;r>=0;--r)U(n,n),2!==r&&4!==r&&R(n,n,t);for(r=0;r<16;++r)e[r]=n[r]}(i,t[2]),R(r,t[0],i),R(n,t[1],i),S(e,n),e[31]^=A(r)<<7}function S(e,t){var r,n,i,s=P(),o=P();for(r=0;r<16;++r)o[r]=t[r];for(T(o),T(o),T(o),n=0;n<2;++n){for(s[0]=o[0]-65517,r=1;r<15;++r)s[r]=o[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,D(o,s,1-i)}for(r=0;r<16;r++)e[2*r]=255&o[r],e[2*r+1]=o[r]>>8}function E(e,t){var r=new o(32),n=new o(32);return S(r,e),S(n,t),x(r,0,n,0)}function x(e,t,r,n){return function(e,t,r,n,i){var s,o=0;for(s=0;s<i;++s)o|=e[t+s]^r[n+s];return(1&o-1>>>8)-1}(e,t,r,n,32)}function A(e){var t=new o(32);return S(t,e),1&t[0]}function B(e,t,r){var n,i;for(I(e[0],c),I(e[1],f),I(e[2],f),I(e[3],c),i=255;i>=0;--i)_(e,t,n=r[i/8|0]>>(7&i)&1),w(t,e),w(e,e),_(e,t,n)}function C(e,t){var r=[P(),P(),P(),P()];I(r[0],p),I(r[1],d),I(r[2],f),R(r[3],p,d),B(e,r,t)}function I(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function T(e){var t,r,n=1;for(t=0;t<16;++t)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function D(e,t,r){for(var n,i=~(r-1),s=0;s<16;++s)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function P(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;++t)r[t]=e[t];return r}function O(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]+r[n]}function N(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]-r[n]}function U(e,t){R(e,t,t)}function R(e,t,r){var n,i,s=0,o=0,a=0,u=0,c=0,f=0,l=0,h=0,p=0,d=0,y=0,m=0,g=0,v=0,b=0,w=0,_=0,k=0,S=0,E=0,x=0,A=0,B=0,C=0,I=0,T=0,D=0,P=0,O=0,N=0,U=0,R=r[0],L=r[1],F=r[2],j=r[3],M=r[4],K=r[5],H=r[6],z=r[7],V=r[8],q=r[9],G=r[10],W=r[11],$=r[12],X=r[13],J=r[14],Y=r[15];s+=(n=t[0])*R,o+=n*L,a+=n*F,u+=n*j,c+=n*M,f+=n*K,l+=n*H,h+=n*z,p+=n*V,d+=n*q,y+=n*G,m+=n*W,g+=n*$,v+=n*X,b+=n*J,w+=n*Y,o+=(n=t[1])*R,a+=n*L,u+=n*F,c+=n*j,f+=n*M,l+=n*K,h+=n*H,p+=n*z,d+=n*V,y+=n*q,m+=n*G,g+=n*W,v+=n*$,b+=n*X,w+=n*J,_+=n*Y,a+=(n=t[2])*R,u+=n*L,c+=n*F,f+=n*j,l+=n*M,h+=n*K,p+=n*H,d+=n*z,y+=n*V,m+=n*q,g+=n*G,v+=n*W,b+=n*$,w+=n*X,_+=n*J,k+=n*Y,u+=(n=t[3])*R,c+=n*L,f+=n*F,l+=n*j,h+=n*M,p+=n*K,d+=n*H,y+=n*z,m+=n*V,g+=n*q,v+=n*G,b+=n*W,w+=n*$,_+=n*X,k+=n*J,S+=n*Y,c+=(n=t[4])*R,f+=n*L,l+=n*F,h+=n*j,p+=n*M,d+=n*K,y+=n*H,m+=n*z,g+=n*V,v+=n*q,b+=n*G,w+=n*W,_+=n*$,k+=n*X,S+=n*J,E+=n*Y,f+=(n=t[5])*R,l+=n*L,h+=n*F,p+=n*j,d+=n*M,y+=n*K,m+=n*H,g+=n*z,v+=n*V,b+=n*q,w+=n*G,_+=n*W,k+=n*$,S+=n*X,E+=n*J,x+=n*Y,l+=(n=t[6])*R,h+=n*L,p+=n*F,d+=n*j,y+=n*M,m+=n*K,g+=n*H,v+=n*z,b+=n*V,w+=n*q,_+=n*G,k+=n*W,S+=n*$,E+=n*X,x+=n*J,A+=n*Y,h+=(n=t[7])*R,p+=n*L,d+=n*F,y+=n*j,m+=n*M,g+=n*K,v+=n*H,b+=n*z,w+=n*V,_+=n*q,k+=n*G,S+=n*W,E+=n*$,x+=n*X,A+=n*J,B+=n*Y,p+=(n=t[8])*R,d+=n*L,y+=n*F,m+=n*j,g+=n*M,v+=n*K,b+=n*H,w+=n*z,_+=n*V,k+=n*q,S+=n*G,E+=n*W,x+=n*$,A+=n*X,B+=n*J,C+=n*Y,d+=(n=t[9])*R,y+=n*L,m+=n*F,g+=n*j,v+=n*M,b+=n*K,w+=n*H,_+=n*z,k+=n*V,S+=n*q,E+=n*G,x+=n*W,A+=n*$,B+=n*X,C+=n*J,I+=n*Y,y+=(n=t[10])*R,m+=n*L,g+=n*F,v+=n*j,b+=n*M,w+=n*K,_+=n*H,k+=n*z,S+=n*V,E+=n*q,x+=n*G,A+=n*W,B+=n*$,C+=n*X,I+=n*J,T+=n*Y,m+=(n=t[11])*R,g+=n*L,v+=n*F,b+=n*j,w+=n*M,_+=n*K,k+=n*H,S+=n*z,E+=n*V,x+=n*q,A+=n*G,B+=n*W,C+=n*$,I+=n*X,T+=n*J,D+=n*Y,g+=(n=t[12])*R,v+=n*L,b+=n*F,w+=n*j,_+=n*M,k+=n*K,S+=n*H,E+=n*z,x+=n*V,A+=n*q,B+=n*G,C+=n*W,I+=n*$,T+=n*X,D+=n*J,P+=n*Y,v+=(n=t[13])*R,b+=n*L,w+=n*F,_+=n*j,k+=n*M,S+=n*K,E+=n*H,x+=n*z,A+=n*V,B+=n*q,C+=n*G,I+=n*W,T+=n*$,D+=n*X,P+=n*J,O+=n*Y,b+=(n=t[14])*R,w+=n*L,_+=n*F,k+=n*j,S+=n*M,E+=n*K,x+=n*H,A+=n*z,B+=n*V,C+=n*q,I+=n*G,T+=n*W,D+=n*$,P+=n*X,O+=n*J,N+=n*Y,w+=(n=t[15])*R,o+=38*(k+=n*F),a+=38*(S+=n*j),u+=38*(E+=n*M),c+=38*(x+=n*K),f+=38*(A+=n*H),l+=38*(B+=n*z),h+=38*(C+=n*V),p+=38*(I+=n*q),d+=38*(T+=n*G),y+=38*(D+=n*W),m+=38*(P+=n*$),g+=38*(O+=n*X),v+=38*(N+=n*J),b+=38*(U+=n*Y),s=(n=(s+=38*(_+=n*L))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=u,e[4]=c,e[5]=f,e[6]=l,e[7]=h,e[8]=p,e[9]=d,e[10]=y,e[11]=m,e[12]=g,e[13]=v,e[14]=b,e[15]=w}},function(e,t,r){var n=r(4);r(315),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},function(e,t,r){var n=r(4);r(68),r(325);var i=e.exports=n.tls;function s(e,t,r){var s=t.entity===n.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:n.cipher.createDecipher(\"AES-CBC\",s?r.keys.server_write_key:r.keys.client_write_key),iv:s?r.keys.server_write_IV:r.keys.client_write_IV},e.write.cipherState={init:!1,cipher:n.cipher.createCipher(\"AES-CBC\",s?r.keys.client_write_key:r.keys.server_write_key),iv:s?r.keys.client_write_IV:r.keys.server_write_IV},e.read.cipherFunction=c,e.write.cipherFunction=o,e.read.macLength=e.write.macLength=r.mac_length,e.read.macFunction=e.write.macFunction=i.hmac_sha1}function o(e,t){var r,s=!1,o=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(o),t.updateSequenceNumber(),r=e.version.minor===i.Versions.TLS_1_0.minor?t.cipherState.init?null:t.cipherState.iv:n.random.getBytesSync(16),t.cipherState.init=!0;var u=t.cipherState.cipher;return u.start({iv:r}),e.version.minor>=i.Versions.TLS_1_1.minor&&u.output.putBytes(r),u.update(e.fragment),u.finish(a)&&(e.fragment=u.output,e.length=e.fragment.length(),s=!0),s}function a(e,t,r){if(!r){var n=e-t.length()%e;t.fillWithByte(n-1,n)}return!0}function u(e,t,r){var n=!0;if(r){for(var i=t.length(),s=t.last(),o=i-1-s;o<i-1;++o)n=n&&t.at(o)==s;n&&t.truncate(s+1)}return n}i.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:\"TLS_RSA_WITH_AES_128_CBC_SHA\",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,e.cipher_type=i.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=i.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:s},i.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:\"TLS_RSA_WITH_AES_256_CBC_SHA\",initSecurityParameters:function(e){e.bulk_cipher_algorithm=i.BulkCipherAlgorithm.aes,e.cipher_type=i.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=i.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:s};function c(e,t){var r,s=!1;0,r=e.version.minor===i.Versions.TLS_1_0.minor?t.cipherState.init?null:t.cipherState.iv:e.fragment.getBytes(16),t.cipherState.init=!0;var o=t.cipherState.cipher;o.start({iv:r}),o.update(e.fragment),s=o.finish(u);var a=t.macLength,c=n.random.getBytesSync(a),f=o.output.length();f>=a?(e.fragment=o.output.getBytes(f-a),c=o.output.getBytes(a)):e.fragment=o.output.getBytes(),e.fragment=n.util.createBuffer(e.fragment),e.length=e.fragment.length();var l=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),s=function(e,t,r){var i=n.hmac.create();return i.start(\"SHA1\",e),i.update(t),t=i.digest().getBytes(),i.start(null,null),i.update(r),r=i.digest().getBytes(),t===r}(t.macKey,c,l)&&s}},function(e,t){var r={};e.exports=r;var n={};r.encode=function(e,t,r){if(\"string\"!=typeof t)throw new TypeError('\"alphabet\" must be a string.');if(void 0!==r&&\"number\"!=typeof r)throw new TypeError('\"maxline\" must be a number.');var n=\"\";if(e instanceof Uint8Array){var i=0,s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;++i){for(var u=0,c=e[i];u<a.length;++u)c+=a[u]<<8,a[u]=c%s,c=c/s|0;for(;c>0;)a.push(c%s),c=c/s|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=t[a[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var o=0,a=e.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var u=\"\";for(r=0;0===e.at(r)&&r<e.length()-1;++r)u+=i;for(r=s.length-1;r>=0;--r)u+=t[s[r]];return u}(e,t);if(r){var f=new RegExp(\".{1,\"+r+\"}\",\"g\");n=n.match(f).join(\"\\r\\n\")}return n},r.decode=function(e,t){if(\"string\"!=typeof e)throw new TypeError('\"input\" must be a string.');if(\"string\"!=typeof t)throw new TypeError('\"alphabet\" must be a string.');var r=n[t];if(!r){r=n[t]=[];for(var i=0;i<t.length;++i)r[t.charCodeAt(i)]=i}e=e.replace(/\\s/g,\"\");var s=t.length,o=t.charAt(0),a=[0];for(i=0;i<e.length;i++){var u=r[e.charCodeAt(i)];if(void 0===u)return;for(var c=0,f=u;c<a.length;++c)f+=a[c]*s,a[c]=255&f,f>>=8;for(;f>0;)a.push(255&f),f>>=8}for(var l=0;e[l]===o&&l<e.length-1;++l)a.push(0);return\"undefined\"!=typeof Buffer?Buffer.from(a.reverse()):new Uint8Array(a.reverse())}},function(e,t,r){\"use strict\";const n=r(40)(r(184)),i=r(97);t=e.exports;const s={rsa:r(722),ed25519:r(717),secp256k1:r(714)(n,r(309))};function o(e){return void 0!==s[e.toLowerCase()]}t.supportedKeys=s,t.keysPBM=n,t.keyStretcher=r(711),t.generateEphemeralKeyPair=r(710),t.generateKeyPair=((e,t,r)=>{let n=s[e.toLowerCase()];if(!n)return r(new Error(\"invalid or unsupported key type\"));n.generateKeyPair(t,r)}),t.generateKeyPairFromSeed=((e,t,r,n)=>{let i=s[e.toLowerCase()];return i?\"ed25519\"!==e.toLowerCase()?n(new Error(\"Seed key derivation is unimplemented for RSA or secp256k1\")):void i.generateKeyPairFromSeed(t,r,n):n(new Error(\"invalid or unsupported key type\"))}),t.unmarshalPublicKey=(e=>{const t=n.PublicKey.decode(e),r=t.Data;switch(t.Type){case n.KeyType.RSA:return s.rsa.unmarshalRsaPublicKey(r);case n.KeyType.Ed25519:return s.ed25519.unmarshalEd25519PublicKey(r);case n.KeyType.Secp256k1:if(s.secp256k1)return s.secp256k1.unmarshalSecp256k1PublicKey(r);throw new Error(\"secp256k1 support requires libp2p-crypto-secp256k1 package\");default:throw new Error(\"invalid or unsupported key type\")}}),t.marshalPublicKey=((e,t)=>{if(!o(t=(t||\"rsa\").toLowerCase()))throw new Error(\"invalid or unsupported key type\");return e.bytes}),t.unmarshalPrivateKey=((e,t)=>{let r;try{r=n.PrivateKey.decode(e)}catch(e){return t(e)}const i=r.Data;switch(r.Type){case n.KeyType.RSA:return s.rsa.unmarshalRsaPrivateKey(i,t);case n.KeyType.Ed25519:return s.ed25519.unmarshalEd25519PrivateKey(i,t);case n.KeyType.Secp256k1:return s.secp256k1?s.secp256k1.unmarshalSecp256k1PrivateKey(i,t):t(new Error(\"secp256k1 support requires libp2p-crypto-secp256k1 package\"));default:t(new Error(\"invalid or unsupported key type\"))}}),t.marshalPrivateKey=((e,t)=>{if(!o(t=(t||\"rsa\").toLowerCase()))throw new Error(\"invalid or unsupported key type\");return e.bytes}),t.import=((e,t,r)=>{try{const n=i.pki.decryptRsaPrivateKey(e,t);if(null===n)throw new Error(\"Cannot read the key, most likely the password is wrong or not a RSA key\");let o=i.asn1.toDer(i.pki.privateKeyToAsn1(n));return o=Buffer.from(o.getBytes(),\"binary\"),s.rsa.unmarshalRsaPrivateKey(o,r)}catch(e){r(e)}})},function(e,t,r){\"use strict\";const n=r(24);e.exports={createCipheriv:n.createCipheriv,createDecipheriv:n.createDecipheriv}},function(e,t,r){\"use strict\";const n=r(733),i={16:\"aes-128-ctr\",32:\"aes-256-ctr\"};t.create=function(e,t,r){const s=i[e.length];if(!s)return r(new Error(\"Invalid key length\"));const o=n.createCipheriv(s,e,t),a=n.createDecipheriv(s,e,t);r(null,{encrypt(e,t){t(null,o.update(e))},decrypt(e,t){t(null,a.update(e))}})}},function(e,t,r){\"use strict\";e.exports={SHA1:20,SHA256:32,SHA512:64}},function(e,t,r){\"use strict\";const n=r(3),i=r(5),s=r(185);(t=e.exports).multicodec=\"dag-pb\",t.resolve=((e,t,r)=>{n([t=>s.deserialize(e,t),(e,n)=>{if(!t)return r(null,{value:e,remainderPath:\"\"});const i=t.split(\"/\");if(\"Links\"===i[0]){let t=\"\";if(!i[1])return n(null,{value:e.links.map(e=>e.toJSON()),remainderPath:\"\"});const r={};e.links.forEach((e,t)=>{const n=e.toJSON();r[t]={hash:n.multihash,name:n.name,size:n.size},r[n.name]=n.multihash});let s=r[i[1]];\"Hash\"===i[2]?s={\"/\":s.hash}:\"Tsize\"===i[2]?s={\"/\":s.size}:\"Name\"===i[2]&&(s={\"/\":s.name}),n(null,{value:s,remainderPath:t=i.slice(3).join(\"/\")})}else\"Data\"===i[0]?n(null,{value:e.data,remainderPath:\"\"}):n(new Error(\"path not available\"))}],r)}),t.tree=((e,t,r)=>{\"function\"==typeof t&&(r=t,t={}),t=t||{},s.deserialize(e,(e,t)=>{if(e)return r(e);const n=[];n.push(\"Links\"),t.links.forEach((e,t)=>{n.push(`Links/${t}/Name`),n.push(`Links/${t}/Tsize`),n.push(`Links/${t}/Hash`)}),n.push(\"Data\"),r(null,n)})}),t.isLink=((e,r,n)=>{t.resolve(e,r,(e,t)=>{if(e)return n(e);if(t.remainderPath.length>0)return n(new Error(\"path out of scope\"));if(\"object\"==typeof t.value&&t.value[\"/\"]){let r;try{r=i.isCID(new i(t.value[\"/\"]))}catch(e){r=!1}if(r)return n(null,t.value)}n(null,!1)})})},function(e,t,r){\"use strict\";const n=r(130),i=n.cloneLinks,s=n.cloneData,o=r(131);e.exports=function(e,t,r){const n=s(e);let a=i(e);if(\"string\"==typeof t)a=a.filter(e=>e.name!==t);else{if(!Buffer.isBuffer(t))return r(new Error(\"second arg needs to be a name or multihash\"),null);a=a.filter(e=>!e.multihash.equals(t))}o(n,a,r)}},function(e,t,r){\"use strict\";const n=r(130),i=n.cloneLinks,s=n.cloneData,o=n.toDAGLink,a=r(69),u=r(131);e.exports=function(e,t,r){const n=i(e),c=s(e);if(t.constructor&&\"DAGLink\"===t.constructor.name);else if(t.constructor&&\"DAGNode\"===t.constructor.name)t=o(t);else{t.multihash=t.multihash||t.hash;try{t=new a(t.name,t.size,t.multihash)}catch(e){return r(e)}}n.push(t),u(c,n,r)}},function(e,t,r){\"use strict\";const n=r(130),i=n.cloneLinks,s=n.cloneData,o=r(131);e.exports=function(e,t){const r=s(e),n=i(e);o(r,n,t)}},function(e,t,r){\"use strict\";const n=r(69);(t=e.exports).isDagLink=function(e){return e&&e.constructor&&\"DAGLink\"===e.constructor.name},t.createDagLinkFromB58EncodedHash=function(e){return new n(e.name?e.name:e.Name,e.size?e.size:e.Size,e.hash||e.Hash||e.multihash)}},function(e,t,r){\"use strict\";const n=r(69);e.exports=function(e,t,r,i){i(null,new n(e,t,r))}},function(e,t,r){\"use strict\";e.exports=\"// An IPFS MerkleDAG Link\\nmessage PBLink {\\n\\n  // multihash of the target object\\n  optional bytes Hash = 1;\\n\\n  // utf string name. should be unique per object\\n  optional string Name = 2;\\n\\n  // cumulative size of target object\\n  optional uint64 Tsize = 3;\\n}\\n\\n// An IPFS MerkleDAG Node\\nmessage PBNode {\\n\\n  // refs to other objects\\n  repeated PBLink Links = 2;\\n\\n  // opaque user data\\n  optional bytes Data = 1;\\n}\"},function(e,t,r){\n//! stable.js 0.1.8, https://github.com/Two-Screen/stable\n//! Â© 2018 Angry Bytes and contributors. MIT licensed.\ne.exports=function(){\"use strict\";var e=function(e,r){return t(e.slice(),r)};function t(e,t){\"function\"!=typeof t&&(t=function(e,t){return String(e).localeCompare(t)});var n=e.length;if(n<=1)return e;for(var i=new Array(n),s=1;s<n;s*=2){r(e,t,s,i);var o=e;e=i,i=o}return e}e.inplace=function(e,n){var i=t(e,n);return i!==e&&r(i,null,e.length,e),e};var r=function(e,t,r,n){var i,s,o,a,u,c=e.length,f=0,l=2*r;for(i=0;i<c;i+=l)for(o=(s=i+r)+r,s>c&&(s=c),o>c&&(o=c),a=i,u=s;;)if(a<s&&u<o)t(e[a],e[u])<=0?n[f++]=e[a++]:n[f++]=e[u++];else if(a<s)n[f++]=e[a++];else{if(!(u<o))break;n[f++]=e[u++]}};return e}()},function(e,t,r){\"use strict\";e.exports={repoVersion:6}},function(e,t,r){\"use strict\";const n=r(380),i=r(25),s=r(0),o=r(52),a=s(\"repo:lock\"),u=new n;t.lock=((e,t)=>{const r=i.join(e,\"repo.lock\");a(\"locking %s\",r),u(r,t)}),t.locked=((e,t)=>{const r=i.join(e,\"repo.lock\");a(\"checking lock: %s\"),o.existsSync(r)||a(\"file does not exist: %s\",r),u(r,(e,r)=>{if(e)return a(\"already locked: %s\",e.message),t(null,!0);a(\"no one has a lock\"),r.close(e=>{if(e)return t(e);t(null,!1)})})})},function(e,t,r){\"use strict\";const n=r(0),i=r(2),s=n(\"repo:lock\"),o={};t.lock=((e,t)=>{const r=e+\"/repo.lock\";s(\"locking %s\",r),o[r]=!0;const n={close(e){o[r]&&delete o[r],i(e)}};i(()=>{t(null,n)})}),t.locked=((e,t)=>{const r=e+\"/repo.lock\";s(\"checking lock: %s\");const n=o[r];i(()=>{t(null,n)})})},function(e,t,r){\"use strict\";const n=r(1),i=r(382),s=r(9).utils.asyncFilter,o=r(9).utils.asyncSort,a=r(9).Key;e.exports=class{constructor(e,t){this.db=i(e,Object.assign({},t,{compression:!1,valueEncoding:\"binary\"}))}open(e){this.db.open(e)}put(e,t,r){this.db.put(e.toString(),t,r)}get(e,t){this.db.get(e.toString(),t)}has(e,t){this.db.get(e.toString(),(e,r)=>{if(e)return e.notFound?void t(null,!1):void t(e);t(null,!0)})}delete(e,t){this.db.del(e.toString(),t)}close(e){this.db.close(e)}batch(){const e=[];return{put:(t,r)=>{e.push({type:\"put\",key:t.toString(),value:r})},delete:t=>{e.push({type:\"del\",key:t.toString()})},commit:t=>{this.db.batch(e,t)}}}query(e){let t=!0;null!=e.keysOnly&&(t=!e.keysOnly);const r=this.db.db.iterator({keys:!0,values:t,keyAsBuffer:!0});let i=[(e,n)=>{if(e)return r.end(t=>{n(t||e)});r.next((e,i,s)=>{if(e)return n(e);if(null==e&&null==i&&null==s)return r.end(e=>{n(e||!0)});const o={key:new a(i,!1)};t&&(o.value=Buffer.from(s)),n(null,o)})}],u=[];if(null!=e.prefix){const t=e.prefix;u.push((e,r)=>r(null,e.key.toString().startsWith(t)))}if(null!=e.filters&&(u=u.concat(e.filters)),i=i.concat(u.map(e=>s(e))),null!=e.orders&&(i=i.concat(e.orders.map(e=>o(e)))),null!=e.offset){let t=0;i.push(n.filter(()=>t++>=e.offset))}return null!=e.limit&&i.push(n.take(e.limit)),n.apply(null,i)}}},function(e,t,r){\"use strict\";e.exports={lock:\"fs\",storageBackends:{root:r(187),blocks:r(187),keys:r(187),datastore:r(747)},storageBackendOptions:{root:{extension:\"\"},blocks:{sharding:!0,extension:\".data\"},keys:{}}}},function(e,t,r){\"use strict\";const n=r(386),i=n.ShardingDatastore,s=r(9).Key,o=r(216),a=r(132),u=r(2),c=r(215),f=r(5),l=r(1),h=e=>(e=>{const t=new o.Encoder;return new s(\"/\"+t.write(e).finalize(),!1)})(e.buffer);var p;e.exports=((e,t,r)=>{!function(e,t,r){if(t.sharding){const t=new n.shard.NextToLast(2);i.createOrOpen(e,t,r)}else u(()=>r(null,e))}(e,t,(e,t)=>{if(e)return r(e);r(null,(t=t,{query(e,r){l(t.query(e),l.collect(r))},get(e,r){if(!f.isCID(e))return u(()=>{r(new Error(\"Not a valid cid\"))});const n=h(e);t.get(n,(t,n)=>{if(t)return r(t);r(null,new a(n,e))})},put(e,r){if(!a.isBlock(e))return u(()=>{r(new Error(\"invalid block\"))});const n=h(e.cid);t.has(n,(i,s)=>i?r(i):s?r():void t.put(n,e.data,r))},putMany(e,r){const n=e.map(e=>({key:h(e.cid),block:e})),i=t.batch();c(n,(e,r)=>t.has(e.key,r),(e,t)=>{if(e)return r(e);t.forEach(e=>{i.put(e.key,e.block.data)}),i.commit(r)})},has(e,r){if(!f.isCID(e))return u(()=>{r(new Error(\"Not a valid cid\"))});t.has(h(e),r)},delete(e,r){if(!f.isCID(e))return u(()=>{r(new Error(\"Not a valid cid\"))});t.delete(h(e),r)},close(e){t.close(e)}}))})})},function(e,t,r){\"use strict\";const n=r(9).Key,i=r(8).Buffer,s=new n(\"api\");e.exports=(e=>({get(t){e.get(s,(e,r)=>t(e,r&&r.toString()))},set(t,r){e.put(s,i.from(t.toString()),r)},delete(t){e.delete(s,t)}}))},function(e,t,r){\"use strict\";const n=r(9).Key,i=r(104),s=r(3),o=r(218),a=r(388),u=r(387),c=r(8).Buffer,f=new n(\"config\");e.exports=(e=>{const t=i(function(e,t){const i=e.key,o=e.value;i?s([e=>r.get(e),(e,t)=>t(null,a(e,i,o)),n],t):n(o,t)},1),r={get(t,r){\"function\"==typeof t&&(r=t,t=void 0),t||(t=void 0),e.get(f,(e,n)=>{if(e)return r(e);let i;try{i=JSON.parse(n.toString())}catch(e){return r(e)}if(void 0!==t&&!u(i,t))return r(new Error(\"Key \"+t+\" does not exist in config\"));let s=void 0!==t?o(i,t):i;r(null,s)})},set(e,r,n){if(\"function\"==typeof r)n=r,r=e,e=void 0;else if(!e||\"string\"!=typeof e)return n(new Error(\"Invalid key type\"));if(void 0===r||c.isBuffer(r))return n(new Error(\"Invalid value type\"));t.push({key:e,value:r},n)},exists(t){e.has(f,t)}};return r;function n(t,r){const n=c.from(JSON.stringify(t,null,2));e.put(f,n,r)}})},function(e,t,r){\"use strict\";const n=r(9).Key,i=r(0)(\"repo:version\"),s=new n(\"version\");e.exports=(e=>({exists(t){e.has(s,t)},get(t){e.get(s,(e,r)=>{if(e)return t(e);t(null,parseInt(r.toString().trim(),10))})},set(t,r){e.put(s,Buffer.from(String(t)),r)},check(e,t){this.get((r,n)=>r?t(r):(i(\"comparing version: %s and %s\",n,e),n!==e?t(new Error(`version mismatch: expected v${e}, found v${n}`)):void t()))}}))},function(e,t,r){\"use strict\";t.create=function(e,t,r){return new(0,r.storageBackends[e])(t,Object.assign({},r.storageBackendOptions[e]||{}))}},function(e,t,r){\"use strict\";const n=r(132),i=r(1),s=r(5),o=r(391),a=r(188),u=r(328),c=r(25).join,f=r(25).sep,l=r(145).source,h=r(212),p=r(74),d=r(30),y=r(3),m=r(9).MemoryDatastore,g=r(84),v=r(372),b=r(365),w=r(362),_=r(39).ethAccountSnapshot,k=r(39).ethBlock,S=r(39).ethBlockList,E=r(39).ethStateTrie,x=r(39).ethStorageTrie,A=r(39).ethTx,B=r(39).ethTxTrie,C=r(338),I=r(337);function T(){}class D{constructor(e){if(!e)throw new Error(\"Missing blockservice\");this.bs=e,this.resolvers={},this.support={},this.support.add=((e,t,r)=>{if(this.resolvers[e])throw new Error(e+\"already supported\");this.resolvers[e]={resolver:t,util:r}}),this.support.rm=(e=>{this.resolvers[e]&&delete this.resolvers[e]}),this.support.add(g.resolver.multicodec,g.resolver,g.util),this.support.add(v.resolver.multicodec,v.resolver,v.util),this.support.add(b.resolver.multicodec,b.resolver,b.util),this.support.add(w.resolver.multicodec,w.resolver,w.util),this.support.add(_.resolver.multicodec,_.resolver,_.util),this.support.add(k.resolver.multicodec,k.resolver,k.util),this.support.add(S.resolver.multicodec,S.resolver,S.util),this.support.add(E.resolver.multicodec,E.resolver,E.util),this.support.add(x.resolver.multicodec,x.resolver,x.util),this.support.add(A.resolver.multicodec,A.resolver,A.util),this.support.add(B.resolver.multicodec,B.resolver,B.util),this.support.add(C.resolver.multicodec,C.resolver,C.util),this.support.add(I.resolver.multicodec,I.resolver,I.util)}get(e,t,r,n){if(\"function\"==typeof t&&(n=t,t=void 0),\"function\"==typeof r&&(n=r,r={}),\"string\"==typeof t&&(t=c(\"/\",t).substr(1).split(f).join(\"/\")),\"\"===t||!t)return this._get(e,(e,t)=>{if(e)return n(e);n(null,{value:t,remainderPath:\"\"})});let i;o(r=>{this.bs.get(e,(n,s)=>{if(n)return r(n);const o=this.resolvers[e.codec];if(!o)return r(new Error('No resolver found for codec \"'+e.codec+'\"'));o.resolver.resolve(s.data,t,(e,n)=>{if(e)return r(e);i=n.value,t=n.remainderPath,r()})})},()=>{const n=!t||\"\"===t||\"/\"===t,o=i&&!i[\"/\"];return!!(n&&o||r.localResolve)||(i&&(e=new s(i[\"/\"])),!1)},(e,r)=>e?n(e):n(null,{value:i,remainderPath:t}))}getStream(e,t,r){const n=l();return this.get(e,t,r,(e,t)=>{if(e)return n.resolve(i.error(e));n.resolve(i.values([t]))}),n}put(e,t,r){if(\"function\"==typeof t)return setImmediate(()=>r(new Error(\"no options were passed\")));if(r=r||T,t.cid&&s.isCID(t.cid))return this._put(t.cid,e,r);t.hashAlg=t.hashAlg||\"sha2-256\";const n=this.resolvers[t.format];if(!n)return r(new Error('No resolver found for codec \"'+t.format+'\"'));n.util.cid(e,(t,n)=>{if(t)return r(t);this._put(n,e,r)})}treeStream(e,t,r){let n;if(\"object\"==typeof t&&(r=t,t=void 0),!(r=r||{}).recursive){n=l();const t=this.resolvers[e.codec];if(!t)return n.abort(new Error('No resolver found for codec \"'+e.codec+'\"')),n;y([t=>this.bs.get(e,t),(e,r)=>t.resolver.tree(e.data,r)],(e,t)=>{if(e)return n.abort(e),n;n.resolve(i.values(t))})}return r.recursive&&(n=i(h.widthFirst({basePath:null,cid:e},e=>{if(\"string\"==typeof e)return i.empty();const t=l(),r=e.cid,n=this.resolvers[r.codec];return n?(y([t=>this.bs.get(e.cid,t),(e,t)=>n.resolver.tree(e.data,(r,i)=>{if(r)return t(r);p(i,(t,r)=>{n.resolver.isLink(e.data,t,(e,n)=>{if(e)return r(e);r(null,{path:t,link:n})})},t)})],(r,n)=>{if(r)return t.abort(r),t;t.resolve(i.values(n.map(t=>{const r=e.basePath?e.basePath+\"/\"+t.path:t.path;return t.link?{basePath:r,cid:new s(t.link[\"/\"])}:r})))}),t):(t.abort(new Error('No resolver found for codec \"'+r.codec+'\"')),t)}),i.map(e=>\"string\"==typeof e?e:e.basePath),i.filter(Boolean))),t?i(n,i.map(e=>{if(0===e.indexOf(t))return e=e.slice(t.length+1)}),i.filter(Boolean)):n}remove(e,t){this.bs.delete(e,t)}_get(e,t){const r=this.resolvers[e.codec];if(!r)return t(new Error('No resolver found for codec \"'+e.codec+'\"'));y([t=>this.bs.get(e,t),(e,t)=>{r?r.util.deserialize(e.data,(e,r)=>{if(e)return t(e);t(null,r)}):t(null,e.data)}],t)}_put(e,t,r){r=r||T;const i=this.resolvers[e.codec];if(!i)return r(new Error('No resolver found for codec \"'+e.codec+'\"'));y([e=>i.util.serialize(t,e),(t,r)=>this.bs.put(new n(t,e),r)],t=>{if(t)return r(t);r(null,e)})}}D.inMemory=function(e){const t=new a(\"in-memory\",{storageBackends:{root:m,blocks:m,datastore:m},lock:\"memory\"}),r=new u(t);d([e=>t.init({},e),e=>t.open(e)],t=>{if(t)return e(t);e(null,new D(r))})},e.exports=D},function(e,t,r){\"use strict\";const n=r(328),i=r(754),s=r(14),o=r(27),a=r(16),u=r(23),c=r(306),f=r(5),l=r(0),h=r(176),p=r(11),d=r(702),y=r(685),m=r(684),g=r(435);class v extends p{constructor(e){super(),this._options={init:!0,start:!0,EXPERIMENTAL:{}},e=d.validate(e||{}),this._libp2pModules=e.libp2p&&e.libp2p.modules,h(this._options,e),!1===e.init&&(this._options.init=!1),!1!==e.start&&(this._options.start=!0),\"string\"==typeof e.repo||void 0===e.repo?this._repo=g(e.repo):this._repo=e.repo,this.log=l(\"jsipfs\"),this.log.err=l(\"jsipfs:err\"),this.types={Buffer:Buffer,PeerId:s,PeerInfo:o,multiaddr:a,multihash:u,CID:f},this._peerInfoBook=new c,this._peerInfo=void 0,this._libp2pNode=void 0,this._bitswap=void 0,this._blockService=new n(this._repo),this._ipld=new i(this._blockService),this._pubsub=void 0,this.init=m.init(this),this.preStart=m.preStart(this),this.start=m.start(this),this.stop=m.stop(this),this.shutdown=this.stop,this.isOnline=m.isOnline(this),this.version=m.version(this),this.id=m.id(this),this.repo=m.repo(this),this.bootstrap=m.bootstrap(this),this.config=m.config(this),this.block=m.block(this),this.object=m.object(this),this.dag=m.dag(this),this.libp2p=m.libp2p(this),this.swarm=m.swarm(this),this.files=m.files(this),this.bitswap=m.bitswap(this),this.ping=m.ping(this),this.pubsub=m.pubsub(this),this.dht=m.dht(this),this.dns=m.dns(this),this.key=m.key(this),this.stats=m.stats(this),this._options.EXPERIMENTAL.pubsub&&this.log(\"EXPERIMENTAL pubsub is enabled\"),this._options.EXPERIMENTAL.sharding&&this.log(\"EXPERIMENTAL sharding is enabled\"),this._options.EXPERIMENTAL.dht&&this.log(\"EXPERIMENTAL Kademlia DHT is enabled\"),this._options.EXPERIMENTAL.relay&&this.log(\"EXPERIMENTAL Relay is enabled\"),this.state=r(434)(this),this.ls=this.files.lsImmutable,this.lsReadableStream=this.files.lsReadableStreamImmutable,this.lsPullStream=this.files.lsPullStreamImmutable,y(this)}}(e.exports=v).createNode=(e=>new v(e))},function(e,t,r){\"use strict\";var n=r(7),i=r(51),s=r(70),o=r(190),a=function(e,t){if(!(this instanceof a))return new a(e,t);if(this.extras={},this.knownParams=t||[],this.address=this.network=this.amount=this.message=null,\"string\"==typeof e){var r=a.parse(e);r.amount&&(r.amount=this._parseAmount(r.amount)),this._fromObject(r)}else{if(\"object\"!=typeof e)throw new TypeError(\"Unrecognized data format.\");this._fromObject(e)}};a.fromString=function(e){if(\"string\"!=typeof e)throw new TypeError(\"Expected a string\");return new a(e)},a.fromObject=function(e){return new a(e)},a.isValid=function(e,t){try{new a(e,t)}catch(e){return!1}return!0},a.parse=function(e){var t=i.parse(e,!0);if(\"zcash:\"!==t.protocol)throw new TypeError(\"Invalid zcash URI\");var r=/[^:]*:\\/?\\/?([^?]*)/.exec(e);return t.query.address=r&&r[1]||void 0,t.query},a.Members=[\"address\",\"amount\",\"message\",\"label\",\"r\"],a.prototype._fromObject=function(e){if(!s.isValid(e.address))throw new TypeError(\"Invalid zcash address\");for(var t in this.address=new s(e.address),this.network=this.address.network,this.amount=e.amount,e)if(\"address\"!==t&&\"amount\"!==t){if(/^req-/.exec(t)&&-1===this.knownParams.indexOf(t))throw Error(\"Unknown required argument \"+t);(a.Members.indexOf(t)>-1?this:this.extras)[t]=e[t]}},a.prototype._parseAmount=function(e){if(e=Number(e),isNaN(e))throw new TypeError(\"Invalid amount\");return o.fromBTC(e).toSatoshis()},a.prototype.toObject=a.prototype.toJSON=function(){for(var e={},t=0;t<a.Members.length;t++){var r=a.Members[t];this.hasOwnProperty(r)&&void 0!==this[r]&&(e[r]=this[r].toString())}return n.extend(e,this.extras),e},a.prototype.toString=function(){var e={};return this.amount&&(e.amount=o.fromSatoshis(this.amount).toBTC()),this.message&&(e.message=this.message),this.label&&(e.label=this.label),this.r&&(e.r=this.r),n.extend(e,this.extras),i.format({protocol:\"zcash:\",host:this.address,query:e})},a.prototype.inspect=function(){return\"<URI: \"+this.toString()+\">\"},e.exports=a},function(e,t,r){\"use strict\";var n=r(7),i=r(133),s=r(28),o=r(13),a=r(63),u=r(41),c=r(34),f=r(135),l=r(12);function h(e){return this instanceof h?(n.extend(this,h._from(e)),this):new h(e)}h.MAX_BLOCK_SIZE=1e6,h._from=function(e){var t={};if(o.isBuffer(e))t=h._fromBufferReader(a(e));else{if(!n.isObject(e))throw new TypeError(\"Unrecognized argument for Block\");t=h._fromObject(e)}return t},h._fromObject=function(e){var t=[];return e.transactions.forEach(function(e){e instanceof f?t.push(e):t.push(f().fromObject(e))}),{header:i.fromObject(e.header),transactions:t}},h.fromObject=function(e){return new h(h._fromObject(e))},h._fromBufferReader=function(e){var t={};l.checkState(!e.finished(),\"No block data received\"),t.header=i.fromBufferReader(e);var r=e.readVarintNum();t.transactions=[];for(var n=0;n<r;n++)t.transactions.push(f().fromBufferReader(e));return t},h.fromBufferReader=function(e){return l.checkArgument(e,\"br is required\"),new h(h._fromBufferReader(e))},h.fromBuffer=function(e){return h.fromBufferReader(new a(e))},h.fromString=function(e){var t=new Buffer(e,\"hex\");return h.fromBuffer(t)},h.fromRawBlock=function(e){o.isBuffer(e)||(e=new Buffer(e,\"binary\"));var t=a(e);return t.pos=h.Values.START_OF_BLOCK,new h(h._fromBufferReader(t))},h.prototype.toObject=h.prototype.toJSON=function(){var e=[];return this.transactions.forEach(function(t){e.push(t.toObject())}),{header:this.header.toObject(),transactions:e}},h.prototype.toBuffer=function(){return this.toBufferWriter().concat()},h.prototype.toString=function(){return this.toBuffer().toString(\"hex\")},h.prototype.toBufferWriter=function(e){e||(e=new u),e.write(this.header.toBuffer()),e.writeVarintNum(this.transactions.length);for(var t=0;t<this.transactions.length;t++)this.transactions[t].toBufferWriter(e);return e},h.prototype.getTransactionHashes=function(){var e=[];if(0===this.transactions.length)return[h.Values.NULL_HASH];for(var t=0;t<this.transactions.length;t++)e.push(this.transactions[t]._getHash());return e},h.prototype.getMerkleTree=function(){for(var e=this.getTransactionHashes(),t=0,r=this.transactions.length;r>1;r=Math.floor((r+1)/2)){for(var n=0;n<r;n+=2){var i=Math.min(n+1,r-1),s=Buffer.concat([e[t+n],e[t+i]]);e.push(c.sha256sha256(s))}t+=r}return e},h.prototype.getMerkleRoot=function(){var e=this.getMerkleTree();return e[e.length-1]},h.prototype.validMerkleRoot=function(){var e=new s(this.header.merkleRoot.toString(\"hex\"),\"hex\"),t=new s(this.getMerkleRoot().toString(\"hex\"),\"hex\");return 0===e.cmp(t)},h.prototype._getHash=function(){return this.header._getHash()};var p={configurable:!1,enumerable:!0,get:function(){return this._id||(this._id=this.header.id),this._id},set:n.noop};Object.defineProperty(h.prototype,\"id\",p),Object.defineProperty(h.prototype,\"hash\",p),h.prototype.inspect=function(){return\"<Block \"+this.id+\">\"},h.Values={START_OF_BLOCK:8,NULL_HASH:new Buffer(\"0000000000000000000000000000000000000000000000000000000000000000\",\"hex\")},e.exports=h},function(e,t,r){e.exports=r(757),e.exports.BlockHeader=r(133),e.exports.MerkleBlock=r(331)},function(e,t,r){\"use strict\";var n=r(41),i=r(63),s=r(28),o=function e(t){if(!(this instanceof e))return new e(t);if(Buffer.isBuffer(t))this.buf=t;else if(\"number\"==typeof t){var r=t;this.fromNumber(r)}else if(t instanceof s){var n=t;this.fromBN(n)}else if(t){var i=t;this.set(i)}};o.prototype.set=function(e){return this.buf=e.buf||this.buf,this},o.prototype.fromString=function(e){return this.set({buf:new Buffer(e,\"hex\")}),this},o.prototype.toString=function(){return this.buf.toString(\"hex\")},o.prototype.fromBuffer=function(e){return this.buf=e,this},o.prototype.fromBufferReader=function(e){return this.buf=e.readVarintBuf(),this},o.prototype.fromBN=function(e){return this.buf=n().writeVarintBN(e).concat(),this},o.prototype.fromNumber=function(e){return this.buf=n().writeVarintNum(e).concat(),this},o.prototype.toBuffer=function(){return this.buf},o.prototype.toBN=function(){return i(this.buf).readVarintBN()},o.prototype.toNumber=function(){return i(this.buf).readVarintNum()},e.exports=o},function(e,t,r){\"use strict\";var n=r(12),i=r(38),s=r(41);function o(e){return this instanceof o?e?this._fromObject(e):void 0:new o(e)}function a(e){return this instanceof a?e?this._fromObject(e):void 0:new a(e)}function u(e){return this instanceof u?e?this._fromObject(e):void 0:new u(e)}o.fromObject=function(e){return n.checkArgument(_.isObject(e)),(new o)._fromObject(e)},o.prototype._fromObject=function(e){return this.y_lsb=e.y_lsb,this.x=new i.Buffer(e.x,\"hex\"),this},o.prototype.toObject=o.prototype.toJSON=function(){return{y_lsb:this.y_lsb,x:this.x.toString(\"hex\")}},o.fromBufferReader=function(e){var t=new o,r=e.readUInt8();return t.y_lsb=1&r,t.x=e.read(32),t},o.prototype.toBufferWriter=function(e){return e||(e=new s),e.writeUInt8(2|this.y_lsb),e.write(this.x),e},a.fromObject=function(e){return n.checkArgument(_.isObject(e)),(new a)._fromObject(e)},a.prototype._fromObject=function(e){return this.y_gt=e.y_gt,this.x=new i.Buffer(e.x,\"hex\"),this},a.prototype.toObject=a.prototype.toJSON=function(){return{y_gt:this.y_gt,x:this.x.toString(\"hex\")}},a.fromBufferReader=function(e){var t=new a,r=e.readUInt8();return t.y_gt=1&r,t.x=e.read(64),t},a.prototype.toBufferWriter=function(e){return e||(e=new s),e.writeUInt8(10|this.y_gt),e.write(this.x),e},u.fromObject=function(e){return n.checkArgument(_.isObject(e)),(new u)._fromObject(e)},u.prototype._fromObject=function(e){return this.g_A=o.fromObject(e.g_A),this.g_A_prime=o.fromObject(e.g_A_prime),this.g_B=a.fromObject(e.g_B),this.g_B_prime=o.fromObject(e.g_B_prime),this.g_C=o.fromObject(e.g_C),this.g_C_prime=o.fromObject(e.g_C_prime),this.g_K=o.fromObject(e.g_K),this.g_H=o.fromObject(e.g_H),this},u.prototype.toObject=u.prototype.toJSON=function(){return{g_A:this.g_A.toObject(),g_A_prime:this.g_A_prime.toObject(),g_B:this.g_B.toObject(),g_B_prime:this.g_B_prime.toObject(),g_C:this.g_C.toObject(),g_C_prime:this.g_C_prime.toObject(),g_K:this.g_K.toObject(),g_H:this.g_H.toObject()}},u.fromBufferReader=function(e){var t=new u;return t.g_A=o.fromBufferReader(e),t.g_A_prime=o.fromBufferReader(e),t.g_B=a.fromBufferReader(e),t.g_B_prime=o.fromBufferReader(e),t.g_C=o.fromBufferReader(e),t.g_C_prime=o.fromBufferReader(e),t.g_K=o.fromBufferReader(e),t.g_H=o.fromBufferReader(e),t},u.prototype.toBufferWriter=function(e){return e||(e=new s),this.g_A.toBufferWriter(e),this.g_A_prime.toBufferWriter(e),this.g_B.toBufferWriter(e),this.g_B_prime.toBufferWriter(e),this.g_C.toBufferWriter(e),this.g_C_prime.toBufferWriter(e),this.g_K.toBufferWriter(e),this.g_H.toBufferWriter(e),e},e.exports=u},function(e,t,r){\"use strict\";var n=r(7),i=r(12),s=r(28),o=r(38),a=r(41),u=r(13),c=r(19),f=r(760);function l(e){return this instanceof l?(this.nullifiers=[],this.commitments=[],this.ciphertexts=[],this.macs=[],e?this._fromObject(e):void 0):new l(e)}Object.defineProperty(l.prototype,\"vpub_old\",{configurable:!1,enumerable:!0,get:function(){return this._vpub_old},set:function(e){e instanceof s?(this._vpub_oldBN=e,this._vpub_old=e.toNumber()):n.isString(e)?(this._vpub_old=parseInt(e),this._vpub_oldBN=s.fromNumber(this._vpub_old)):(i.checkArgument(c.isNaturalNumber(e),\"vpub_old is not a natural number\"),this._vpub_oldBN=s.fromNumber(e),this._vpub_old=e),i.checkState(c.isNaturalNumber(this._vpub_old),\"vpub_old is not a natural number\")}}),Object.defineProperty(l.prototype,\"vpub_new\",{configurable:!1,enumerable:!0,get:function(){return this._vpub_new},set:function(e){e instanceof s?(this._vpub_newBN=e,this._vpub_new=e.toNumber()):n.isString(e)?(this._vpub_new=parseInt(e),this._vpub_newBN=s.fromNumber(this._vpub_new)):(i.checkArgument(c.isNaturalNumber(e),\"vpub_new is not a natural number\"),this._vpub_newBN=s.fromNumber(e),this._vpub_new=e),i.checkState(c.isNaturalNumber(this._vpub_new),\"vpub_new is not a natural number\")}}),l.fromObject=function(e){return i.checkArgument(n.isObject(e)),(new l)._fromObject(e)},l.prototype._fromObject=function(e){var t=[];n.each(e.nullifiers,function(e){t.push(u.reverse(new o.Buffer(e,\"hex\")))});var r=[];n.each(e.commitments,function(e){r.push(u.reverse(new o.Buffer(e,\"hex\")))});var i=[];n.each(e.ciphertexts,function(e){i.push(new o.Buffer(e,\"hex\"))});var s=[];return n.each(e.macs,function(e){s.push(u.reverse(new o.Buffer(e,\"hex\")))}),this.vpub_old=e.vpub_old,this.vpub_new=e.vpub_new,this.anchor=u.reverse(new o.Buffer(e.anchor,\"hex\")),this.nullifiers=t,this.commitments=r,this.ephemeralKey=u.reverse(new o.Buffer(e.ephemeralKey,\"hex\")),this.ciphertexts=i,this.randomSeed=u.reverse(new o.Buffer(e.randomSeed,\"hex\")),this.macs=s,this.proof=f.fromObject(e.proof),this},l.prototype.toObject=l.prototype.toJSON=function(){var e=[];n.each(this.nullifiers,function(t){e.push(u.reverse(t).toString(\"hex\"))});var t=[];n.each(this.commitments,function(e){t.push(u.reverse(e).toString(\"hex\"))});var r=[];n.each(this.ciphertexts,function(e){r.push(e.toString(\"hex\"))});var i=[];return n.each(this.macs,function(e){i.push(u.reverse(e).toString(\"hex\"))}),{vpub_old:this.vpub_old,vpub_new:this.vpub_new,anchor:u.reverse(this.anchor).toString(\"hex\"),nullifiers:e,commitments:t,ephemeralKey:u.reverse(this.ephemeralKey).toString(\"hex\"),ciphertexts:r,randomSeed:u.reverse(this.randomSeed).toString(\"hex\"),macs:i,proof:this.proof.toObject()}},l.fromBufferReader=function(e){var t,r=new l;for(r.vpub_old=e.readUInt64LEBN(),r.vpub_new=e.readUInt64LEBN(),r.anchor=e.read(32),t=0;t<2;t++)r.nullifiers.push(e.read(32));for(t=0;t<2;t++)r.commitments.push(e.read(32));for(r.ephemeralKey=e.read(32),r.randomSeed=e.read(32),t=0;t<2;t++)r.macs.push(e.read(32));for(r.proof=f.fromBufferReader(e),t=0;t<2;t++)r.ciphertexts.push(e.read(601));return r},l.prototype.toBufferWriter=function(e){var t;for(e||(e=new a),e.writeUInt64LEBN(this._vpub_oldBN),e.writeUInt64LEBN(this._vpub_newBN),e.write(this.anchor),t=0;t<2;t++)e.write(this.nullifiers[t]);for(t=0;t<2;t++)e.write(this.commitments[t]);for(e.write(this.ephemeralKey),e.write(this.randomSeed),t=0;t<2;t++)e.write(this.macs[t]);for(this.proof.toBufferWriter(e),t=0;t<2;t++)e.write(this.ciphertexts[t]);return e},e.exports=l},function(e,t,r){\"use strict\";var n=r(7),i=r(75),s=r(99),o=r(61),a=r(12),u=r(43),c=r(44),f=r(62),l=(r(50),r(13)),h=r(98);function p(e,t,r,i){s.apply(this,arguments);var o=this;t=t||e.publicKeys,r=r||e.threshold,i=i||e.signatures,this.publicKeys=n.sortBy(t,function(e){return e.toString(\"hex\")}),this.redeemScript=u.buildMultisigOut(this.publicKeys,r),a.checkState(u.buildScriptHashOut(this.redeemScript).equals(this.output.script),\"Provided public keys don't hash to the provided output\"),this.publicKeyIndex={},n.each(this.publicKeys,function(e,t){o.publicKeyIndex[e.toString()]=t}),this.threshold=r,this.signatures=i?this._deserializeSignatures(i):new Array(this.publicKeys.length)}i(p,s),p.prototype.toObject=function(){var e=s.prototype.toObject.apply(this,arguments);return e.threshold=this.threshold,e.publicKeys=n.map(this.publicKeys,function(e){return e.toString()}),e.signatures=this._serializeSignatures(),e},p.prototype._deserializeSignatures=function(e){return n.map(e,function(e){if(e)return new h(e)})},p.prototype._serializeSignatures=function(){return n.map(this.signatures,function(e){if(e)return e.toObject()})},p.prototype.getSignatures=function(e,t,r,i){a.checkState(this.output instanceof o),i=i||c.SIGHASH_ALL;var s=this,u=[];return n.each(this.publicKeys,function(n){n.toString()===t.publicKey.toString()&&u.push(new h({publicKey:t.publicKey,prevTxId:s.prevTxId,outputIndex:s.outputIndex,inputIndex:r,signature:f.sign(e,t,i,r,s.redeemScript),sigtype:i}))}),u},p.prototype.addSignature=function(e,t){return a.checkState(!this.isFullySigned(),\"All needed signatures have already been added\"),a.checkArgument(!n.isUndefined(this.publicKeyIndex[t.publicKey.toString()]),\"Signature has no matching public key\"),a.checkState(this.isValidSignature(e,t)),this.signatures[this.publicKeyIndex[t.publicKey.toString()]]=t,this._updateScript(),this},p.prototype._updateScript=function(){return this.setScript(u.buildP2SHMultisigIn(this.publicKeys,this.threshold,this._createSignatures(),{cachedMultisig:this.redeemScript})),this},p.prototype._createSignatures=function(){return n.map(n.filter(this.signatures,function(e){return!n.isUndefined(e)}),function(e){return l.concat([e.signature.toDER(),l.integerAsSingleByteBuffer(e.sigtype)])})},p.prototype.clearSignatures=function(){this.signatures=new Array(this.publicKeys.length),this._updateScript()},p.prototype.isFullySigned=function(){return this.countSignatures()===this.threshold},p.prototype.countMissingSignatures=function(){return this.threshold-this.countSignatures()},p.prototype.countSignatures=function(){return n.reduce(this.signatures,function(e,t){return e+!!t},0)},p.prototype.publicKeysWithoutSignature=function(){var e=this;return n.filter(this.publicKeys,function(t){return!e.signatures[e.publicKeyIndex[t.toString()]]})},p.prototype.isValidSignature=function(e,t){return t.signature.nhashtype=t.sigtype,f.verify(e,t.signature,t.publicKey,t.inputIndex,this.redeemScript)},p.OPCODES_SIZE=7,p.SIGNATURE_SIZE=74,p.PUBKEY_SIZE=34,p.prototype._estimateSize=function(){return p.OPCODES_SIZE+this.threshold*p.SIGNATURE_SIZE+this.publicKeys.length*p.PUBKEY_SIZE},e.exports=p},function(e,t,r){\"use strict\";var n=r(7),i=r(75),s=(r(192),r(99)),o=r(61),a=r(12),u=r(43),c=r(44),f=r(62),l=(r(50),r(13)),h=r(98);function p(e,t,r,i){s.apply(this,arguments);var o=this;t=t||e.publicKeys,r=r||e.threshold,i=i||e.signatures,this.publicKeys=n.sortBy(t,function(e){return e.toString(\"hex\")}),a.checkState(u.buildMultisigOut(this.publicKeys,r).equals(this.output.script),\"Provided public keys don't match to the provided output script\"),this.publicKeyIndex={},n.each(this.publicKeys,function(e,t){o.publicKeyIndex[e.toString()]=t}),this.threshold=r,this.signatures=i?this._deserializeSignatures(i):new Array(this.publicKeys.length)}i(p,s),p.prototype.toObject=function(){var e=s.prototype.toObject.apply(this,arguments);return e.threshold=this.threshold,e.publicKeys=n.map(this.publicKeys,function(e){return e.toString()}),e.signatures=this._serializeSignatures(),e},p.prototype._deserializeSignatures=function(e){return n.map(e,function(e){if(e)return new h(e)})},p.prototype._serializeSignatures=function(){return n.map(this.signatures,function(e){if(e)return e.toObject()})},p.prototype.getSignatures=function(e,t,r,i){a.checkState(this.output instanceof o),i=i||c.SIGHASH_ALL;var s=this,u=[];return n.each(this.publicKeys,function(n){n.toString()===t.publicKey.toString()&&u.push(new h({publicKey:t.publicKey,prevTxId:s.prevTxId,outputIndex:s.outputIndex,inputIndex:r,signature:f.sign(e,t,i,r,s.output.script),sigtype:i}))}),u},p.prototype.addSignature=function(e,t){return a.checkState(!this.isFullySigned(),\"All needed signatures have already been added\"),a.checkArgument(!n.isUndefined(this.publicKeyIndex[t.publicKey.toString()]),\"Signature has no matching public key\"),a.checkState(this.isValidSignature(e,t)),this.signatures[this.publicKeyIndex[t.publicKey.toString()]]=t,this._updateScript(),this},p.prototype._updateScript=function(){return this.setScript(u.buildMultisigIn(this.publicKeys,this.threshold,this._createSignatures())),this},p.prototype._createSignatures=function(){return n.map(n.filter(this.signatures,function(e){return!n.isUndefined(e)}),function(e){return l.concat([e.signature.toDER(),l.integerAsSingleByteBuffer(e.sigtype)])})},p.prototype.clearSignatures=function(){this.signatures=new Array(this.publicKeys.length),this._updateScript()},p.prototype.isFullySigned=function(){return this.countSignatures()===this.threshold},p.prototype.countMissingSignatures=function(){return this.threshold-this.countSignatures()},p.prototype.countSignatures=function(){return n.reduce(this.signatures,function(e,t){return e+!!t},0)},p.prototype.publicKeysWithoutSignature=function(){var e=this;return n.filter(this.publicKeys,function(t){return!e.signatures[e.publicKeyIndex[t.toString()]]})},p.prototype.isValidSignature=function(e,t){return t.signature.nhashtype=t.sigtype,f.verify(e,t.signature,t.publicKey,t.inputIndex,this.output.script)},p.normalizeSignatures=function(e,t,r,n,i){return i.map(function(i){var s=null;return n=n.filter(function(n){if(s)return!0;var o=new h({signature:c.fromTxFormat(n),publicKey:i,prevTxId:t.prevTxId,outputIndex:t.outputIndex,inputIndex:r,sigtype:c.SIGHASH_ALL});return o.signature.nhashtype=o.sigtype,!f.verify(e,o.signature,o.publicKey,o.inputIndex,t.output.script)||(s=o,!1)}),s||null})},p.OPCODES_SIZE=1,p.SIGNATURE_SIZE=73,p.prototype._estimateSize=function(){return p.OPCODES_SIZE+this.threshold*p.SIGNATURE_SIZE},e.exports=p},function(e,t,r){\"use strict\";var n=r(75),i=r(12),s=r(13),o=r(34),a=r(99),u=r(61),c=r(62),f=r(43),l=r(44),h=r(98);function p(){a.apply(this,arguments)}n(p,a),p.prototype.getSignatures=function(e,t,r,n,a){return i.checkState(this.output instanceof u),a=a||o.sha256ripemd160(t.publicKey.toBuffer()),n=n||l.SIGHASH_ALL,s.equals(a,this.output.script.getPublicKeyHash())?[new h({publicKey:t.publicKey,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:r,signature:c.sign(e,t,n,r,this.output.script),sigtype:n})]:[]},p.prototype.addSignature=function(e,t){return i.checkState(this.isValidSignature(e,t),\"Signature is invalid\"),this.setScript(f.buildPublicKeyHashIn(t.publicKey,t.signature.toDER(),t.sigtype)),this},p.prototype.clearSignatures=function(){return this.setScript(f.empty()),this},p.prototype.isFullySigned=function(){return this.script.isPublicKeyHashIn()},p.SCRIPT_MAX_SIZE=107,p.prototype._estimateSize=function(){return p.SCRIPT_MAX_SIZE},e.exports=p},function(e,t,r){\"use strict\";var n=r(75),i=r(12),s=(r(13),r(99)),o=r(61),a=r(62),u=r(43),c=r(44),f=r(98);function l(){s.apply(this,arguments)}n(l,s),l.prototype.getSignatures=function(e,t,r,n){i.checkState(this.output instanceof o),n=n||c.SIGHASH_ALL;var s=t.toPublicKey();return s.toString()===this.output.script.getPublicKey().toString(\"hex\")?[new f({publicKey:s,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:r,signature:a.sign(e,t,n,r,this.output.script),sigtype:n})]:[]},l.prototype.addSignature=function(e,t){return i.checkState(this.isValidSignature(e,t),\"Signature is invalid\"),this.setScript(u.buildPublicKeyIn(t.signature.toDER(),t.sigtype)),this},l.prototype.clearSignatures=function(){return this.setScript(u.empty()),this},l.prototype.isFullySigned=function(){return this.script.isPublicKeyIn()},l.SCRIPT_MAX_SIZE=73,l.prototype._estimateSize=function(){return l.SCRIPT_MAX_SIZE},e.exports=l},function(e,t){e.exports=function(e,t){for(var r=0,n=0;n<e.length&&n!=t.length&&0==(r=e[n]<t[n]?-1:e[n]>t[n]?1:0);++n);return 0==r&&(t.length>e.length?r=-1:e.length>t.length&&(r=1)),r}},function(e,t,r){\"use strict\";var n=r(7),i=r(333),s=r(193),o=r(28),a=r(34),u=r(44),c=r(50),f=function e(t){if(!(this instanceof e))return new e(t);t?(this.initialize(),this.set(t)):this.initialize()};f.prototype.verify=function(e,t,s,o,a){var u,c=r(135);if(n.isUndefined(s)&&(s=new c),n.isUndefined(o)&&(o=0),n.isUndefined(a)&&(a=0),this.set({script:e,tx:s,nin:o,flags:a}),0!=(a&f.SCRIPT_VERIFY_SIGPUSHONLY)&&!e.isPushOnly())return this.errstr=\"SCRIPT_ERR_SIG_PUSHONLY\",!1;if(!this.evaluate())return!1;a&f.SCRIPT_VERIFY_P2SH&&(u=this.stack.slice());var l=this.stack;if(this.initialize(),this.set({script:t,stack:l,tx:s,nin:o,flags:a}),!this.evaluate())return!1;if(0===this.stack.length)return this.errstr=\"SCRIPT_ERR_EVAL_FALSE_NO_RESULT\",!1;var h=this.stack[this.stack.length-1];if(!f.castToBool(h))return this.errstr=\"SCRIPT_ERR_EVAL_FALSE_IN_STACK\",!1;if(a&f.SCRIPT_VERIFY_P2SH&&t.isScriptHashOut()){if(!e.isPushOnly())return this.errstr=\"SCRIPT_ERR_SIG_PUSHONLY\",!1;if(0===u.length)throw new Error(\"internal error - stack copy empty\");var p=u[u.length-1],d=i.fromBuffer(p);return u.pop(),this.initialize(),this.set({script:d,stack:u,tx:s,nin:o,flags:a}),!!this.evaluate()&&(0===u.length?(this.errstr=\"SCRIPT_ERR_EVAL_FALSE_NO_P2SH_STACK\",!1):!!f.castToBool(u[u.length-1])||(this.errstr=\"SCRIPT_ERR_EVAL_FALSE_IN_P2SH_STACK\",!1))}return!0},e.exports=f,f.prototype.initialize=function(e){this.stack=[],this.altstack=[],this.pc=0,this.pbegincodehash=0,this.nOpCount=0,this.vfExec=[],this.errstr=\"\",this.flags=0},f.prototype.set=function(e){this.script=e.script||this.script,this.tx=e.tx||this.tx,this.nin=void 0!==e.nin?e.nin:this.nin,this.stack=e.stack||this.stack,this.altstack=e.altack||this.altstack,this.pc=void 0!==e.pc?e.pc:this.pc,this.pbegincodehash=void 0!==e.pbegincodehash?e.pbegincodehash:this.pbegincodehash,this.nOpCount=void 0!==e.nOpCount?e.nOpCount:this.nOpCount,this.vfExec=e.vfExec||this.vfExec,this.errstr=e.errstr||this.errstr,this.flags=void 0!==e.flags?e.flags:this.flags},f.true=new Buffer([1]),f.false=new Buffer([]),f.MAX_SCRIPT_ELEMENT_SIZE=520,f.LOCKTIME_THRESHOLD_BN=new o(f.LOCKTIME_THRESHOLD=5e8),f.SCRIPT_VERIFY_NONE=0,f.SCRIPT_VERIFY_P2SH=1,f.SCRIPT_VERIFY_STRICTENC=2,f.SCRIPT_VERIFY_DERSIG=4,f.SCRIPT_VERIFY_LOW_S=8,f.SCRIPT_VERIFY_NULLDUMMY=16,f.SCRIPT_VERIFY_SIGPUSHONLY=32,f.SCRIPT_VERIFY_MINIMALDATA=64,f.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS=128,f.SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY=512,f.castToBool=function(e){for(var t=0;t<e.length;t++)if(0!==e[t])return t!==e.length-1||128!==e[t];return!1},f.prototype.checkSignatureEncoding=function(e){if(0!=(this.flags&(f.SCRIPT_VERIFY_DERSIG|f.SCRIPT_VERIFY_LOW_S|f.SCRIPT_VERIFY_STRICTENC))&&!u.isTxDER(e))return this.errstr=\"SCRIPT_ERR_SIG_DER_INVALID_FORMAT\",!1;if(0!=(this.flags&f.SCRIPT_VERIFY_LOW_S)){if(!u.fromTxFormat(e).hasLowS())return this.errstr=\"SCRIPT_ERR_SIG_DER_HIGH_S\",!1}else if(0!=(this.flags&f.SCRIPT_VERIFY_STRICTENC)&&!u.fromTxFormat(e).hasDefinedHashtype())return this.errstr=\"SCRIPT_ERR_SIG_HASHTYPE\",!1;return!0},f.prototype.checkPubkeyEncoding=function(e){return!(0!=(this.flags&f.SCRIPT_VERIFY_STRICTENC)&&!c.isValid(e))||(this.errstr=\"SCRIPT_ERR_PUBKEYTYPE\",!1)},f.prototype.evaluate=function(){if(this.script.toBuffer().length>1e4)return this.errstr=\"SCRIPT_ERR_SCRIPT_SIZE\",!1;try{for(;this.pc<this.script.chunks.length;){if(!this.step())return!1}if(this.stack.length+this.altstack.length>1e3)return this.errstr=\"SCRIPT_ERR_STACK_SIZE\",!1}catch(e){return this.errstr=\"SCRIPT_ERR_UNKNOWN_ERROR: \"+e,!1}return!(this.vfExec.length>0)||(this.errstr=\"SCRIPT_ERR_UNBALANCED_CONDITIONAL\",!1)},f.prototype.checkLockTime=function(e){return!!(this.tx.nLockTime<f.LOCKTIME_THRESHOLD&&e.lt(f.LOCKTIME_THRESHOLD_BN)||this.tx.nLockTime>=f.LOCKTIME_THRESHOLD&&e.gte(f.LOCKTIME_THRESHOLD_BN))&&(!e.gt(new o(this.tx.nLockTime))&&!!this.tx.inputs[this.nin].isFinal())},f.prototype.step=function(){var e,t,r,l,h,p,d,y,m,g,v,b,w,_,k,S,E,x=0!=(this.flags&f.SCRIPT_VERIFY_MINIMALDATA),A=-1===this.vfExec.indexOf(!1),B=this.script.chunks[this.pc];this.pc++;var C=B.opcodenum;if(n.isUndefined(C))return this.errstr=\"SCRIPT_ERR_UNDEFINED_OPCODE\",!1;if(B.buf&&B.buf.length>f.MAX_SCRIPT_ELEMENT_SIZE)return this.errstr=\"SCRIPT_ERR_PUSH_SIZE\",!1;if(C>s.OP_16&&++this.nOpCount>201)return this.errstr=\"SCRIPT_ERR_OP_COUNT\",!1;if(C===s.OP_CAT||C===s.OP_SUBSTR||C===s.OP_LEFT||C===s.OP_RIGHT||C===s.OP_INVERT||C===s.OP_AND||C===s.OP_OR||C===s.OP_XOR||C===s.OP_2MUL||C===s.OP_2DIV||C===s.OP_MUL||C===s.OP_DIV||C===s.OP_MOD||C===s.OP_LSHIFT||C===s.OP_RSHIFT)return this.errstr=\"SCRIPT_ERR_DISABLED_OPCODE\",!1;if(A&&0<=C&&C<=s.OP_PUSHDATA4){if(x&&!this.script.checkMinimalPush(this.pc-1))return this.errstr=\"SCRIPT_ERR_MINIMALDATA\",!1;if(B.buf){if(B.len!==B.buf.length)throw new Error(\"Length of push value not equal to length of data\");this.stack.push(B.buf)}else this.stack.push(f.false)}else if(A||s.OP_IF<=C&&C<=s.OP_ENDIF)switch(C){case s.OP_1NEGATE:case s.OP_1:case s.OP_2:case s.OP_3:case s.OP_4:case s.OP_5:case s.OP_6:case s.OP_7:case s.OP_8:case s.OP_9:case s.OP_10:case s.OP_11:case s.OP_12:case s.OP_13:case s.OP_14:case s.OP_15:case s.OP_16:h=C-(s.OP_1-1),e=new o(h).toScriptNumBuffer(),this.stack.push(e);break;case s.OP_NOP:break;case s.OP_NOP2:case s.OP_CHECKLOCKTIMEVERIFY:if(!(this.flags&f.SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY)){if(this.flags&f.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS)return this.errstr=\"SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS\",!1;break}if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;var I=o.fromScriptNumBuffer(this.stack[this.stack.length-1],x,5);if(I.lt(new o(0)))return this.errstr=\"SCRIPT_ERR_NEGATIVE_LOCKTIME\",!1;if(!this.checkLockTime(I))return this.errstr=\"SCRIPT_ERR_UNSATISFIED_LOCKTIME\",!1;break;case s.OP_NOP1:case s.OP_NOP3:case s.OP_NOP4:case s.OP_NOP5:case s.OP_NOP6:case s.OP_NOP7:case s.OP_NOP8:case s.OP_NOP9:case s.OP_NOP10:if(this.flags&f.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS)return this.errstr=\"SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS\",!1;break;case s.OP_IF:case s.OP_NOTIF:if(S=!1,A){if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_UNBALANCED_CONDITIONAL\",!1;e=this.stack.pop(),S=f.castToBool(e),C===s.OP_NOTIF&&(S=!S)}this.vfExec.push(S);break;case s.OP_ELSE:if(0===this.vfExec.length)return this.errstr=\"SCRIPT_ERR_UNBALANCED_CONDITIONAL\",!1;this.vfExec[this.vfExec.length-1]=!this.vfExec[this.vfExec.length-1];break;case s.OP_ENDIF:if(0===this.vfExec.length)return this.errstr=\"SCRIPT_ERR_UNBALANCED_CONDITIONAL\",!1;this.vfExec.pop();break;case s.OP_VERIFY:if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;if(e=this.stack[this.stack.length-1],!(S=f.castToBool(e)))return this.errstr=\"SCRIPT_ERR_VERIFY\",!1;this.stack.pop();break;case s.OP_RETURN:return this.errstr=\"SCRIPT_ERR_OP_RETURN\",!1;case s.OP_TOALTSTACK:if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;this.altstack.push(this.stack.pop());break;case s.OP_FROMALTSTACK:if(this.altstack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_ALTSTACK_OPERATION\",!1;this.stack.push(this.altstack.pop());break;case s.OP_2DROP:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;this.stack.pop(),this.stack.pop();break;case s.OP_2DUP:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;t=this.stack[this.stack.length-2],r=this.stack[this.stack.length-1],this.stack.push(t),this.stack.push(r);break;case s.OP_3DUP:if(this.stack.length<3)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;t=this.stack[this.stack.length-3],r=this.stack[this.stack.length-2];var T=this.stack[this.stack.length-1];this.stack.push(t),this.stack.push(r),this.stack.push(T);break;case s.OP_2OVER:if(this.stack.length<4)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;t=this.stack[this.stack.length-4],r=this.stack[this.stack.length-3],this.stack.push(t),this.stack.push(r);break;case s.OP_2ROT:if(this.stack.length<6)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;l=this.stack.splice(this.stack.length-6,2),this.stack.push(l[0]),this.stack.push(l[1]);break;case s.OP_2SWAP:if(this.stack.length<4)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;l=this.stack.splice(this.stack.length-4,2),this.stack.push(l[0]),this.stack.push(l[1]);break;case s.OP_IFDUP:if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;e=this.stack[this.stack.length-1],(S=f.castToBool(e))&&this.stack.push(e);break;case s.OP_DEPTH:e=new o(this.stack.length).toScriptNumBuffer(),this.stack.push(e);break;case s.OP_DROP:if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;this.stack.pop();break;case s.OP_DUP:if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;this.stack.push(this.stack[this.stack.length-1]);break;case s.OP_NIP:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;this.stack.splice(this.stack.length-2,1);break;case s.OP_OVER:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;this.stack.push(this.stack[this.stack.length-2]);break;case s.OP_PICK:case s.OP_ROLL:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;if(e=this.stack[this.stack.length-1],h=(y=o.fromScriptNumBuffer(e,x)).toNumber(),this.stack.pop(),h<0||h>=this.stack.length)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;e=this.stack[this.stack.length-h-1],C===s.OP_ROLL&&this.stack.splice(this.stack.length-h-1,1),this.stack.push(e);break;case s.OP_ROT:if(this.stack.length<3)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;p=this.stack[this.stack.length-3],d=this.stack[this.stack.length-2];var D=this.stack[this.stack.length-1];this.stack[this.stack.length-3]=d,this.stack[this.stack.length-2]=D,this.stack[this.stack.length-1]=p;break;case s.OP_SWAP:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;p=this.stack[this.stack.length-2],d=this.stack[this.stack.length-1],this.stack[this.stack.length-2]=d,this.stack[this.stack.length-1]=p;break;case s.OP_TUCK:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;this.stack.splice(this.stack.length-2,0,this.stack[this.stack.length-1]);break;case s.OP_SIZE:if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;y=new o(this.stack[this.stack.length-1].length),this.stack.push(y.toScriptNumBuffer());break;case s.OP_EQUAL:case s.OP_EQUALVERIFY:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;t=this.stack[this.stack.length-2],r=this.stack[this.stack.length-1];var P=t.toString(\"hex\")===r.toString(\"hex\");if(this.stack.pop(),this.stack.pop(),this.stack.push(P?f.true:f.false),C===s.OP_EQUALVERIFY){if(!P)return this.errstr=\"SCRIPT_ERR_EQUALVERIFY\",!1;this.stack.pop()}break;case s.OP_1ADD:case s.OP_1SUB:case s.OP_NEGATE:case s.OP_ABS:case s.OP_NOT:case s.OP_0NOTEQUAL:if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;switch(e=this.stack[this.stack.length-1],y=o.fromScriptNumBuffer(e,x),C){case s.OP_1ADD:y=y.add(o.One);break;case s.OP_1SUB:y=y.sub(o.One);break;case s.OP_NEGATE:y=y.neg();break;case s.OP_ABS:y.cmp(o.Zero)<0&&(y=y.neg());break;case s.OP_NOT:y=new o((0===y.cmp(o.Zero))+0);break;case s.OP_0NOTEQUAL:y=new o((0!==y.cmp(o.Zero))+0)}this.stack.pop(),this.stack.push(y.toScriptNumBuffer());break;case s.OP_ADD:case s.OP_SUB:case s.OP_BOOLAND:case s.OP_BOOLOR:case s.OP_NUMEQUAL:case s.OP_NUMEQUALVERIFY:case s.OP_NUMNOTEQUAL:case s.OP_LESSTHAN:case s.OP_GREATERTHAN:case s.OP_LESSTHANOREQUAL:case s.OP_GREATERTHANOREQUAL:case s.OP_MIN:case s.OP_MAX:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;switch(m=o.fromScriptNumBuffer(this.stack[this.stack.length-2],x),g=o.fromScriptNumBuffer(this.stack[this.stack.length-1],x),y=new o(0),C){case s.OP_ADD:y=m.add(g);break;case s.OP_SUB:y=m.sub(g);break;case s.OP_BOOLAND:y=new o((0!==m.cmp(o.Zero)&&0!==g.cmp(o.Zero))+0);break;case s.OP_BOOLOR:y=new o((0!==m.cmp(o.Zero)||0!==g.cmp(o.Zero))+0);break;case s.OP_NUMEQUAL:case s.OP_NUMEQUALVERIFY:y=new o((0===m.cmp(g))+0);break;case s.OP_NUMNOTEQUAL:y=new o((0!==m.cmp(g))+0);break;case s.OP_LESSTHAN:y=new o((m.cmp(g)<0)+0);break;case s.OP_GREATERTHAN:y=new o((m.cmp(g)>0)+0);break;case s.OP_LESSTHANOREQUAL:y=new o((m.cmp(g)<=0)+0);break;case s.OP_GREATERTHANOREQUAL:y=new o((m.cmp(g)>=0)+0);break;case s.OP_MIN:y=m.cmp(g)<0?m:g;break;case s.OP_MAX:y=m.cmp(g)>0?m:g}if(this.stack.pop(),this.stack.pop(),this.stack.push(y.toScriptNumBuffer()),C===s.OP_NUMEQUALVERIFY){if(!f.castToBool(this.stack[this.stack.length-1]))return this.errstr=\"SCRIPT_ERR_NUMEQUALVERIFY\",!1;this.stack.pop()}break;case s.OP_WITHIN:if(this.stack.length<3)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;m=o.fromScriptNumBuffer(this.stack[this.stack.length-3],x),g=o.fromScriptNumBuffer(this.stack[this.stack.length-2],x);var O=o.fromScriptNumBuffer(this.stack[this.stack.length-1],x);S=g.cmp(m)<=0&&m.cmp(O)<0,this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(S?f.true:f.false);break;case s.OP_RIPEMD160:case s.OP_SHA1:case s.OP_SHA256:case s.OP_HASH160:case s.OP_HASH256:if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;var N;e=this.stack[this.stack.length-1],C===s.OP_RIPEMD160?N=a.ripemd160(e):C===s.OP_SHA1?N=a.sha1(e):C===s.OP_SHA256?N=a.sha256(e):C===s.OP_HASH160?N=a.sha256ripemd160(e):C===s.OP_HASH256&&(N=a.sha256sha256(e)),this.stack.pop(),this.stack.push(N);break;case s.OP_CODESEPARATOR:this.pbegincodehash=this.pc;break;case s.OP_CHECKSIG:case s.OP_CHECKSIGVERIFY:if(this.stack.length<2)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;v=this.stack[this.stack.length-2],b=this.stack[this.stack.length-1],w=(new i).set({chunks:this.script.chunks.slice(this.pbegincodehash)});var U=(new i).add(v);if(w.findAndDelete(U),!this.checkSignatureEncoding(v)||!this.checkPubkeyEncoding(b))return!1;try{_=u.fromTxFormat(v),k=c.fromBuffer(b,!1),E=this.tx.verifySignature(_,k,this.nin,w)}catch(e){E=!1}if(this.stack.pop(),this.stack.pop(),this.stack.push(E?f.true:f.false),C===s.OP_CHECKSIGVERIFY){if(!E)return this.errstr=\"SCRIPT_ERR_CHECKSIGVERIFY\",!1;this.stack.pop()}break;case s.OP_CHECKMULTISIG:case s.OP_CHECKMULTISIGVERIFY:var R=1;if(this.stack.length<R)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;var L=o.fromScriptNumBuffer(this.stack[this.stack.length-R],x).toNumber();if(L<0||L>20)return this.errstr=\"SCRIPT_ERR_PUBKEY_COUNT\",!1;if(this.nOpCount+=L,this.nOpCount>201)return this.errstr=\"SCRIPT_ERR_OP_COUNT\",!1;var F=++R;if(R+=L,this.stack.length<R)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;var j=o.fromScriptNumBuffer(this.stack[this.stack.length-R],x).toNumber();if(j<0||j>L)return this.errstr=\"SCRIPT_ERR_SIG_COUNT\",!1;var M=++R;if(R+=j,this.stack.length<R)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;w=(new i).set({chunks:this.script.chunks.slice(this.pbegincodehash)});for(var K=0;K<j;K++)v=this.stack[this.stack.length-M-K],w.findAndDelete((new i).add(v));for(E=!0;E&&j>0;){if(v=this.stack[this.stack.length-M],b=this.stack[this.stack.length-F],!this.checkSignatureEncoding(v)||!this.checkPubkeyEncoding(b))return!1;var H;try{_=u.fromTxFormat(v),k=c.fromBuffer(b,!1),H=this.tx.verifySignature(_,k,this.nin,w)}catch(e){H=!1}H&&(M++,j--),F++,j>--L&&(E=!1)}for(;R-- >1;)this.stack.pop();if(this.stack.length<1)return this.errstr=\"SCRIPT_ERR_INVALID_STACK_OPERATION\",!1;if(this.flags&f.SCRIPT_VERIFY_NULLDUMMY&&this.stack[this.stack.length-1].length)return this.errstr=\"SCRIPT_ERR_SIG_NULLDUMMY\",!1;if(this.stack.pop(),this.stack.push(E?f.true:f.false),C===s.OP_CHECKMULTISIGVERIFY){if(!E)return this.errstr=\"SCRIPT_ERR_CHECKMULTISIGVERIFY\",!1;this.stack.pop()}break;default:return this.errstr=\"SCRIPT_ERR_BAD_OPCODE\",!1}return!0}},function(e,t,r){\"use strict\";e.exports=[{name:\"InvalidB58Char\",message:\"Invalid Base58 character: {0} in {1}\"},{name:\"InvalidB58Checksum\",message:\"Invalid Base58 checksum for {0}\"},{name:\"InvalidNetwork\",message:\"Invalid version for network: got {0}\"},{name:\"InvalidState\",message:\"Invalid state: {0}\"},{name:\"NotImplemented\",message:\"Function {0} was not implemented yet\"},{name:\"InvalidNetworkArgument\",message:'Invalid network: must be \"livenet\" or \"testnet\", got {0}'},{name:\"InvalidArgument\",message:function(){return\"Invalid Argument\"+(arguments[0]?\": \"+arguments[0]:\"\")+(arguments[1]?\" Documentation: http://bitcore.io/\"+arguments[1]:\"\")}},{name:\"AbstractMethodInvoked\",message:\"Abstract Method Invocation: {0}\"},{name:\"InvalidArgumentType\",message:function(){return\"Invalid Argument for \"+arguments[2]+\", expected \"+arguments[1]+\" but got \"+typeof arguments[0]}},{name:\"Unit\",message:\"Internal Error on Unit {0}\",errors:[{name:\"UnknownCode\",message:\"Unrecognized unit code: {0}\"},{name:\"InvalidRate\",message:\"Invalid exchange rate: {0}\"}]},{name:\"Transaction\",message:\"Internal Error on Transaction {0}\",errors:[{name:\"Input\",message:\"Internal Error on Input {0}\",errors:[{name:\"MissingScript\",message:\"Need a script to create an input\"},{name:\"UnsupportedScript\",message:\"Unsupported input script type: {0}\"},{name:\"MissingPreviousOutput\",message:\"No previous output information.\"}]},{name:\"NeedMoreInfo\",message:\"{0}\"},{name:\"InvalidSorting\",message:\"The sorting function provided did not return the change output as one of the array elements\"},{name:\"InvalidOutputAmountSum\",message:\"{0}\"},{name:\"MissingSignatures\",message:\"Some inputs have not been fully signed\"},{name:\"InvalidIndex\",message:\"Invalid index: {0} is not between 0, {1}\"},{name:\"UnableToVerifySignature\",message:\"Unable to verify signature: {0}\"},{name:\"DustOutputs\",message:\"Dust amount detected in one output\"},{name:\"InvalidSatoshis\",message:\"Output satoshis are invalid\"},{name:\"FeeError\",message:\"Internal Error on Fee {0}\",errors:[{name:\"TooSmall\",message:\"Fee is too small: {0}\"},{name:\"TooLarge\",message:\"Fee is too large: {0}\"},{name:\"Different\",message:\"Unspent value is different from specified fee: {0}\"}]},{name:\"ChangeAddressMissing\",message:\"Change address is missing\"},{name:\"BlockHeightTooHigh\",message:\"Block Height can be at most 2^32 -1\"},{name:\"NLockTimeOutOfRange\",message:\"Block Height can only be between 0 and 499 999 999\"},{name:\"LockTimeTooEarly\",message:\"Lock Time can't be earlier than UNIX date 500 000 000\"}]},{name:\"Script\",message:\"Internal Error on Script {0}\",errors:[{name:\"UnrecognizedAddress\",message:\"Expected argument {0} to be an address\"},{name:\"CantDeriveAddress\",message:\"Can't derive address associated with script {0}, needs to be p2pkh in, p2pkh out, p2sh in, or p2sh out.\"},{name:\"InvalidBuffer\",message:\"Invalid script buffer: can't parse valid script from given buffer {0}\"}]},{name:\"HDPrivateKey\",message:\"Internal Error on HDPrivateKey {0}\",errors:[{name:\"InvalidDerivationArgument\",message:\"Invalid derivation argument {0}, expected string, or number and boolean\"},{name:\"InvalidEntropyArgument\",message:\"Invalid entropy: must be an hexa string or binary buffer, got {0}\",errors:[{name:\"TooMuchEntropy\",message:'Invalid entropy: more than 512 bits is non standard, got \"{0}\"'},{name:\"NotEnoughEntropy\",message:'Invalid entropy: at least 128 bits needed, got \"{0}\"'}]},{name:\"InvalidLength\",message:\"Invalid length for xprivkey string in {0}\"},{name:\"InvalidPath\",message:\"Invalid derivation path: {0}\"},{name:\"UnrecognizedArgument\",message:'Invalid argument: creating a HDPrivateKey requires a string, buffer, json or object, got \"{0}\"'}]},{name:\"HDPublicKey\",message:\"Internal Error on HDPublicKey {0}\",errors:[{name:\"ArgumentIsPrivateExtended\",message:\"Argument is an extended private key: {0}\"},{name:\"InvalidDerivationArgument\",message:\"Invalid derivation argument: got {0}\"},{name:\"InvalidLength\",message:'Invalid length for xpubkey: got \"{0}\"'},{name:\"InvalidPath\",message:'Invalid derivation path, it should look like: \"m/1/100\", got \"{0}\"'},{name:\"InvalidIndexCantDeriveHardened\",message:\"Invalid argument: creating a hardened path requires an HDPrivateKey\"},{name:\"MustSupplyArgument\",message:\"Must supply an argument to create a HDPublicKey\"},{name:\"UnrecognizedArgument\",message:\"Invalid argument for creation, must be string, json, buffer, or object\"}]}]},function(e){e.exports={_from:\"zcash-bitcore-lib@^0.13.20-rc3\",_id:\"zcash-bitcore-lib@0.13.20-rc3\",_inBundle:!1,_integrity:\"sha1-gToPVtz4t2vBQplRvqbRI2xQcAg=\",_location:\"/zcash-bitcore-lib\",_phantomChildren:{},_requested:{type:\"range\",registry:!0,raw:\"zcash-bitcore-lib@^0.13.20-rc3\",name:\"zcash-bitcore-lib\",escapedName:\"zcash-bitcore-lib\",rawSpec:\"^0.13.20-rc3\",saveSpec:null,fetchSpec:\"^0.13.20-rc3\"},_requiredBy:[\"/ipld-zcash\"],_resolved:\"https://registry.npmjs.org/zcash-bitcore-lib/-/zcash-bitcore-lib-0.13.20-rc3.tgz\",_shasum:\"813a0f56dcf8b76bc1429951bea6d1236c507008\",_shrinkwrap:{name:\"bitcore\",version:\"0.13.19\",dependencies:{\"bn.js\":{version:\"2.0.4\",from:\"bn.js@=2.0.4\",resolved:\"https://registry.npmjs.org/bn.js/-/bn.js-2.0.4.tgz\"},bs58:{version:\"2.0.0\",from:\"bs58@=2.0.0\",resolved:\"https://registry.npmjs.org/bs58/-/bs58-2.0.0.tgz\"},\"buffer-compare\":{version:\"1.0.0\",from:\"buffer-compare@=1.0.0\",resolved:\"https://registry.npmjs.org/buffer-compare/-/buffer-compare-1.0.0.tgz\"},elliptic:{version:\"3.0.3\",from:\"elliptic@=3.0.3\",resolved:\"https://registry.npmjs.org/elliptic/-/elliptic-3.0.3.tgz\",dependencies:{brorand:{version:\"1.0.5\",from:\"brorand@^1.0.1\",resolved:\"https://registry.npmjs.org/brorand/-/brorand-1.0.5.tgz\"},\"hash.js\":{version:\"1.0.3\",from:\"hash.js@=1.0.3\",resolved:\"https://registry.npmjs.org/hash.js/-/hash.js-1.0.3.tgz\"}}},inherits:{version:\"2.0.1\",from:\"inherits@=2.0.1\",resolved:\"https://registry.npmjs.org/inherits/-/inherits-2.0.1.tgz\"},lodash:{version:\"3.10.1\",from:\"lodash@=3.10.1\",resolved:\"https://registry.npmjs.org/lodash/-/lodash-3.10.1.tgz\"}}},_spec:\"zcash-bitcore-lib@^0.13.20-rc3\",_where:\"/Users/osarrouy/Documents/devs/dapps/@wespr/pando.js/node_modules/ipld-zcash\",author:{name:\"BitPay\",email:\"dev@bitpay.com\"},browser:{request:\"browser-request\"},bugs:{url:\"https://github.com/bitmex/zcash-bitcore-lib/issues\"},bundleDependencies:!1,contributors:[{name:\"Daniel Cousens\",email:\"bitcoin@dcousens.com\"},{name:\"Esteban Ordano\",email:\"eordano@gmail.com\"},{name:\"Gordon Hall\",email:\"gordon@bitpay.com\"},{name:\"Jeff Garzik\",email:\"jgarzik@bitpay.com\"},{name:\"Kyle Drake\",email:\"kyle@kyledrake.net\"},{name:\"Manuel Araoz\",email:\"manuelaraoz@gmail.com\"},{name:\"Matias Alejo Garcia\",email:\"ematiu@gmail.com\"},{name:\"Ryan X. Charles\",email:\"ryanxcharles@gmail.com\"},{name:\"Stefan Thomas\",email:\"moon@justmoon.net\"},{name:\"Stephen Pair\",email:\"stephen@bitpay.com\"},{name:\"Wei Lu\",email:\"luwei.here@gmail.com\"},{name:\"Jack Grigg\",email:\"jack@z.cash\"}],dependencies:{\"bn.js\":\"=2.0.4\",bs58:\"=2.0.0\",\"buffer-compare\":\"=1.0.0\",elliptic:\"=3.0.3\",inherits:\"=2.0.1\",lodash:\"=3.10.1\"},deprecated:!1,description:\"A pure and powerful JavaScript Zcash library.\",devDependencies:{brfs:\"^1.2.0\",chai:\"^1.10.0\",gulp:\"^3.8.10\",sinon:\"^1.13.0\",\"zcash-bitcore-build\":\"^0.5.4\"},homepage:\"https://github.com/bitmex/zcash-bitcore-lib#readme\",keywords:[\"zcash\",\"transaction\",\"address\",\"p2p\",\"ecies\",\"cryptocurrency\",\"blockchain\",\"payment\",\"bip21\",\"bip32\",\"bip37\",\"bip69\",\"bip70\",\"multisig\"],license:\"MIT\",main:\"index.js\",name:\"zcash-bitcore-lib\",repository:{type:\"git\",url:\"git+https://github.com/bitmex/zcash-bitcore-lib.git\"},scripts:{build:\"gulp\",coverage:\"gulp coverage\",lint:\"gulp lint\",test:\"gulp test\"},version:\"0.13.20-rc3\"}},function(e,t,r){\"use strict\";var n=e.exports;n.version=\"v\"+r(769).version,n.versionGuard=function(e){if(void 0!==e);},n.versionGuard(global._bitcore),global._bitcore=n.version,n.crypto={},n.crypto.BN=r(28),n.crypto.ECDSA=r(335),n.crypto.Hash=r(34),n.crypto.Random=r(134),n.crypto.Point=r(85),n.crypto.Signature=r(44),n.encoding={},n.encoding.Base58=r(136),n.encoding.Base58Check=r(100),n.encoding.BufferReader=r(63),n.encoding.BufferWriter=r(41),n.encoding.Varint=r(759),n.util={},n.util.buffer=r(13),n.util.js=r(19),n.util.preconditions=r(12),n.errors=r(45),n.Address=r(70),n.Block=r(758),n.MerkleBlock=r(331),n.BlockHeader=r(133),n.HDPrivateKey=r(330),n.HDPublicKey=r(329),n.Networks=r(71),n.Opcode=r(193),n.PrivateKey=r(137),n.PublicKey=r(50),n.Script=r(43),n.Transaction=r(135),n.URI=r(756),n.Unit=r(190),n.deps={},n.deps.bnjs=r(151),n.deps.bs58=r(56),n.deps.Buffer=Buffer,n.deps.elliptic=r(334),n.deps._=r(7),n._HDKeyCache=r(189),n.Transaction.sighash=r(62)},function(e,t,r){\"use strict\";const n=r(336),i=(e,t)=>{switch(t){case\"version\":return e.version;case\"timestamp\":return e.time;case\"difficulty\":return e.bits;case\"nonce\":return e.nonce;case\"solution\":return e.solution;case\"reserved\":return e.reserved;case\"parent\":return{\"/\":n.hashToCid(e.prevHash)};case\"tx\":return{\"/\":n.hashToCid(e.merkleRoot)};default:return null}};e.exports={multicodec:\"zcash-block\",resolve:(e,t,r)=>{\"function\"==typeof t&&(r=t,t=void 0),n.deserialize(e,(e,n)=>{if(e)return r(e);if(!t)return r(null,{value:n,remainderPath:\"\"});const s=t.split(\"/\"),o=i(n.header,s[0]);if(null===o)return r(new Error(\"No such path\"),null);let a=s.slice(1).join(\"/\");return void 0!==o[\"/\"]?r(null,{value:o,remainderPath:a}):a.length>0?r(new Error(\"No such path\"),null):r(null,{value:o,remainderPath:\"\"})})},tree:(e,t,r)=>{\"function\"==typeof t&&(r=t,t=void 0),t=t||{},n.deserialize(e,(e,n)=>{if(e)return r(e);const s=[\"version\",\"timestamp\",\"difficulty\",\"nonce\",\"solution\",\"reserved\",\"parent\",\"tx\"];if(!0===t.values){const e={};for(let t of s)e[t]=i(n.header,t);return r(null,e)}return r(null,s)})}}},function(e,t,r){\"use strict\";const n=r(339),i=r(194)(\"eth-tx-trie\",n);e.exports=i},function(e,t){e.exports=require(\"ethereumjs-tx\")},function(e,t,r){\"use strict\";const n=r(194)(\"eth-storage-trie\");e.exports=n},function(e,t){e.exports=function(e){return Boolean(e[\"/\"])}},function(e,t){e.exports=require(\"merkle-patricia-tree/trieNode\")},function(e,t,r){\"use strict\";const n=r(346),i=r(194)(\"eth-state-trie\",n);e.exports=i},function(e,t,r){\"use strict\";const n=r(3),i=r(18),s=r(195),o=r(340),a=r(341),u=r(31),c=r(102),f=r(342).resolver,l=r(101)(\"eth-block-list\",void 0,function(e,t,r){let n=[];n.push({path:\"count\",value:e.length}),i(e,(t,r)=>{const i=e.indexOf(t),s=i.toString();n.push({path:s,value:t}),f._mapFromEthObject(t,{},(e,t)=>{if(e)return r(e);t.forEach(e=>e.path=s+\"/\"+e.path),n=n.concat(t),r()})},e=>{if(e)return r(e);r(null,n)})}),h=l.util;h.serialize=s(e=>{const t=e.map(e=>e.raw);return o.encode(t)}),h.deserialize=s(e=>{return o.decode(e).map(e=>new a(e))}),h.cid=((e,t)=>{n([t=>h.serialize(e,t),(e,t)=>u.digest(e,\"keccak-256\",t),s(e=>c(\"eth-block-list\",e))],t)}),e.exports=l},function(e,t){e.exports=new Buffer(\"c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470\",\"hex\")},function(e,t){e.exports=require(\"ethereumjs-account\")},function(e,t,r){var n=r(8).Buffer,i=r(199),s=r(86),o=r(20),a=r(206),u=r(103),c=r(35),f=r(15),l=r(29),h=a.types,p=[a.types.P2PKH,a.types.P2PK,a.types.MULTISIG],d=p.concat([a.types.P2WPKH,a.types.P2WSH]),y=r(200),m=r(197),g=r(201);function v(e){return-1!==p.indexOf(e)}function b(e){return-1!==d.indexOf(e)}function w(e,t){if(0===e.length&&0===t.length)return{};var r,n,i,u,c,f,l,p,d,y,m=!1,g=!1,w=!1,_=o.decompile(e);a.classifyInput(_,!0)===h.P2SH&&(w=!0,c=_[_.length-1],p=a.classifyOutput(c),r=a.scriptHash.output.encode(s.hash160(c)),n=h.P2SH,u=c);var k=a.classifyWitness(t,!0);if(k===h.P2WSH){if(f=t[t.length-1],l=a.classifyOutput(f),g=!0,m=!0,0===e.length){if(r=a.witnessScriptHash.output.encode(s.sha256(f)),n=h.P2WSH,void 0!==c)throw new Error(\"Redeem script given when unnecessary\")}else{if(!c)throw new Error(\"No redeemScript provided for P2WSH, but scriptSig non-empty\");if(d=a.witnessScriptHash.output.encode(s.sha256(f)),!c.equals(d))throw new Error(\"Redeem script didn't match witnessScript\")}if(!v(a.classifyOutput(f)))throw new Error(\"unsupported witness script\");u=f,i=l,y=t.slice(0,-1)}else if(k===h.P2WPKH){m=!0;var S=t[t.length-1],E=s.hash160(S);if(0===e.length){if(r=a.witnessPubKeyHash.output.encode(E),n=h.P2WPKH,void 0!==c)throw new Error(\"Redeem script given when unnecessary\")}else{if(!c)throw new Error(\"No redeemScript provided for P2WPKH, but scriptSig wasn't empty\");if(d=a.witnessPubKeyHash.output.encode(E),!c.equals(d))throw new Error(\"Redeem script did not have the right witness program\")}i=h.P2PKH,y=t}else if(c){if(!b(p))throw new Error(\"Bad redeemscript!\");u=c,i=p,y=_.slice(0,-1)}else n=i=a.classifyInput(e),y=_;var x=function(e,t,r){var n=[],i=[];switch(e){case h.P2PKH:n=t.slice(1),i=t.slice(0,1);break;case h.P2PK:n[0]=r?a.pubKey.output.decode(r):void 0,i=t.slice(0,1);break;case h.MULTISIG:r&&(n=a.multisig.output.decode(r).pubKeys),i=t.slice(1).map(function(e){return 0===e.length?void 0:e})}return{pubKeys:n,signatures:i}}(i,y,u),A={pubKeys:x.pubKeys,signatures:x.signatures,prevOutScript:r,prevOutType:n,signType:i,signScript:u,witness:Boolean(m)};return w&&(A.redeemScript=c,A.redeemScriptType=p),g&&(A.witnessScript=f,A.witnessScriptType=l),A}function _(e,t,r){f(l.Buffer,e);var n=o.decompile(e);t||(t=a.classifyOutput(e));var i=[];switch(t){case h.P2PKH:if(!r)break;var u=n[2],c=s.hash160(r);u.equals(c)&&(i=[r]);break;case h.P2WPKH:if(!r)break;var p=n[1],d=s.hash160(r);p.equals(d)&&(i=[r]);break;case h.P2PK:i=n.slice(0,1);break;case h.MULTISIG:i=n.slice(1,-2);break;default:return{scriptType:t}}return{pubKeys:i,scriptType:t,signatures:i.map(function(){})}}function k(e,t){if(e.prevOutType){if(e.prevOutType!==h.P2SH)throw new Error(\"PrevOutScript must be P2SH\");if(!o.decompile(e.prevOutScript)[1].equals(t))throw new Error(\"Inconsistent hash160(RedeemScript)\")}}function S(e,t,r,n,i){var u,c,f,l,p,d,y,m,g,v=!1,b=!1,w=!1;if(r&&i){if(p=s.hash160(r),y=s.sha256(i),k(e,p),!r.equals(a.witnessScriptHash.output.encode(y)))throw new Error(\"Witness script inconsistent with redeem script\");if(!(u=_(i,void 0,t)).pubKeys)throw new Error('WitnessScript not supported \"'+o.toASM(r)+'\"');c=a.types.P2SH,f=a.scriptHash.output.encode(p),v=b=w=!0,l=a.types.P2WSH,m=d=u.scriptType,g=i}else if(r){if(k(e,p=s.hash160(r)),!(u=_(r,void 0,t)).pubKeys)throw new Error('RedeemScript not supported \"'+o.toASM(r)+'\"');c=a.types.P2SH,f=a.scriptHash.output.encode(p),v=!0,g=r,b=(m=l=u.scriptType)===a.types.P2WPKH}else if(i){if(function(e,t){if(e.prevOutType){if(e.prevOutType!==h.P2WSH)throw new Error(\"PrevOutScript must be P2WSH\");if(!o.decompile(e.prevOutScript)[1].equals(t))throw new Error(\"Inconsistent sha25(WitnessScript)\")}}(e,y=s.sha256(i)),!(u=_(i,void 0,t)).pubKeys)throw new Error('WitnessScript not supported \"'+o.toASM(r)+'\"');c=a.types.P2WSH,f=a.witnessScriptHash.output.encode(y),b=w=!0,m=d=u.scriptType,g=i}else if(e.prevOutType){if(e.prevOutType===h.P2SH||e.prevOutType===h.P2WSH)throw new Error(\"PrevOutScript is \"+e.prevOutType+\", requires redeemScript\");if(c=e.prevOutType,f=e.prevOutScript,!(u=_(e.prevOutScript,e.prevOutType,t)).pubKeys)return;b=e.prevOutType===h.P2WPKH,m=c,g=f}else u=_(f=a.pubKeyHash.output.encode(s.hash160(t)),h.P2PKH,t),b=!1,m=c=h.P2PKH,g=f;m===h.P2WPKH&&(g=a.pubKeyHash.output.encode(a.witnessPubKeyHash.output.decode(g))),v&&(e.redeemScript=r,e.redeemScriptType=l),w&&(e.witnessScript=i,e.witnessScriptType=d),e.pubKeys=u.pubKeys,e.signatures=u.signatures,e.signScript=g,e.signType=m,e.prevOutScript=f,e.prevOutType=c,e.witness=b}function E(e,t,r,i){if(e===h.P2PKH){if(1===t.length&&n.isBuffer(t[0])&&1===r.length)return a.pubKeyHash.input.encodeStack(t[0],r[0])}else if(e===h.P2PK){if(1===t.length&&n.isBuffer(t[0]))return a.pubKey.input.encodeStack(t[0])}else{if(e!==h.MULTISIG)throw new Error(\"Not yet supported\");if(t.length>0)return t=t.map(function(e){return e||c.OP_0}),i||(t=t.filter(function(e){return e!==c.OP_0})),a.multisig.input.encodeStack(t)}if(!i)throw new Error(\"Not enough signatures provided\");return[]}function x(e,t){this.prevTxMap={},this.network=e||u.bitcoin,this.maximumFeeRate=t||2500,this.inputs=[],this.tx=new g}function A(e){return void 0!==e.prevOutScript&&void 0!==e.signScript&&void 0!==e.pubKeys&&void 0!==e.signatures&&e.signatures.length===e.pubKeys.length&&e.pubKeys.length>0&&(!1===e.witness||!0===e.witness&&void 0!==e.value)}function B(e){return e.readUInt8(e.length-1)}x.prototype.setLockTime=function(e){if(f(l.UInt32,e),this.inputs.some(function(e){return!!e.signatures&&e.signatures.some(function(e){return e})}))throw new Error(\"No, this would invalidate signatures\");this.tx.locktime=e},x.prototype.setVersion=function(e){f(l.UInt32,e),this.tx.version=e},x.fromTransaction=function(e,t){var r=new x(t);return r.setVersion(e.version),r.setLockTime(e.locktime),e.outs.forEach(function(e){r.addOutput(e.script,e.value)}),e.ins.forEach(function(e){r.__addInputUnsafe(e.hash,e.index,{sequence:e.sequence,script:e.script,witness:e.witness})}),r.inputs.forEach(function(t,r){!function(e,t,r){if(e.redeemScriptType===h.MULTISIG&&e.redeemScript&&e.pubKeys.length!==e.signatures.length){var n=e.signatures.concat();e.signatures=e.pubKeys.map(function(i){var s,o=y.fromPublicKeyBuffer(i);return n.some(function(i,a){if(!i)return!1;var u=m.parseScriptSignature(i),c=t.hashForSignature(r,e.redeemScript,u.hashType);return!!o.verify(c,u.signature)&&(n[a]=void 0,s=i,!0)}),s})}}(t,e,r)}),r},x.prototype.addInput=function(e,t,r,i){if(!this.__canModifyInputs())throw new Error(\"No, this would invalidate signatures\");var s;if(\"string\"==typeof e)e=n.from(e,\"hex\").reverse();else if(e instanceof g){var o=e.outs[t];i=o.script,s=o.value,e=e.getHash()}return this.__addInputUnsafe(e,t,{sequence:r,prevOutScript:i,value:s})},x.prototype.__addInputUnsafe=function(e,t,r){if(g.isCoinbaseHash(e))throw new Error(\"coinbase inputs not supported\");var n=e.toString(\"hex\")+\":\"+t;if(void 0!==this.prevTxMap[n])throw new Error(\"Duplicate TxOut: \"+n);var i={};if(void 0!==r.script&&(i=w(r.script,r.witness||[])),void 0!==r.value&&(i.value=r.value),!i.prevOutScript&&r.prevOutScript){var s;if(!i.pubKeys&&!i.signatures){var o=_(r.prevOutScript);o.pubKeys&&(i.pubKeys=o.pubKeys,i.signatures=o.signatures),s=o.scriptType}i.prevOutScript=r.prevOutScript,i.prevOutType=s||a.classifyOutput(r.prevOutScript)}var u=this.tx.addInput(e,t,r.sequence,r.scriptSig);return this.inputs[u]=i,this.prevTxMap[n]=u,u},x.prototype.addOutput=function(e,t){if(!this.__canModifyOutputs())throw new Error(\"No, this would invalidate signatures\");return\"string\"==typeof e&&(e=i.toOutputScript(e,this.network)),this.tx.addOutput(e,t)},x.prototype.build=function(){return this.__build(!1)},x.prototype.buildIncomplete=function(){return this.__build(!0)},x.prototype.__build=function(e){if(!e){if(!this.tx.ins.length)throw new Error(\"Transaction has no inputs\");if(!this.tx.outs.length)throw new Error(\"Transaction has no outputs\")}var t=this.tx.clone();if(this.inputs.forEach(function(r,n){if(!(r.witnessScriptType||r.redeemScriptType||r.prevOutType)&&!e)throw new Error(\"Transaction is not complete\");var i=function(e,t){var r=e.prevOutType,n=[],i=[];v(r)&&(n=E(r,e.signatures,e.pubKeys,t));var s=!1;if(r===a.types.P2SH){if(!t&&!b(e.redeemScriptType))throw new Error(\"Impossible to sign this type\");v(e.redeemScriptType)&&(n=E(e.redeemScriptType,e.signatures,e.pubKeys,t)),e.redeemScriptType&&(s=!0,r=e.redeemScriptType)}switch(r){case a.types.P2WPKH:i=E(a.types.P2PKH,e.signatures,e.pubKeys,t);break;case a.types.P2WSH:if(!t&&!v(e.witnessScriptType))throw new Error(\"Impossible to sign this type\");v(e.witnessScriptType)&&((i=E(e.witnessScriptType,e.signatures,e.pubKeys,t)).push(e.witnessScript),r=e.witnessScriptType)}return s&&n.push(e.redeemScript),{type:r,script:o.compile(n),witness:i}}(r,e);if(!e&&!v(i.type)&&i.type!==a.types.P2WPKH)throw new Error(i.type+\" not supported\");t.setInputScript(n,i.script),t.setWitness(n,i.witness)}),!e&&this.__overMaximumFees(t.virtualSize()))throw new Error(\"Transaction has absurd fees\");return t},x.prototype.sign=function(e,t,r,i,s,o){if(t.network&&t.network!==this.network)throw new TypeError(\"Inconsistent network\");if(!this.inputs[e])throw new Error(\"No input at index: \"+e);i=i||g.SIGHASH_ALL;var a=this.inputs[e];if(void 0!==a.redeemScript&&r&&!a.redeemScript.equals(r))throw new Error(\"Inconsistent redeemScript\");var u,c=t.publicKey||t.getPublicKeyBuffer();if(!A(a)){if(void 0!==s){if(void 0!==a.value&&a.value!==s)throw new Error(\"Input didn't match witnessValue\");f(l.Satoshi,s),a.value=s}if(A(a)||S(a,c,r,0,o),!A(a))throw Error(a.prevOutType+\" not supported\")}if(u=a.witness?this.tx.hashForWitnessV0(e,a.signScript,a.value,i):this.tx.hashForSignature(e,a.signScript,i),!a.pubKeys.some(function(e,r){if(!c.equals(e))return!1;if(a.signatures[r])throw new Error(\"Signature already exists\");if(33!==c.length&&a.signType===h.P2WPKH)throw new Error(\"BIP143 rejects uncompressed public keys in P2WPKH or P2WSH\");var s=t.sign(u);return n.isBuffer(s)&&(s=m.fromRSBuffer(s)),a.signatures[r]=s.toScriptSignature(i),!0}))throw new Error(\"Key pair cannot sign for this input\")},x.prototype.__canModifyInputs=function(){return this.inputs.every(function(e){return void 0===e.signatures||e.signatures.every(function(e){return!e||B(e)&g.SIGHASH_ANYONECANPAY})})},x.prototype.__canModifyOutputs=function(){var e=this.tx.ins.length,t=this.tx.outs.length;return this.inputs.every(function(r){return void 0===r.signatures||r.signatures.every(function(r){if(!r)return!0;var n=31&B(r);return n===g.SIGHASH_NONE||(n===g.SIGHASH_SINGLE?e<=t:void 0)})})},x.prototype.__overMaximumFees=function(e){return(this.inputs.reduce(function(e,t){return e+(t.value>>>0)},0)-this.tx.outs.reduce(function(e,t){return e+t.value},0))/e>this.maximumFeeRate},e.exports=x},function(e,t,r){var n=r(8).Buffer,i=r(198),s=r(86),o=r(352),a=r(15),u=r(29),c=r(103),f=r(72),l=r(200),h=r(196),p=h.getCurveByName(\"secp256k1\");function d(e,t){if(a(u.tuple(\"ECPair\",u.Buffer256bit),arguments),!e.compressed)throw new TypeError(\"BIP32 only allows compressed keyPairs\");this.keyPair=e,this.chainCode=t,this.depth=0,this.index=0,this.parentFingerprint=0}d.HIGHEST_BIT=2147483648,d.LENGTH=78,d.MASTER_SECRET=n.from(\"Bitcoin seed\",\"utf8\"),d.fromSeedBuffer=function(e,t){if(a(u.tuple(u.Buffer,u.maybe(u.Network)),arguments),e.length<16)throw new TypeError(\"Seed should be at least 128 bits\");if(e.length>64)throw new TypeError(\"Seed should be at most 512 bits\");var r=o(\"sha512\",d.MASTER_SECRET).update(e).digest(),n=r.slice(0,32),i=r.slice(32),s=f.fromBuffer(n);return new d(new l(s,null,{network:t}),i)},d.fromSeedHex=function(e,t){return d.fromSeedBuffer(n.from(e,\"hex\"),t)},d.fromBase58=function(e,t){var r=i.decode(e);if(78!==r.length)throw new Error(\"Invalid buffer length\");var n,s=r.readUInt32BE(0);if(Array.isArray(t)){if(!(n=t.filter(function(e){return s===e.bip32.private||s===e.bip32.public}).pop()))throw new Error(\"Unknown network version\")}else n=t||c.bitcoin;if(s!==n.bip32.private&&s!==n.bip32.public)throw new Error(\"Invalid network version\");var o=r[4],a=r.readUInt32BE(5);if(0===o&&0!==a)throw new Error(\"Invalid parent fingerprint\");var u=r.readUInt32BE(9);if(0===o&&0!==u)throw new Error(\"Invalid index\");var y,m=r.slice(13,45);if(s===n.bip32.private){if(0!==r.readUInt8(45))throw new Error(\"Invalid private key\");var g=f.fromBuffer(r.slice(46,78));y=new l(g,null,{network:n})}else{var v=h.Point.decodeFrom(p,r.slice(45,78));p.validate(v),y=new l(null,v,{network:n})}var b=new d(y,m);return b.depth=o,b.index=u,b.parentFingerprint=a,b},d.prototype.getAddress=function(){return this.keyPair.getAddress()},d.prototype.getIdentifier=function(){return s.hash160(this.keyPair.getPublicKeyBuffer())},d.prototype.getFingerprint=function(){return this.getIdentifier().slice(0,4)},d.prototype.getNetwork=function(){return this.keyPair.getNetwork()},d.prototype.getPublicKeyBuffer=function(){return this.keyPair.getPublicKeyBuffer()},d.prototype.neutered=function(){var e=new d(new l(null,this.keyPair.Q,{network:this.keyPair.network}),this.chainCode);return e.depth=this.depth,e.index=this.index,e.parentFingerprint=this.parentFingerprint,e},d.prototype.sign=function(e){return this.keyPair.sign(e)},d.prototype.verify=function(e,t){return this.keyPair.verify(e,t)},d.prototype.toBase58=function(e){if(void 0!==e)throw new TypeError(\"Unsupported argument in 2.0.0\");var t=this.keyPair.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,s=n.allocUnsafe(78);return s.writeUInt32BE(r,0),s.writeUInt8(this.depth,4),s.writeUInt32BE(this.parentFingerprint,5),s.writeUInt32BE(this.index,9),this.chainCode.copy(s,13),this.isNeutered()?this.keyPair.getPublicKeyBuffer().copy(s,45):(s.writeUInt8(0,45),this.keyPair.d.toBuffer(32).copy(s,46)),i.encode(s)},d.prototype.derive=function(e){a(u.UInt32,e);var t=e>=d.HIGHEST_BIT,r=n.allocUnsafe(37);if(t){if(this.isNeutered())throw new TypeError(\"Could not derive hardened child key\");r[0]=0,this.keyPair.d.toBuffer(32).copy(r,1),r.writeUInt32BE(e,33)}else this.keyPair.getPublicKeyBuffer().copy(r,0),r.writeUInt32BE(e,33);var i,s=o(\"sha512\",this.chainCode).update(r).digest(),c=s.slice(0,32),h=s.slice(32),y=f.fromBuffer(c);if(y.compareTo(p.n)>=0)return this.derive(e+1);if(this.isNeutered()){var m=p.G.multiply(y).add(this.keyPair.Q);if(p.isInfinity(m))return this.derive(e+1);i=new l(null,m,{network:this.keyPair.network})}else{var g=y.add(this.keyPair.d).mod(p.n);if(0===g.signum())return this.derive(e+1);i=new l(g,null,{network:this.keyPair.network})}var v=new d(i,h);return v.depth=this.depth+1,v.index=e,v.parentFingerprint=this.getFingerprint().readUInt32BE(0),v},d.prototype.deriveHardened=function(e){return a(u.UInt31,e),this.derive(e+d.HIGHEST_BIT)},d.prototype.isNeutered=function(){return!this.keyPair.d},d.prototype.derivePath=function(e){a(u.BIP32Path,e);var t=e.split(\"/\");if(\"m\"===t[0]){if(this.parentFingerprint)throw new Error(\"Not a master node\");t=t.slice(1)}return t.reduce(function(e,t){var r;return\"'\"===t.slice(-1)?(r=parseInt(t.slice(0,-1),10),e.deriveHardened(r)):(r=parseInt(t,10),e.derive(r))},this)},e.exports=d},function(e,t,r){var n=r(198);function i(e,t){if(void 0!==t&&e[0]!==t)throw new Error(\"Invalid network version\");if(33===e.length)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(34!==e.length)throw new Error(\"Invalid WIF length\");if(1!==e[33])throw new Error(\"Invalid compression flag\");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function s(e,t,r){var n=new Buffer(r?34:33);return n.writeUInt8(e,0),t.copy(n,1),r&&(n[33]=1),n}e.exports={decode:function(e,t){return i(n.decode(e),t)},decodeRaw:i,encode:function(e,t,r){return\"number\"==typeof e?n.encode(s(e,t,r)):n.encode(s(e.version,e.privateKey,e.compressed))},encodeRaw:s}},function(e){e.exports={secp128r1:{p:\"fffffffdfffffff€€